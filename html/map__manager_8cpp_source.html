<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GAEMI0: aimbot_site/map_manager/src/map_manager.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="gaemi2.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GAEMI0
   &#160;<span id="projectnumber">0.12.0-rc1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('map__manager_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">map_manager.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright 2020 ROBOTIS CO., LTD.</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// you may not use this file except in compliance with the License.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// You may obtain a copy of the License at</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//     http://www.apache.org/licenses/LICENSE-2.0</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// Unless required by applicable law or agreed to in writing, software</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// See the License for the specific language governing permissions and</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// limitations under the License.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// Author: Hye-jong KIM</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;unordered_set&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;map_manager/map_manager.hpp&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacemap__manager.html">map_manager</a></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;{</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a3fe449af2336f22744fe58a8c3cc42f7">   27</a></span>&#160;<a class="code" href="classmap__manager_1_1MapManager.html#a3fe449af2336f22744fe58a8c3cc42f7">MapManager::MapManager</a>(<span class="keyword">const</span> std::string &amp; node_name)</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;: rclcpp_lifecycle::LifecycleNode(node_name)</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;{</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Initialize Map Manager.&quot;</span>);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a2e0d3b6cd0b285ecb4a3e75252c3022b">pressure_stream_</a> = std::make_shared&lt;std::ofstream&gt;();</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="comment">// Params</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  this-&gt;declare_parameter&lt;std::string&gt;(<span class="stringliteral">&quot;map_site_name&quot;</span>, <span class="stringliteral">&quot;robotis&quot;</span>);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  this-&gt;declare_parameter&lt;int&gt;(<span class="stringliteral">&quot;robot_num&quot;</span>, 0);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;}</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a78b07efa2650ee1fb19a1eb0ea3d954f">   38</a></span>&#160;rclcpp_lifecycle::node_interfaces::LifecycleNodeInterface::CallbackReturn <a class="code" href="classmap__manager_1_1MapManager.html#a78b07efa2650ee1fb19a1eb0ea3d954f">MapManager::on_configure</a>(</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keyword">const</span> rclcpp_lifecycle::State &amp; state)</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;{</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  (void) state;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Configuring Map Manager.&quot;</span>);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#abafd8e1c11994af6f66c5c85e480fcbc">map_site_name_</a> = this-&gt;get_parameter(<span class="stringliteral">&quot;map_site_name&quot;</span>).as_string();</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  RCLCPP_INFO_STREAM(get_logger(), <span class="stringliteral">&quot;map_site_name is &quot;</span> &lt;&lt; <a class="code" href="classmap__manager_1_1MapManager.html#abafd8e1c11994af6f66c5c85e480fcbc">map_site_name_</a> &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a43441561715c63a9a7dc36ab8e77c54f">robot_num_</a> = std::to_string(this-&gt;get_parameter(<span class="stringliteral">&quot;robot_num&quot;</span>).as_int());</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  RCLCPP_INFO_STREAM(get_logger(), <span class="stringliteral">&quot;robot_num is &quot;</span> &lt;&lt; <a class="code" href="classmap__manager_1_1MapManager.html#a43441561715c63a9a7dc36ab8e77c54f">robot_num_</a> &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#ac6a70fbf9ac90e568e25aea221d0c0bb">robot_map_frame_id_</a> = <span class="stringliteral">&quot;map_current&quot;</span>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#af511568ab6ca414157e1798f101f81e4">robot_base_frame_id_</a> = <span class="stringliteral">&quot;base_link&quot;</span>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="comment">// load map info from file</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#abe8ee1f3d97cc125a966758993a9ba08">load_map_info</a>();</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="comment">// [TF] maps</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a28554371705cb39d1ee6883ad7d15b3c">map_tf_broadcaster_list_</a>.resize(</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#a2cd07fd57027b359e8677aee6e8930dc">map_list_</a>.size(),</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    std::make_shared&lt;tf2_ros::StaticTransformBroadcaster&gt;(<span class="keyword">this</span>));</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="comment">// Map Server</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> map : <a class="code" href="classmap__manager_1_1MapManager.html#a2cd07fd57027b359e8677aee6e8930dc">map_list_</a>) {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keyword">auto</span> simple_map_server = std::make_shared&lt;SimpleMapServer&gt;(</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      this-&gt;shared_from_this(),</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      map.get_name() + <span class="stringliteral">&quot;_server&quot;</span>,</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      map.get_map_file_path(),</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      map.get_map_topic(),</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      map.get_frame());</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#a9d504ddaf30710579a3aa9de7ef3635d">map_server_list_</a>.push_back(simple_map_server);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="comment">// Station</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classmap__manager_1_1MapManager.html#aefbcca7f7e0d17e03f14f3726b2ffda0">load_station</a>()) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    RCLCPP_ERROR_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Fail to load Station.&quot;</span>);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">return</span> CallbackReturn::ERROR;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="comment">// Destinations</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classmap__manager_1_1MapManager.html#a62adc5b3a5e1f3fa3b1ac0e76560ead6">load_destinations</a>()) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    RCLCPP_ERROR_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Fail to load Destinations.&quot;</span>);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">return</span> CallbackReturn::ERROR;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="comment">// Elevators</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classmap__manager_1_1MapManager.html#a0ec87ecdcd648fd4959c5105afb9ec22">load_elevator</a>()) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    RCLCPP_ERROR_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Fail to load Elevator Parameters.&quot;</span>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">return</span> CallbackReturn::ERROR;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="comment">// gates</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classmap__manager_1_1MapManager.html#abef0cfc5072ecc0f6698066dcaea1c2a">load_gate</a>()) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    RCLCPP_ERROR_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Fail to load Gate Parameters.&quot;</span>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">return</span> CallbackReturn::ERROR;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="comment">// sectors</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classmap__manager_1_1MapManager.html#ac13aab1c38097c2e46773c715751f888">load_sector_data</a>()) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    RCLCPP_ERROR_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Fail to load Gate Parameters.&quot;</span>);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">return</span> CallbackReturn::ERROR;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="comment">// initialize motion state</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classmap__manager_1_1MapManager.html#ab028417b8bdc1ce6f9a379ab1a7c0ba3">load_motion_state_from_file</a>(&amp;<a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>)) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    RCLCPP_WARN_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Fail to load Motion state. make new file.&quot;</span>);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a16a596b50b6aaa332a0ff01a832015c9">stamp_</a> = this-&gt;now();</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> dest : <a class="code" href="classmap__manager_1_1MapManager.html#a47a7c408e0bbc50571eea14d42cd0cc3">dest_list_</a>) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <span class="keywordflow">if</span> (dest.key == <span class="stringliteral">&quot;service_base&quot;</span>) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a9977f778ffcae79ca443e1b5cc75bf89">map_current_frame_id_</a> = <span class="stringliteral">&quot;map_&quot;</span> + std::string(dest.floor);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a3fa894f8f09fb6d4e3cbf484bd2048d9">pose_2d_from_map_current_</a> = dest.pose;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#ac2c56020cad267a628141fc69c73180a">floor_</a> = dest.floor;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#af59ff7bf9359a2adb81e19c7abadc5cb">sector_</a> = dest.sector;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#afc1fd1bca09f4df6cb0f59dc36dd351f">atm_floor_</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#a0c6bbfcaa0efa3fbb3977b99e0d94ca7">save_motion_state_to_file</a>();</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="comment">// POI</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">//  load_poi_from_file();</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">//  save_poi_to_file();</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">// Sectors</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">//  load_sector_data();</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">// Button pose</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">//  load_button_poses();</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="comment">// Station tf</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a6069c7059db4ad16d24920daec11a79a">station_tf_broadcaster_</a> = std::make_shared&lt;tf2_ros::StaticTransformBroadcaster&gt;(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="comment">// TF Listener</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a2119b6c240c04ed0f9fa991333982077">tf_buffer_</a> = std::make_shared&lt;tf2_ros::Buffer&gt;(this-&gt;get_clock());</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a77cef7a3e1ab1335b6c9de78884e4e9c">tf_listener_</a> = std::make_shared&lt;tf2_ros::TransformListener&gt;(*<a class="code" href="classmap__manager_1_1MapManager.html#a2119b6c240c04ed0f9fa991333982077">tf_buffer_</a>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a0b0c1516dc94b0ffe29fb3221242e785">sub_callback_group_</a> =</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    create_callback_group(rclcpp::CallbackGroupType::MutuallyExclusive);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keyword">auto</span> sub_opt_sub_cbgroup = rclcpp::SubscriptionOptions();</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  sub_opt_sub_cbgroup.callback_group = <a class="code" href="classmap__manager_1_1MapManager.html#a0b0c1516dc94b0ffe29fb3221242e785">sub_callback_group_</a>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a679c6a2a7a4801c77a66eb349ddabbda">client_callback_group_</a> =</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    create_callback_group(rclcpp::CallbackGroupType::MutuallyExclusive);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a9c8834d88d2690db450fe798678a2e5c">server_callback_group_</a> =</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    create_callback_group(rclcpp::CallbackGroupType::MutuallyExclusive);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="comment">// ATM Pressure</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classmap__manager_1_1MapManager.html#a788fabb32e6b80e21f4cb5181d899c7c">initialize_floor_estimator</a>()) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#a27241dadd3c22ef9f43ce1a471e2e094">atm_pressure_sub_</a> = this-&gt;create_subscription&lt;sensor_msgs::msg::FluidPressure&gt;(</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="stringliteral">&quot;/aimbot_base/atm_pressure&quot;</span>, 0, std::bind(</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        &amp;<a class="code" href="classmap__manager_1_1MapManager.html#a9621392c21b63cfbfee973bb40e63edf">MapManager::atm_pressure_callback</a>, <span class="keyword">this</span>, std::placeholders::_1),</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      sub_opt_sub_cbgroup);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#aa7ec89923f9d20926eacc162c797e548">start_save_atm_pressure_sub_</a> = this-&gt;create_subscription&lt;std_msgs::msg::String&gt;(</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="stringliteral">&quot;/aimbot_base/start_save_atm_pressure&quot;</span>, 0, std::bind(</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        &amp;<a class="code" href="classmap__manager_1_1MapManager.html#a56b226dafd436de9f37215d35be9e76b">MapManager::start_save_atm_pressure_callback</a>, <span class="keyword">this</span>, std::placeholders::_1),</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      sub_opt_sub_cbgroup);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#ac5a915570b8c5ecb7f156ba378f64c5a">stop_save_atm_pressure_sub_</a> = this-&gt;create_subscription&lt;std_msgs::msg::String&gt;(</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="stringliteral">&quot;/aimbot_base/stop_save_atm_pressure&quot;</span>, 0, std::bind(</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        &amp;<a class="code" href="classmap__manager_1_1MapManager.html#aeb93ea87886b82b5f99a4bf49fe084c1">MapManager::stop_save_atm_pressure_callback</a>, <span class="keyword">this</span>, std::placeholders::_1),</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      sub_opt_sub_cbgroup);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">//  set_atm_pressure_at_base_floor_server_ = create_service&lt;std_srvs::srv::Trigger&gt;(</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">//    &quot;/set_atm_pressure_at_base&quot;,</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">//    std::bind(</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">//      &amp;MapManager::set_atm_pressure_at_base_floor_srv_callback, this, std::placeholders::_1,</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">//      std::placeholders::_2, std::placeholders::_3),</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">//    rmw_qos_profile_services_default,</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">//    server_callback_group_);</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">//  set_atm_pressure_on_floor_server_ =</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">//    create_service&lt;aimbot_state_interfaces::srv::SetAtmPressureOnFloor&gt;(</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">//    &quot;/set_atm_pressure_on_floor&quot;,</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">//    std::bind(</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">//      &amp;MapManager::set_atm_pressure_on_floor_srv_callback, this, std::placeholders::_1,</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">//      std::placeholders::_2, std::placeholders::_3),</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">//    rmw_qos_profile_services_default,</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">//    server_callback_group_);</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="comment">// Init pose</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a52729eca912ac8a3061894f819f09ccb">init_pose_sub_</a> = this-&gt;create_subscription&lt;geometry_msgs::msg::PoseWithCovarianceStamped&gt;(</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="stringliteral">&quot;initialpose&quot;</span>, 0,</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    std::bind(&amp;<a class="code" href="classmap__manager_1_1MapManager.html#a7071293836db63e8aa53f4ac65775d16">MapManager::init_pose_callback</a>, <span class="keyword">this</span>, std::placeholders::_1),</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    sub_opt_sub_cbgroup);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a496982717df5682e482d445ab3dbe551">init_pose_pub_</a> = this-&gt;create_publisher&lt;geometry_msgs::msg::PoseWithCovarianceStamped&gt;(</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="stringliteral">&quot;initialpose&quot;</span>, 10);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    this-&gt;get_logger(), <span class="stringliteral">&quot;Spinning until killed publishing transform from &#39;&quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#ab0690c838523c783bb4ff9b5cf8831e6">current_map_frame_id_</a> &lt;&lt; <span class="stringliteral">&quot;&#39; to &#39;&quot;</span> &lt;&lt; <a class="code" href="classmap__manager_1_1MapManager.html#ac6a70fbf9ac90e568e25aea221d0c0bb">robot_map_frame_id_</a> &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="comment">// Service Server</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#aee0008cbfa0eab2665b9e3f04b4bf532">load_map_client_</a> = this-&gt;create_client&lt;nav2_msgs::srv::LoadMap&gt;(</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="stringliteral">&quot;/map_server/load_map&quot;</span>,</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    rmw_qos_profile_services_default,</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#a679c6a2a7a4801c77a66eb349ddabbda">client_callback_group_</a>);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a63c8fb0a25d2fe655f344f1df0f28dff">change_floor_sub_</a> = this-&gt;create_subscription&lt;std_msgs::msg::String&gt;(</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="stringliteral">&quot;floor_frame_id&quot;</span>, 0, std::bind(</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      &amp;<a class="code" href="classmap__manager_1_1MapManager.html#aa9dca860f14eb942ca6b50463e87e3fe">MapManager::change_floor_callback</a>, <span class="keyword">this</span>, std::placeholders::_1),</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    sub_opt_sub_cbgroup);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a5136641f396bbcb67d0cb4ac6df7a456">change_map_server_</a> = create_service&lt;aimbot_state_interfaces::srv::ChangeMap&gt;(</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="stringliteral">&quot;/change_map&quot;</span>,</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    std::bind(</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      &amp;<a class="code" href="classmap__manager_1_1MapManager.html#a2eb45c2838fbe2e1fbb1afc55ecf759b">MapManager::change_map_srv_callback</a>, <span class="keyword">this</span>,</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      std::placeholders::_1, std::placeholders::_2, std::placeholders::_3),</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    rmw_qos_profile_services_default,</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#a9c8834d88d2690db450fe798678a2e5c">server_callback_group_</a>);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#ac77dd458c90980a000e794ab1117c137">motion_state_server_</a> = create_service&lt;aimbot_state_interfaces::srv::GetAimbotMotionState&gt;(</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="stringliteral">&quot;/get_aimbot_motion_state&quot;</span>,</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    std::bind(</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      &amp;<a class="code" href="classmap__manager_1_1MapManager.html#ade021777fe56be06dbca4dcb89c7263d">MapManager::get_mobile_state_callback</a>, <span class="keyword">this</span>,</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      std::placeholders::_1, std::placeholders::_2, std::placeholders::_3),</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    rmw_qos_profile_services_default,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#a9c8834d88d2690db450fe798678a2e5c">server_callback_group_</a>);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#aab269ee8379aa19f20fbe79decdc3e35">get_destination_list_server_</a> =</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    create_service&lt;aimbot_state_interfaces::srv::GetDestinationList&gt;(</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="stringliteral">&quot;/get_destination_list&quot;</span>,</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    std::bind(</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      &amp;<a class="code" href="classmap__manager_1_1MapManager.html#a28209f1819a0735e54dcadccd337e546">MapManager::get_destination_list_callback</a>, <span class="keyword">this</span>,</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      std::placeholders::_1, std::placeholders::_2, std::placeholders::_3),</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    rmw_qos_profile_services_default,</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#a9c8834d88d2690db450fe798678a2e5c">server_callback_group_</a>);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a0681a35d142161de0e66c26b037aa7ce">get_destination_server_</a> =</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    create_service&lt;aimbot_state_interfaces::srv::GetDestination&gt;(</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="stringliteral">&quot;/get_destination&quot;</span>,</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    std::bind(</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      &amp;<a class="code" href="classmap__manager_1_1MapManager.html#a231cc314d6ce400df407ae337cc562eb">MapManager::get_destination_callback</a>, <span class="keyword">this</span>,</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      std::placeholders::_1, std::placeholders::_2, std::placeholders::_3),</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    rmw_qos_profile_services_default,</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#a9c8834d88d2690db450fe798678a2e5c">server_callback_group_</a>);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a3c82a007a0fed93d4a76b4daaadec386">get_waypoint_server_</a> =</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    create_service&lt;aimbot_state_interfaces::srv::GetWaypoint&gt;(</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="stringliteral">&quot;/get_waypoint&quot;</span>,</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    std::bind(</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      &amp;<a class="code" href="classmap__manager_1_1MapManager.html#a766be94e37bbd82a9537dbb09349abbd">MapManager::get_waypoint_callback</a>, <span class="keyword">this</span>,</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      std::placeholders::_1, std::placeholders::_2, std::placeholders::_3),</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    rmw_qos_profile_services_default,</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#a9c8834d88d2690db450fe798678a2e5c">server_callback_group_</a>);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#ae492b65d2a69cf360ec7c849a3d50a97">get_door_pose_server_</a> =</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    create_service&lt;aimbot_state_interfaces::srv::GetDoorPose&gt;(</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="stringliteral">&quot;/get_door_pose&quot;</span>,</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    std::bind(</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      &amp;<a class="code" href="classmap__manager_1_1MapManager.html#a36836b2c35bc93d4d2ee61004ed12a69">MapManager::get_door_pose_callback</a>, <span class="keyword">this</span>,</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      std::placeholders::_1, std::placeholders::_2, std::placeholders::_3),</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    rmw_qos_profile_services_default,</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#a9c8834d88d2690db450fe798678a2e5c">server_callback_group_</a>);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a2057a553e661e24d93f2ccaa073125a6">get_button_pose_server_</a> = create_service&lt;aimbot_state_interfaces::srv::GetButtonPose&gt;(</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="stringliteral">&quot;/get_button_pose&quot;</span>,</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    std::bind(</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      &amp;<a class="code" href="classmap__manager_1_1MapManager.html#a0edbfd6b0e0d95111f4f11d2c6853867">MapManager::get_button_pose_callback</a>, <span class="keyword">this</span>,</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      std::placeholders::_1, std::placeholders::_2, std::placeholders::_3),</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    rmw_qos_profile_services_default,</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#a9c8834d88d2690db450fe798678a2e5c">server_callback_group_</a>);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a045f8b20b610b8a361901bedc402dbdd">get_nearest_button_server_</a> = create_service&lt;aimbot_state_interfaces::srv::GetNearestButton&gt;(</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="stringliteral">&quot;/get_nearest_button&quot;</span>,</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    std::bind(</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      &amp;<a class="code" href="classmap__manager_1_1MapManager.html#ac462e554266d3019b3cb518ec2716d13">MapManager::get_nearest_button_callback</a>, <span class="keyword">this</span>,</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      std::placeholders::_1, std::placeholders::_2, std::placeholders::_3),</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    rmw_qos_profile_services_default,</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#a9c8834d88d2690db450fe798678a2e5c">server_callback_group_</a>);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="comment">// action</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  std::string update_ev_object_name = <span class="stringliteral">&quot;/update_ev_object&quot;</span>;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#acba5941f5d067ece6112c00590888fdd">update_ev_object_action_server_</a> =</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    rclcpp_action::create_server&lt;aimbot_state_interfaces::action::UpdateEVObject&gt;(</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keyword">this</span>,</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    update_ev_object_name,</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    std::bind(</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      &amp;<a class="code" href="classmap__manager_1_1MapManager.html#ad7122f88aaa058a18fcfae6e975c32b7">MapManager::ev_object_goal_callback</a>, <span class="keyword">this</span>, std::placeholders::_1, std::placeholders::_2),</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    std::bind(</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      &amp;<a class="code" href="classmap__manager_1_1MapManager.html#a60934a3e4d02c94bca83525e086221a5">MapManager::ev_object_cancel_callback</a>, <span class="keyword">this</span>, std::placeholders::_1),</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    std::bind(</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      &amp;<a class="code" href="classmap__manager_1_1MapManager.html#a1e1133b56d40589a30c3803dbbd1e240">MapManager::ev_object_aceepted_callback</a>, <span class="keyword">this</span>, std::placeholders::_1));</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="comment">// Pub</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#aa6b223ac88d0cd7c1a7690b55b0b0546">motion_state_pub_</a> = this-&gt;create_publisher&lt;aimbot_state_interfaces::msg::MotionState&gt;(</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="stringliteral">&quot;/motion_state&quot;</span>,</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    rclcpp::SystemDefaultsQoS());</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="comment">// [TF] map_current</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a79660eef4c19cb5072f01c11de050846">current_map_tf_broadcaster_</a> = std::make_shared&lt;tf2_ros::StaticTransformBroadcaster&gt;(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#ab0690c838523c783bb4ff9b5cf8831e6">current_map_frame_id_</a> = <a class="code" href="classmap__manager_1_1MapManager.html#a2cd07fd57027b359e8677aee6e8930dc">map_list_</a>.front().get_frame();</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> map : <a class="code" href="classmap__manager_1_1MapManager.html#a2cd07fd57027b359e8677aee6e8930dc">map_list_</a>) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">if</span> (map.get_name() == <span class="stringliteral">&quot;map_&quot;</span> + <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#ac2c56020cad267a628141fc69c73180a">floor_</a>) {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Set up first map to &quot;</span> &lt;&lt; map.get_name());</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#ab0690c838523c783bb4ff9b5cf8831e6">current_map_frame_id_</a> = map.get_frame();</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#a631536d1fb1937e6492a38e148bd50a7">send_current_map_to_nav</a>(map.get_map_file_path());</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="keywordflow">return</span> CallbackReturn::SUCCESS;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;}</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a088611861a5705ba385e7bf3e973a9eb">  298</a></span>&#160;rclcpp_lifecycle::node_interfaces::LifecycleNodeInterface::CallbackReturn <a class="code" href="classmap__manager_1_1MapManager.html#a088611861a5705ba385e7bf3e973a9eb">MapManager::on_activate</a>(</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="keyword">const</span> rclcpp_lifecycle::State &amp; state)</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;{</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  (void) state;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Activating Map Manager.&quot;</span>);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#aa6b223ac88d0cd7c1a7690b55b0b0546">motion_state_pub_</a>-&gt;on_activate();</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a496982717df5682e482d445ab3dbe551">init_pose_pub_</a>-&gt;on_activate();</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> map_server : <a class="code" href="classmap__manager_1_1MapManager.html#a9d504ddaf30710579a3aa9de7ef3635d">map_server_list_</a>) {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    map_server-&gt;on_activate();</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="comment">// Update Function</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keyword">auto</span> update =</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    [<span class="keyword">this</span>]() -&gt; <span class="keywordtype">void</span> {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="comment">// Pub TF</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#a2c92e8dee5f85f2e6da8aa6f700cc3db">publish_tf</a>();</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="comment">// Get</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <span class="keyword">static</span> <span class="keywordtype">double</span> previous_x = <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a3fa894f8f09fb6d4e3cbf484bd2048d9">pose_2d_from_map_current_</a>.x;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keyword">static</span> <span class="keywordtype">double</span> previous_y = <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a3fa894f8f09fb6d4e3cbf484bd2048d9">pose_2d_from_map_current_</a>.y;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="keyword">static</span> <span class="keywordtype">double</span> previous_theta = <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a3fa894f8f09fb6d4e3cbf484bd2048d9">pose_2d_from_map_current_</a>.theta;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      geometry_msgs::msg::TransformStamped base_transform;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        base_transform = <a class="code" href="classmap__manager_1_1MapManager.html#a2119b6c240c04ed0f9fa991333982077">tf_buffer_</a>-&gt;lookupTransform(</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;          <a class="code" href="classmap__manager_1_1MapManager.html#ac6a70fbf9ac90e568e25aea221d0c0bb">robot_map_frame_id_</a>, <a class="code" href="classmap__manager_1_1MapManager.html#af511568ab6ca414157e1798f101f81e4">robot_base_frame_id_</a>,</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;          rclcpp::Time(0), rclcpp::Duration::from_seconds(0.5));</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      } <span class="keywordflow">catch</span> (tf2::TransformException &amp; ex) {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        RCLCPP_ERROR_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Failed to get the TF : &quot;</span> &lt;&lt; ex.what());</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">//      RCLCPP_INFO_STREAM(</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">//        this-&gt;get_logger(), &quot;TF is (&quot; &lt;&lt;</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">//          base_transform.transform.translation.x &lt;&lt; &quot;, &quot; &lt;&lt;</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">//          base_transform.transform.translation.y &lt;&lt; &quot;)&quot;);</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="comment">// Time</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#a8a900d806e57e143205a86a2bb85765d">motion_state_mutex_</a>.lock();</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a16a596b50b6aaa332a0ff01a832015c9">stamp_</a> = base_transform.header.stamp;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="comment">// TF</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a9977f778ffcae79ca443e1b5cc75bf89">map_current_frame_id_</a> = <a class="code" href="classmap__manager_1_1MapManager.html#ac6a70fbf9ac90e568e25aea221d0c0bb">robot_map_frame_id_</a>;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a3fa894f8f09fb6d4e3cbf484bd2048d9">pose_2d_from_map_current_</a>.x = base_transform.transform.translation.x;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a3fa894f8f09fb6d4e3cbf484bd2048d9">pose_2d_from_map_current_</a>.y = base_transform.transform.translation.y;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a3fa894f8f09fb6d4e3cbf484bd2048d9">pose_2d_from_map_current_</a>.theta =</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        tf2::getYaw(base_transform.transform.rotation);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <span class="comment">// Current Floor</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      std::string parent_id;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <span class="keywordtype">bool</span> result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        result = <a class="code" href="classmap__manager_1_1MapManager.html#a2119b6c240c04ed0f9fa991333982077">tf_buffer_</a>-&gt;_getParent(<a class="code" href="classmap__manager_1_1MapManager.html#ac6a70fbf9ac90e568e25aea221d0c0bb">robot_map_frame_id_</a>, tf2::TimePointZero, parent_id);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keywordflow">if</span> (result == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;          RCLCPP_ERROR_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;failed to get current floor.&quot;</span>);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;          std::string map_preifx = <span class="stringliteral">&quot;map_&quot;</span>;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;          <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#ac2c56020cad267a628141fc69c73180a">floor_</a> = parent_id.replace(</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            parent_id.find(</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;              map_preifx), map_preifx.length(), <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      } <span class="keywordflow">catch</span> (tf2::TransformException &amp; ex) {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        RCLCPP_ERROR_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Failed to get the current floor : &quot;</span> &lt;&lt; ex.what());</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <a class="code" href="classmap__manager_1_1MapManager.html#a8a900d806e57e143205a86a2bb85765d">motion_state_mutex_</a>.unlock();</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      }</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="comment">// Current Sector</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#af59ff7bf9359a2adb81e19c7abadc5cb">sector_</a> =</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <a class="code" href="classmap__manager_1_1MapManager.html#aafea5fd37c00885e1017a93be4c7178a">sector_list_</a>-&gt;find_sector(</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#ac2c56020cad267a628141fc69c73180a">floor_</a>,</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        base_transform.transform.translation.x,</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        base_transform.transform.translation.y);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">//      RCLCPP_INFO_STREAM(</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">//        this-&gt;get_logger(), &quot;Aimbot is at (&quot; &lt;&lt;</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">//          mobile_motion_state_.pose_2d_from_map_current_.x &lt;&lt; &quot;m, &quot; &lt;&lt;</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">//          mobile_motion_state_.pose_2d_from_map_current_.y &lt;&lt; &quot;m, &quot; &lt;&lt;</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">//          mobile_motion_state_.pose_2d_from_map_current_.theta * 180 / M_PI &lt;&lt;</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">//          &quot;deg), &quot; &lt;&lt; mobile_motion_state_.sector_ &lt;&lt;</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">//          &quot; of &quot; &lt;&lt; mobile_motion_state_.floor_ &lt;&lt;</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">//          &quot; floor now.&quot;);</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="keywordflow">if</span> (previous_x != <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a3fa894f8f09fb6d4e3cbf484bd2048d9">pose_2d_from_map_current_</a>.x ||</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        previous_y != <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a3fa894f8f09fb6d4e3cbf484bd2048d9">pose_2d_from_map_current_</a>.y ||</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        previous_theta != <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a3fa894f8f09fb6d4e3cbf484bd2048d9">pose_2d_from_map_current_</a>.theta)</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <a class="code" href="classmap__manager_1_1MapManager.html#a338dde81bc24116f3abc218f6d198230">save_motion_state_to_log_file</a>();</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      previous_x = <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a3fa894f8f09fb6d4e3cbf484bd2048d9">pose_2d_from_map_current_</a>.x;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      previous_y = <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a3fa894f8f09fb6d4e3cbf484bd2048d9">pose_2d_from_map_current_</a>.y;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      previous_theta = <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a3fa894f8f09fb6d4e3cbf484bd2048d9">pose_2d_from_map_current_</a>.theta;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#a8a900d806e57e143205a86a2bb85765d">motion_state_mutex_</a>.unlock();</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#a0c6bbfcaa0efa3fbb3977b99e0d94ca7">save_motion_state_to_file</a>();</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#a5d01b1a769864bebe21963b7ada39bc0">publish_motion_state</a>();</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    };</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keyword">using namespace </span>std::chrono_literals;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a08443e079f18f047ef9334f9948906c1">timer_</a> = this-&gt;create_wall_timer(200ms, update);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;activate done&quot;</span>);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="keywordflow">return</span> CallbackReturn::SUCCESS;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;}</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a7cef5491d2ff6f28d610cb58c7aa9414">  402</a></span>&#160;rclcpp_lifecycle::node_interfaces::LifecycleNodeInterface::CallbackReturn <a class="code" href="classmap__manager_1_1MapManager.html#a7cef5491d2ff6f28d610cb58c7aa9414">MapManager::on_deactivate</a>(</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keyword">const</span> rclcpp_lifecycle::State &amp; state)</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;{</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  (void) state;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Deactivating Map Manager.&quot;</span>);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#aa6b223ac88d0cd7c1a7690b55b0b0546">motion_state_pub_</a>-&gt;on_deactivate();</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a496982717df5682e482d445ab3dbe551">init_pose_pub_</a>-&gt;on_deactivate();</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> map_server : <a class="code" href="classmap__manager_1_1MapManager.html#a9d504ddaf30710579a3aa9de7ef3635d">map_server_list_</a>) {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    map_server-&gt;on_deactivate();</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a08443e079f18f047ef9334f9948906c1">timer_</a>.reset();</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keywordflow">return</span> CallbackReturn::SUCCESS;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;}</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a186056a572655f45b0d9d49cedf707fe">  418</a></span>&#160;rclcpp_lifecycle::node_interfaces::LifecycleNodeInterface::CallbackReturn <a class="code" href="classmap__manager_1_1MapManager.html#a186056a572655f45b0d9d49cedf707fe">MapManager::on_cleanup</a>(</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="keyword">const</span> rclcpp_lifecycle::State &amp; state)</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;{</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  (void) state;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  RCLCPP_INFO_STREAM(get_logger(), <span class="stringliteral">&quot;Cleanup&quot;</span>);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a5136641f396bbcb67d0cb4ac6df7a456">change_map_server_</a>.reset();</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#ac77dd458c90980a000e794ab1117c137">motion_state_server_</a>.reset();</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#aab269ee8379aa19f20fbe79decdc3e35">get_destination_list_server_</a>.reset();</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a0681a35d142161de0e66c26b037aa7ce">get_destination_server_</a>.reset();</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a3c82a007a0fed93d4a76b4daaadec386">get_waypoint_server_</a>.reset();</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#ae492b65d2a69cf360ec7c849a3d50a97">get_door_pose_server_</a>.reset();</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a2057a553e661e24d93f2ccaa073125a6">get_button_pose_server_</a>.reset();</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a045f8b20b610b8a361901bedc402dbdd">get_nearest_button_server_</a>.reset();</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">//  set_atm_pressure_at_base_floor_server_.reset();</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">//  set_atm_pressure_on_floor_server_.reset();</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a496982717df5682e482d445ab3dbe551">init_pose_pub_</a>.reset();</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#aa6b223ac88d0cd7c1a7690b55b0b0546">motion_state_pub_</a>.reset();</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a9d504ddaf30710579a3aa9de7ef3635d">map_server_list_</a>.clear();</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#acba5941f5d067ece6112c00590888fdd">update_ev_object_action_server_</a>.reset();</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="keywordflow">return</span> CallbackReturn::SUCCESS;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;}</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#ab7d0935d29874372f29865680379dfba">  440</a></span>&#160;rclcpp_lifecycle::node_interfaces::LifecycleNodeInterface::CallbackReturn <a class="code" href="classmap__manager_1_1MapManager.html#ab7d0935d29874372f29865680379dfba">MapManager::on_shutdown</a>(</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keyword">const</span> rclcpp_lifecycle::State &amp; state)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;{</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  (void) state;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a5136641f396bbcb67d0cb4ac6df7a456">change_map_server_</a>.reset();</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#ac77dd458c90980a000e794ab1117c137">motion_state_server_</a>.reset();</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#aab269ee8379aa19f20fbe79decdc3e35">get_destination_list_server_</a>.reset();</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a0681a35d142161de0e66c26b037aa7ce">get_destination_server_</a>.reset();</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a3c82a007a0fed93d4a76b4daaadec386">get_waypoint_server_</a>.reset();</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#ae492b65d2a69cf360ec7c849a3d50a97">get_door_pose_server_</a>.reset();</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a2057a553e661e24d93f2ccaa073125a6">get_button_pose_server_</a>.reset();</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a045f8b20b610b8a361901bedc402dbdd">get_nearest_button_server_</a>.reset();</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">//  set_atm_pressure_at_base_floor_server_.reset();</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">//  set_atm_pressure_on_floor_server_.reset();</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a496982717df5682e482d445ab3dbe551">init_pose_pub_</a>.reset();</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#aa6b223ac88d0cd7c1a7690b55b0b0546">motion_state_pub_</a>.reset();</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a9d504ddaf30710579a3aa9de7ef3635d">map_server_list_</a>.clear();</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#acba5941f5d067ece6112c00590888fdd">update_ev_object_action_server_</a>.reset();</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="keywordflow">return</span> CallbackReturn::SUCCESS;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;}</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a788fabb32e6b80e21f4cb5181d899c7c">  461</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmap__manager_1_1MapManager.html#a788fabb32e6b80e21f4cb5181d899c7c">MapManager::initialize_floor_estimator</a>()</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;{</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a7d399ff9763b880fd2596af082c9b1f5">floor_estimation_by_atm_pressure_ptr_</a> = std::make_shared&lt;FloorEstimationByAtmPressure&gt;(</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    this-&gt;get_logger());</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="comment">// Load altitude_to_pressure_ratio_</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keywordtype">double</span> altitude_to_pressure_ratio;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    std::string atm_pressure_file_path = ament_index_cpp::get_package_share_directory(</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <span class="stringliteral">&quot;map_manager&quot;</span>) +</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <span class="stringliteral">&quot;/state/base_atm_pressure.yaml&quot;</span>;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    YAML::Node node = YAML::LoadFile(atm_pressure_file_path.c_str());</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    altitude_to_pressure_ratio = node[<span class="stringliteral">&quot;altitude_ratio_to_atm_pressure&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      this-&gt;get_logger(),</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <span class="stringliteral">&quot;loaded altitude to pressureratio is &#39;&quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(altitude_to_pressure_ratio));</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp; e) {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    RCLCPP_ERROR_STREAM(</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      this-&gt;get_logger(),</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <span class="stringliteral">&quot;Fail to load base atm pressure data. : &quot;</span> &lt;&lt; e.what());</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="comment">// Load Floor height</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  std::string floor_height_path =</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    ament_index_cpp::get_package_share_directory(<span class="stringliteral">&quot;aimbot_params&quot;</span>) +</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="stringliteral">&quot;/site/&quot;</span> +</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#abafd8e1c11994af6f66c5c85e480fcbc">map_site_name_</a> +</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="stringliteral">&quot;/map/floor_height.yaml&quot;</span>;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    this-&gt;get_logger(),</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="stringliteral">&quot;Load &#39;Floor Height&#39; from &#39;&quot;</span> &lt;&lt; floor_height_path &lt;&lt; <span class="stringliteral">&quot;&#39;.&quot;</span>);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classmap__manager_1_1MapManager.html#a7d399ff9763b880fd2596af082c9b1f5">floor_estimation_by_atm_pressure_ptr_</a>-&gt;initialize(</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    altitude_to_pressure_ratio,</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#ac2c56020cad267a628141fc69c73180a">floor_</a>,</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    floor_height_path);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;}</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a9621392c21b63cfbfee973bb40e63edf">  501</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmap__manager_1_1MapManager.html#a9621392c21b63cfbfee973bb40e63edf">MapManager::atm_pressure_callback</a>(<span class="keyword">const</span> sensor_msgs::msg::FluidPressure::SharedPtr msg)</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;{</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a760171f9d3fd955360b6aee03c3f11ba">present_atm_pressure_</a> = *msg;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  std::string current_atm_floor = <a class="code" href="classmap__manager_1_1MapManager.html#a7d399ff9763b880fd2596af082c9b1f5">floor_estimation_by_atm_pressure_ptr_</a>-&gt;get_current_floor(msg);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a8a900d806e57e143205a86a2bb85765d">motion_state_mutex_</a>.lock();</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#afc1fd1bca09f4df6cb0f59dc36dd351f">atm_floor_</a> = current_atm_floor;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a8a900d806e57e143205a86a2bb85765d">motion_state_mutex_</a>.unlock();</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;}</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#abe3f09975c3337451f1d9d0b2f0b8de4">  510</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmap__manager_1_1MapManager.html#abe3f09975c3337451f1d9d0b2f0b8de4">MapManager::save_atm_pressure_timer_callback</a>()</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;{</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  rclcpp::WallRate wall_rate(5);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  rclcpp::Time start_time = this-&gt;now();</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="keywordflow">while</span> (rclcpp::ok() &amp;&amp; <a class="code" href="classmap__manager_1_1MapManager.html#a27c2d32709db825f995997c5899a74d9">save_atm_pressure_flag_</a> &amp;&amp; <a class="code" href="classmap__manager_1_1MapManager.html#a2e0d3b6cd0b285ecb4a3e75252c3022b">pressure_stream_</a>-&gt;is_open()) {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    rclcpp::Time ros_time = this-&gt;now();</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">if</span> (ros_time.seconds() - start_time.seconds() &gt; 3600) {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      *<a class="code" href="classmap__manager_1_1MapManager.html#a2e0d3b6cd0b285ecb4a3e75252c3022b">pressure_stream_</a> &lt;&lt; <span class="stringliteral">&quot;Timeout finish\n&quot;</span>;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#a2e0d3b6cd0b285ecb4a3e75252c3022b">pressure_stream_</a>-&gt;close();</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#a27c2d32709db825f995997c5899a74d9">save_atm_pressure_flag_</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    }</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="comment">// Print</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    time_t now = ros_time.seconds();</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keyword">struct </span>tm tstruct;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    localtime_r(&amp;now, &amp;tstruct);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordtype">char</span> time[50];</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    std::strftime(time, <span class="keyword">sizeof</span>(time), <span class="stringliteral">&quot;%Y-%m-%d,%H:%M:%S&quot;</span>, &amp;tstruct);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordtype">double</span> ms =</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      (ros_time.seconds() - <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(ros_time.seconds()))) * 1000.0;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    *<a class="code" href="classmap__manager_1_1MapManager.html#a2e0d3b6cd0b285ecb4a3e75252c3022b">pressure_stream_</a> &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; std::dec &lt;&lt; std::setw(3) &lt;&lt; std::setfill(<span class="charliteral">&#39;0&#39;</span>) &lt;&lt;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(ms) &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; ros_time.seconds() &lt;&lt;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; <a class="code" href="classmap__manager_1_1MapManager.html#a760171f9d3fd955360b6aee03c3f11ba">present_atm_pressure_</a>.fluid_pressure &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    wall_rate.sleep();</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  }</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;}</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a56b226dafd436de9f37215d35be9e76b">  540</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmap__manager_1_1MapManager.html#a56b226dafd436de9f37215d35be9e76b">MapManager::start_save_atm_pressure_callback</a>(<span class="keyword">const</span> std_msgs::msg::String::SharedPtr msg)</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;{</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="comment">// Save Log</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classmap__manager_1_1MapManager.html#a27c2d32709db825f995997c5899a74d9">save_atm_pressure_flag_</a> == <span class="keyword">true</span>) {<span class="keywordflow">return</span>;}</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  rclcpp::Time ros_time = this-&gt;now();</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  time_t now = ros_time.seconds();</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keyword">struct </span>tm tstruct;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  localtime_r(&amp;now, &amp;tstruct);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="keywordtype">char</span> time_buf[100];</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  strftime(time_buf, <span class="keyword">sizeof</span>(time_buf), <span class="stringliteral">&quot;%Y-%m-%d_%H-%M&quot;</span>, &amp;tstruct);    <span class="comment">// YYYY-MM-DD</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  std::string dir_path = std::string(getenv(<span class="stringliteral">&quot;HOME&quot;</span>)) + <span class="stringliteral">&quot;/atm_pressure/&quot;</span>;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="keyword">struct </span>stat info;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="keywordflow">if</span> (stat(dir_path.c_str(), &amp;info) != 0) {</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="comment">// directory doesn&#39;t exist, create it</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    mkdir(dir_path.c_str(), 0700);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (info.st_mode &amp; S_IFDIR) {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="comment">// directory exists</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="comment">// exists but is not a directory</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    mkdir(dir_path.c_str(), 0700);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  }</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  std::string file_name = dir_path +</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    time_buf + <span class="stringliteral">&quot;_&quot;</span> + msg-&gt;data + <span class="stringliteral">&quot;F.csv&quot;</span>;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="keywordtype">bool</span> file_exist_flag = (access(file_name.c_str(), F_OK) != -1);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    get_logger(), <span class="stringliteral">&quot;[start_save_atm_pressure_callback] save_path : &quot;</span> &lt;&lt; file_name.c_str());</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    get_logger(), (file_exist_flag ?</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="stringliteral">&quot;[start_save_atm_pressure_callback] File is exist&quot;</span> :</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="stringliteral">&quot;[start_save_atm_pressure_callback] Make a new file&quot;</span>));</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classmap__manager_1_1MapManager.html#a27c2d32709db825f995997c5899a74d9">save_atm_pressure_flag_</a>) {</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classmap__manager_1_1MapManager.html#a2e0d3b6cd0b285ecb4a3e75252c3022b">pressure_stream_</a>-&gt;is_open()) {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#a2e0d3b6cd0b285ecb4a3e75252c3022b">pressure_stream_</a>-&gt;close();</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#a2e0d3b6cd0b285ecb4a3e75252c3022b">pressure_stream_</a>-&gt;open(file_name, std::ofstream::out | std::ofstream::app);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordflow">if</span> (file_exist_flag == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      *<a class="code" href="classmap__manager_1_1MapManager.html#a2e0d3b6cd0b285ecb4a3e75252c3022b">pressure_stream_</a> &lt;&lt; <span class="stringliteral">&quot;START FLOOR:,&quot;</span> &lt;&lt; msg-&gt;data &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      *<a class="code" href="classmap__manager_1_1MapManager.html#a2e0d3b6cd0b285ecb4a3e75252c3022b">pressure_stream_</a> &lt;&lt; <span class="stringliteral">&quot;Date,Time,UNIX Time,ATM pressure\n&quot;</span>;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    }</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#a27c2d32709db825f995997c5899a74d9">save_atm_pressure_flag_</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#a31a03c24e4de79909926500e7fa2c119">save_atm_pressure_future_</a> = std::async(</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      std::launch::async,</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      &amp;<a class="code" href="classmap__manager_1_1MapManager.html#abe3f09975c3337451f1d9d0b2f0b8de4">MapManager::save_atm_pressure_timer_callback</a>,</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      <span class="keyword">this</span>);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    *<a class="code" href="classmap__manager_1_1MapManager.html#a2e0d3b6cd0b285ecb4a3e75252c3022b">pressure_stream_</a> &lt;&lt; <span class="stringliteral">&quot;NEW START FLOOR:,&quot;</span> &lt;&lt; msg-&gt;data &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    RCLCPP_ERROR_STREAM(</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      this-&gt;get_logger(), <span class="stringliteral">&quot;[start_save_atm_pressure_callback] thread is already running.&quot;</span>);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  }</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;}</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; </div>
<div class="line"><a name="l00599"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#aeb93ea87886b82b5f99a4bf49fe084c1">  599</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmap__manager_1_1MapManager.html#aeb93ea87886b82b5f99a4bf49fe084c1">MapManager::stop_save_atm_pressure_callback</a>(<span class="keyword">const</span> std_msgs::msg::String::SharedPtr msg)</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;{</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="comment">// Save Log</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a27c2d32709db825f995997c5899a74d9">save_atm_pressure_flag_</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classmap__manager_1_1MapManager.html#a31a03c24e4de79909926500e7fa2c119">save_atm_pressure_future_</a>.valid() &amp;&amp; <a class="code" href="classmap__manager_1_1MapManager.html#a2e0d3b6cd0b285ecb4a3e75252c3022b">pressure_stream_</a>-&gt;is_open()) {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classmap__manager_1_1MapManager.html#a31a03c24e4de79909926500e7fa2c119">save_atm_pressure_future_</a>.get()) {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      *<a class="code" href="classmap__manager_1_1MapManager.html#a2e0d3b6cd0b285ecb4a3e75252c3022b">pressure_stream_</a> &lt;&lt; <span class="stringliteral">&quot;END FLOOR:,&quot;</span> &lt;&lt; msg-&gt;data &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#a2e0d3b6cd0b285ecb4a3e75252c3022b">pressure_stream_</a>-&gt;close();</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        this-&gt;get_logger(), <span class="stringliteral">&quot;[stop_save_atm_pressure_callback] Success to save atm_pressue.&quot;</span>);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#a2e0d3b6cd0b285ecb4a3e75252c3022b">pressure_stream_</a>-&gt;close();</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      RCLCPP_ERROR_STREAM(</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        this-&gt;get_logger(), <span class="stringliteral">&quot;[stop_save_atm_pressure_callback] Fail to save atm_pressure.&quot;</span>);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    }</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    RCLCPP_ERROR_STREAM(</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      this-&gt;get_logger(),</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      <span class="stringliteral">&quot;[stop_save_atm_pressure_callback] thread or file is not valid.&quot;</span>);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  }</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;}</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160; </div>
<div class="line"><a name="l00622"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#aa9dca860f14eb942ca6b50463e87e3fe">  622</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmap__manager_1_1MapManager.html#aa9dca860f14eb942ca6b50463e87e3fe">MapManager::change_floor_callback</a>(<span class="keyword">const</span> std_msgs::msg::String::SharedPtr msg)</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;{</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> map : <a class="code" href="classmap__manager_1_1MapManager.html#a2cd07fd57027b359e8677aee6e8930dc">map_list_</a>) {</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="keywordflow">if</span> (map.get_name() == msg-&gt;data) {</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      <span class="comment">// load new map</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#a631536d1fb1937e6492a38e148bd50a7">send_current_map_to_nav</a>(map.get_map_file_path());</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#ab0690c838523c783bb4ff9b5cf8831e6">current_map_frame_id_</a> = map.get_frame();</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        this-&gt;get_logger(),</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <span class="stringliteral">&quot;Spinning until killed publishing transform from &#39;&quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;          map.get_frame() &lt;&lt; <span class="stringliteral">&quot;&#39; to &#39;&quot;</span> &lt;&lt; <a class="code" href="classmap__manager_1_1MapManager.html#ab0690c838523c783bb4ff9b5cf8831e6">current_map_frame_id_</a> &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    }</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  }</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;}</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#ad7122f88aaa058a18fcfae6e975c32b7">  638</a></span>&#160;rclcpp_action::GoalResponse <a class="code" href="classmap__manager_1_1MapManager.html#ad7122f88aaa058a18fcfae6e975c32b7">MapManager::ev_object_goal_callback</a>(</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <span class="keyword">const</span> rclcpp_action::GoalUUID &amp; uuid,</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  std::shared_ptr&lt;const aimbot_state_interfaces::action::UpdateEVObject::Goal&gt; goal)</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;{</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Received request to EXCUTE update_ev_object&quot;</span>);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  (void)uuid;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classmap__manager_1_1MapManager.html#af93982b338cf6e2af4bc34772da668dc">goal_handle_</a>) {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classmap__manager_1_1MapManager.html#af93982b338cf6e2af4bc34772da668dc">goal_handle_</a>-&gt;is_executing()) {</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      <span class="keyword">auto</span> result = std::make_shared&lt;UpdateEVObject::Result&gt;();</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      result-&gt;result = UpdateEVObject::Result::NEW_GOAL;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#af93982b338cf6e2af4bc34772da668dc">goal_handle_</a>-&gt;abort(result);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#af93982b338cf6e2af4bc34772da668dc">goal_handle_</a>.reset();</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#abc2ee2e2cab883740315dcc775869165">update_ev_object_timer_</a>-&gt;cancel();</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#abc2ee2e2cab883740315dcc775869165">update_ev_object_timer_</a>.reset();</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    }</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  }</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> target_frame_id : goal-&gt;frame_id) {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;target_frame_id : &quot;</span> &lt;&lt; target_frame_id);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  }</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <span class="keywordflow">return</span> rclcpp_action::GoalResponse::ACCEPT_AND_EXECUTE;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;}</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160; </div>
<div class="line"><a name="l00660"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a60934a3e4d02c94bca83525e086221a5">  660</a></span>&#160;rclcpp_action::CancelResponse <a class="code" href="classmap__manager_1_1MapManager.html#a60934a3e4d02c94bca83525e086221a5">MapManager::ev_object_cancel_callback</a>(</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="keyword">const</span> std::shared_ptr&lt;rclcpp_action::ServerGoalHandle&lt;MapManager::UpdateEVObject&gt;&gt; goal_handle)</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;{</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Received request to CANCEL update_ev_object&quot;</span>);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classmap__manager_1_1MapManager.html#af93982b338cf6e2af4bc34772da668dc">goal_handle_</a> == goal_handle) {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#abc2ee2e2cab883740315dcc775869165">update_ev_object_timer_</a>-&gt;cancel();</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#abc2ee2e2cab883740315dcc775869165">update_ev_object_timer_</a>.reset();</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#af93982b338cf6e2af4bc34772da668dc">goal_handle_</a>.reset();</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  }</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <span class="keywordflow">return</span> rclcpp_action::CancelResponse::ACCEPT;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;}</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a1e1133b56d40589a30c3803dbbd1e240">  673</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmap__manager_1_1MapManager.html#a1e1133b56d40589a30c3803dbbd1e240">MapManager::ev_object_aceepted_callback</a>(</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  std::shared_ptr&lt;rclcpp_action::ServerGoalHandle&lt;MapManager::UpdateEVObject&gt;&gt; goal_handle)</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;{</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Received request to ACCEPTED update_ev_object&quot;</span>);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#af93982b338cf6e2af4bc34772da668dc">goal_handle_</a> = goal_handle;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#ae745696a0c6f210b7107c809ab1aa9e1">ev_object_action_start_time_</a> = this-&gt;now();</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160; </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <span class="keywordtype">double</span> feedback_time_ms = 1000.0 / 100;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#abc2ee2e2cab883740315dcc775869165">update_ev_object_timer_</a> = this-&gt;create_wall_timer(</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    std::chrono::milliseconds(</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(feedback_time_ms)), std::bind(&amp;<a class="code" href="classmap__manager_1_1MapManager.html#aa59a8e80d33b9f91b5bbc240fd50145c">MapManager::update_ev_object</a>, <span class="keyword">this</span>));</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;}</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; </div>
<div class="line"><a name="l00686"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#aa59a8e80d33b9f91b5bbc240fd50145c">  686</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmap__manager_1_1MapManager.html#aa59a8e80d33b9f91b5bbc240fd50145c">MapManager::update_ev_object</a>()</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;{</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <span class="keyword">auto</span> target_frame_ids = <a class="code" href="classmap__manager_1_1MapManager.html#af93982b338cf6e2af4bc34772da668dc">goal_handle_</a>-&gt;get_goal()-&gt;frame_id;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <span class="keyword">auto</span> feedback = std::make_shared&lt;UpdateEVObject::Feedback&gt;();</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;[ev_object feedback] Tick&quot;</span>);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <span class="keywordflow">for</span> (std::string frame_id : target_frame_ids) {</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      geometry_msgs::msg::TransformStamped base_transform;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      base_transform = <a class="code" href="classmap__manager_1_1MapManager.html#a2119b6c240c04ed0f9fa991333982077">tf_buffer_</a>-&gt;lookupTransform(</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <a class="code" href="classmap__manager_1_1MapManager.html#ac6a70fbf9ac90e568e25aea221d0c0bb">robot_map_frame_id_</a>, frame_id,</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        rclcpp::Time(0), rclcpp::Duration::from_seconds(0.5));</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      <span class="comment">// request-&gt;reference.stamp, rclcpp::Duration::from_seconds(0.5));</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      tf2::Transform base_tf;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      base_tf.setOrigin(</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        tf2::Vector3(</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;          base_transform.transform.translation.x,</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;          base_transform.transform.translation.y,</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;          base_transform.transform.translation.z));</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      base_tf.setRotation(</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        tf2::Quaternion(</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;          base_transform.transform.rotation.x,</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;          base_transform.transform.rotation.y,</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;          base_transform.transform.rotation.z,</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;          base_transform.transform.rotation.w));</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">//      RCLCPP_INFO_STREAM(this-&gt;get_logger(), &quot;[ev_object feedback] get &#39;&quot; &lt;&lt; frame_id &lt;&lt; &quot;&#39; tf.&quot;);</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      std::string current_floor = <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#ac2c56020cad267a628141fc69c73180a">floor_</a>;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      std::string current_sector = <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#af59ff7bf9359a2adb81e19c7abadc5cb">sector_</a>;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160; </div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      <span class="comment">// Get boundary list on present position</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      aimbot_state_interfaces::msg::EVObjectArray ev_object_array_msg;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; ev_object : <a class="code" href="classmap__manager_1_1MapManager.html#a45595a5e2f526bc23ccbe25e46ab7137">ev_object_list_</a>) {</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <span class="keywordtype">bool</span> is_include_obj = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        aimbot_state_interfaces::msg::EVObject ev_objects_msg;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="comment">// boundary</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; boundary : ev_object.second.boundarys) {</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;          <span class="keywordflow">if</span> (boundary.sector == current_sector &amp;&amp;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;            std::unordered_set&lt;std::string&gt;(</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;              boundary.floor.begin(),</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;              boundary.floor.end()).count(current_floor))</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;          {</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> point : boundary.polygon.points) {</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;              tf2::Transform boundary_point_tf;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;              boundary_point_tf.setOrigin(</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                tf2::Vector3(point.x, point.y, point.z));</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;              <span class="keyword">auto</span> boundary_point_pose = base_tf.inverse() * boundary_point_tf;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;              geometry_msgs::msg::Point32 point_msg;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;              point_msg.x = boundary_point_pose.getOrigin().x();</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;              point_msg.y = boundary_point_pose.getOrigin().y();</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;              point_msg.z = boundary_point_pose.getOrigin().z();</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;              ev_objects_msg.boundary.points.push_back(point_msg);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            }</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            is_include_obj = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;          }</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        }</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <span class="comment">// objects</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; obj : ev_object.second.objects) {</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;          <span class="keywordflow">if</span> (obj.sector == current_sector &amp;&amp;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            std::unordered_set&lt;std::string&gt;(</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;              obj.floor.begin(),</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;              obj.floor.end()).count(current_floor))</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;          {</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            aimbot_state_interfaces::msg::Object obj_msg;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            obj_msg.obj_name = obj.name;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            tf2::Transform obj_tf;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            obj_tf.setOrigin(</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;              tf2::Vector3(</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                obj.pose.position.x,</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                obj.pose.position.y,</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                obj.pose.position.z));</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            obj_tf.setRotation(</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;              tf2::Quaternion(</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                obj.pose.orientation.x,</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                obj.pose.orientation.y,</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                obj.pose.orientation.z,</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                obj.pose.orientation.w));</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            <span class="keyword">auto</span> obj_pose = base_tf.inverse() * obj_tf;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            obj_msg.ev_obj_pose.position.x = obj_pose.getOrigin().x();</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            obj_msg.ev_obj_pose.position.y = obj_pose.getOrigin().y();</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            obj_msg.ev_obj_pose.position.z = obj_pose.getOrigin().z();</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            obj_msg.ev_obj_pose.orientation.w = obj_pose.getRotation().w();</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            obj_msg.ev_obj_pose.orientation.x = obj_pose.getRotation().x();</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            obj_msg.ev_obj_pose.orientation.y = obj_pose.getRotation().y();</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            obj_msg.ev_obj_pose.orientation.z = obj_pose.getRotation().z();</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            ev_objects_msg.ev_object.emplace_back(obj_msg);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            is_include_obj = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;          }</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        }</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160; </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        <span class="keywordflow">if</span> (is_include_obj) {</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;          ev_object_array_msg.ev_num.emplace_back(ev_object.first);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;          ev_object_array_msg.ev_objects.emplace_back(ev_objects_msg);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        }</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;      }</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      feedback-&gt;stamp = base_transform.header.stamp;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      feedback-&gt;frame_id.push_back(frame_id);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      feedback-&gt;ev_objects.push_back(ev_object_array_msg);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    } <span class="keywordflow">catch</span> (tf2::TransformException &amp; ex) {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      RCLCPP_WARN_STREAM(</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        this-&gt;get_logger(),</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        <span class="stringliteral">&quot;Failed to get the TF, so the Pose relative to map_current is returned. : &quot;</span> &lt;&lt; ex.what());</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    }</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  }</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160; </div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#af93982b338cf6e2af4bc34772da668dc">goal_handle_</a>-&gt;publish_feedback(feedback);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160; </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <span class="keywordflow">if</span> (this-&gt;now().seconds() - <a class="code" href="classmap__manager_1_1MapManager.html#ae745696a0c6f210b7107c809ab1aa9e1">ev_object_action_start_time_</a>.seconds() &gt; 300.0) {</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    RCLCPP_WARN_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;TIMEOUT&quot;</span>);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="keyword">auto</span> result = std::make_shared&lt;UpdateEVObject::Result&gt;();</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    result-&gt;result = UpdateEVObject::Result::TIMEOUT;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#abc2ee2e2cab883740315dcc775869165">update_ev_object_timer_</a>-&gt;cancel();</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#abc2ee2e2cab883740315dcc775869165">update_ev_object_timer_</a>.reset();</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#af93982b338cf6e2af4bc34772da668dc">goal_handle_</a>-&gt;abort(result);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#af93982b338cf6e2af4bc34772da668dc">goal_handle_</a>.reset();</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  }</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;}</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160; </div>
<div class="line"><a name="l00806"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a2eb45c2838fbe2e1fbb1afc55ecf759b">  806</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmap__manager_1_1MapManager.html#a2eb45c2838fbe2e1fbb1afc55ecf759b">MapManager::change_map_srv_callback</a>(</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <span class="keyword">const</span> std::shared_ptr&lt;rmw_request_id_t&gt; request_header,</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <span class="keyword">const</span> std::shared_ptr&lt;aimbot_state_interfaces::srv::ChangeMap::Request&gt; request,</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  std::shared_ptr&lt;aimbot_state_interfaces::srv::ChangeMap::Response&gt; response)</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;{</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  (void)request_header;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;change map service callback&quot;</span>);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160; </div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  std::string map_name = request-&gt;map_name;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <span class="comment">// Find map</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> map : <a class="code" href="classmap__manager_1_1MapManager.html#a2cd07fd57027b359e8677aee6e8930dc">map_list_</a>) {</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="keywordflow">if</span> (map.get_name() == map_name) {</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;success to find map : &quot;</span> &lt;&lt; map.get_map_file_path());</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      <span class="comment">// load new map</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      uint8_t service_result = <a class="code" href="classmap__manager_1_1MapManager.html#a631536d1fb1937e6492a38e148bd50a7">send_current_map_to_nav</a>(map.get_map_file_path());</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      response-&gt;set__result(service_result);</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160; </div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      <span class="keywordflow">if</span> (service_result == aimbot_state_interfaces::srv::ChangeMap::Response::RESULT_SUCCESS) {</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;          this-&gt;get_logger(),</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;          <span class="stringliteral">&quot;Seccess to change map &#39;&quot;</span> &lt;&lt; map.get_frame() &lt;&lt; <span class="stringliteral">&quot;&#39;.&quot;</span>);</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        <a class="code" href="classmap__manager_1_1MapManager.html#ab0690c838523c783bb4ff9b5cf8831e6">current_map_frame_id_</a> = map.get_frame();</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        RCLCPP_ERROR_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Fail to change &quot;</span> &lt;&lt; <a class="code" href="classmap__manager_1_1MapManager.html#ab0690c838523c783bb4ff9b5cf8831e6">current_map_frame_id_</a>);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      }</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    }</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  }</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="comment">// map is empty</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  RCLCPP_ERROR_STREAM(</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    this-&gt;get_logger(), <span class="stringliteral">&quot;Can not find &#39;&quot;</span> &lt;&lt; request-&gt;map_name &lt;&lt; <span class="stringliteral">&quot;&#39; in map_info.&quot;</span>);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  response-&gt;set__result(</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    aimbot_state_interfaces::srv::ChangeMap::Response::RESULT_LOAD_MAP_FAILURE);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;}</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160; </div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00844"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a631536d1fb1937e6492a38e148bd50a7">  844</a></span>&#160;uint8_t <a class="code" href="classmap__manager_1_1MapManager.html#a631536d1fb1937e6492a38e148bd50a7">MapManager::send_current_map_to_nav</a>(<span class="keyword">const</span> std::string &amp; map_file_path)</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;{</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classmap__manager_1_1MapManager.html#aee0008cbfa0eab2665b9e3f04b4bf532">load_map_client_</a>-&gt;wait_for_service(std::chrono::duration&lt;int, std::milli&gt;(5000))) {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    RCLCPP_ERROR_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Failed to make a service for loading map&quot;</span>);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordflow">return</span> aimbot_state_interfaces::srv::ChangeMap::Response::RESULT_SERVICE_LOAD_FAILURE;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  }</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <span class="keyword">auto</span> request = std::make_shared&lt;nav2_msgs::srv::LoadMap::Request&gt;();</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  request-&gt;map_url = map_file_path;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="keyword">auto</span> inner_future = <a class="code" href="classmap__manager_1_1MapManager.html#aee0008cbfa0eab2665b9e3f04b4bf532">load_map_client_</a>-&gt;async_send_request(request);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="keyword">auto</span> result = inner_future.wait_for(std::chrono::seconds(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(2.0)));</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="keywordflow">switch</span> (result) {</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="keywordflow">case</span> std::future_status::ready:</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160; </div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordflow">case</span> std::future_status::timeout:</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      RCLCPP_ERROR_STREAM(get_logger(), <span class="stringliteral">&quot;service future : timeout&quot;</span>);</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      <span class="keywordflow">return</span> aimbot_state_interfaces::srv::ChangeMap::Response::RESULT_SERVICE_CALL_TIMEOUT;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160; </div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      <span class="keywordflow">return</span> aimbot_state_interfaces::srv::ChangeMap::Response::RESULT_SERVICE_CALL_FAILURE;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  }</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  <span class="keyword">auto</span> response = inner_future.get();</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  <span class="keywordflow">if</span> (response-&gt;result == nav2_msgs::srv::LoadMap::Response::RESULT_SUCCESS) {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Change current floor map : &quot;</span> &lt;&lt; request-&gt;map_url);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    RCLCPP_ERROR_STREAM(</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      this-&gt;get_logger(), <span class="stringliteral">&quot;Fail to change current floor map (&quot;</span> &lt;&lt; response-&gt;result &lt;&lt; <span class="stringliteral">&quot;).&quot;</span>);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  }</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  <span class="keywordflow">return</span> response-&gt;result;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;}</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160; </div>
<div class="line"><a name="l00875"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a7071293836db63e8aa53f4ac65775d16">  875</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmap__manager_1_1MapManager.html#a7071293836db63e8aa53f4ac65775d16">MapManager::init_pose_callback</a>(</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="keyword">const</span> geometry_msgs::msg::PoseWithCovarianceStamped::SharedPtr msg)</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;{</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Subscription initial pose msg&quot;</span>);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160; </div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <span class="keywordflow">if</span> (msg-&gt;header.frame_id == <span class="stringliteral">&quot;map&quot;</span>) {</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Frame id : map -&gt; map_current&quot;</span>);</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160; </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    geometry_msgs::msg::PoseWithCovarianceStamped new_msg = *msg;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    new_msg.header.frame_id = <a class="code" href="classmap__manager_1_1MapManager.html#ac6a70fbf9ac90e568e25aea221d0c0bb">robot_map_frame_id_</a>;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    new_msg.header.stamp = this-&gt;now();</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160; </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    std::string map_frame_name = <a class="code" href="classmap__manager_1_1MapManager.html#ab0690c838523c783bb4ff9b5cf8831e6">current_map_frame_id_</a>;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160; </div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    std::shared_ptr&lt;MapInfo&gt; map_info;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160; </div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> map : <a class="code" href="classmap__manager_1_1MapManager.html#a2cd07fd57027b359e8677aee6e8930dc">map_list_</a>) {</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;      <span class="keywordflow">if</span> (map.get_frame() == map_frame_name) {</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        map_info = std::make_shared&lt;MapInfo&gt;(map);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      }</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    }</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160; </div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="keywordflow">if</span> (map_info == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    }</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160; </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    geometry_msgs::msg::TransformStamped base_transform;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    base_transform.transform.translation.x = -map_info-&gt;get_tf_offset_x();</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    base_transform.transform.translation.y = -map_info-&gt;get_tf_offset_y();</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    base_transform.transform.translation.z = -map_info-&gt;get_tf_offset_z();</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="comment">// set before pose</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    geometry_msgs::msg::PoseStamped before_pose, after_pose;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    before_pose.pose = new_msg.pose.pose;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="comment">//    before_pose.pose.position.x = pose_2d.x;</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="comment">//    before_pose.pose.position.y = pose_2d.y;</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="comment">//    // orientation</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="comment">//    tf2::Quaternion before_q;</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="comment">//    before_q.setRPY(0.0, 0.0, pose_2d.theta);</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="comment">//    tf2::convert(before_q, before_pose.pose.orientation);</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160; </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="comment">// transform</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    tf2::doTransform(before_pose, after_pose, base_transform);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    new_msg.pose.pose = after_pose.pose;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; </div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      this-&gt;get_logger(),</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      <span class="stringliteral">&quot;New Init pose : &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        new_msg.pose.pose.position.x &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        new_msg.pose.pose.position.y &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        new_msg.pose.pose.position.z &lt;&lt; <span class="stringliteral">&quot; | &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        new_msg.pose.pose.orientation.x &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        new_msg.pose.pose.orientation.y &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        new_msg.pose.pose.orientation.z &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        new_msg.pose.pose.orientation.w);</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160; </div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="comment">// publish</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#a496982717df5682e482d445ab3dbe551">init_pose_pub_</a>-&gt;publish(new_msg);</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  }</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;}</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160; </div>
<div class="line"><a name="l00938"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#abe8ee1f3d97cc125a966758993a9ba08">  938</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmap__manager_1_1MapManager.html#abe8ee1f3d97cc125a966758993a9ba08">MapManager::load_map_info</a>()</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;{</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  std::string map_info_path =</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    ament_index_cpp::get_package_share_directory(<span class="stringliteral">&quot;aimbot_params&quot;</span>) +</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <span class="stringliteral">&quot;/site/&quot;</span> +</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#abafd8e1c11994af6f66c5c85e480fcbc">map_site_name_</a> +</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="stringliteral">&quot;/map/maps/map_info.yaml&quot;</span>;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Load &#39;Map_info&#39; from &#39;&quot;</span> &lt;&lt; map_info_path &lt;&lt; <span class="stringliteral">&quot;&#39;.&quot;</span>);</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  YAML::Node doc;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a2cd07fd57027b359e8677aee6e8930dc">map_list_</a>.clear();</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160; </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    doc = YAML::LoadFile(map_info_path.c_str());</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="keywordflow">for</span> (YAML::iterator yaml_it = doc.begin(); yaml_it != doc.end(); ++yaml_it) {</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      std::string name = yaml_it-&gt;first.as&lt;std::string&gt;();</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      YAML::Node sub_node = yaml_it-&gt;second;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160; </div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;      <a class="code" href="classmap__manager_1_1MapInfo.html">MapInfo</a> map_info(name, sub_node);</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#a2cd07fd57027b359e8677aee6e8930dc">map_list_</a>.push_back(map_info);</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    }</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp; e) {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    RCLCPP_ERROR_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Fail to load map config data. : &quot;</span> &lt;&lt; e.what());</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  }</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160; </div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Loaded map number is &quot;</span> &lt;&lt; <a class="code" href="classmap__manager_1_1MapManager.html#a2cd07fd57027b359e8677aee6e8930dc">map_list_</a>.size());</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;}</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160; </div>
<div class="line"><a name="l00967"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#ab028417b8bdc1ce6f9a379ab1a7c0ba3">  967</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmap__manager_1_1MapManager.html#ab028417b8bdc1ce6f9a379ab1a7c0ba3">MapManager::load_motion_state_from_file</a>(<a class="code" href="structmap__manager_1_1AimbotMotionState.html">AimbotMotionState</a> * state)    <span class="comment">// Load File</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;{</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    std::string state_file_path = ament_index_cpp::get_package_share_directory(</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      <span class="stringliteral">&quot;map_manager&quot;</span>) +</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      <span class="stringliteral">&quot;/state/robot_state.yaml&quot;</span>;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="comment">// Node</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    YAML::Node node = YAML::LoadFile(state_file_path.c_str());</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    YAML::Node state_node = node[<span class="stringliteral">&quot;state&quot;</span>];</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160; </div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="comment">// Time</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    YAML::Node time_node = state_node[<span class="stringliteral">&quot;stamp&quot;</span>];</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    rclcpp::Time stamp(time_node[<span class="stringliteral">&quot;sec&quot;</span>].as&lt;int32_t&gt;(), time_node[<span class="stringliteral">&quot;nsec&quot;</span>].as&lt;uint32_t&gt;());</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    state-&gt;<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a16a596b50b6aaa332a0ff01a832015c9">stamp_</a> = stamp;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160; </div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="comment">// TF</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    YAML::Node tf_node = state_node[<span class="stringliteral">&quot;tf&quot;</span>];</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    state-&gt;<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a9977f778ffcae79ca443e1b5cc75bf89">map_current_frame_id_</a> = tf_node[<span class="stringliteral">&quot;map_current&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    state-&gt;<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a3fa894f8f09fb6d4e3cbf484bd2048d9">pose_2d_from_map_current_</a>.x = tf_node[<span class="stringliteral">&quot;x&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    state-&gt;<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a3fa894f8f09fb6d4e3cbf484bd2048d9">pose_2d_from_map_current_</a>.y = tf_node[<span class="stringliteral">&quot;y&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    state-&gt;<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a3fa894f8f09fb6d4e3cbf484bd2048d9">pose_2d_from_map_current_</a>.theta = tf_node[<span class="stringliteral">&quot;theta&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;() * M_PI / 180.0;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160; </div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="comment">// State</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    state-&gt;<a class="code" href="structmap__manager_1_1AimbotMotionState.html#ac2c56020cad267a628141fc69c73180a">floor_</a> = state_node[<span class="stringliteral">&quot;floor&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    state-&gt;<a class="code" href="structmap__manager_1_1AimbotMotionState.html#af59ff7bf9359a2adb81e19c7abadc5cb">sector_</a> = state_node[<span class="stringliteral">&quot;sector&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp; e) {</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    RCLCPP_ERROR_STREAM(</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;      this-&gt;get_logger(),</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      <span class="stringliteral">&quot;Fail to load aimbot state config data. : &quot;</span> &lt;&lt; e.what());</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  }</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;}</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160; </div>
<div class="line"><a name="l01001"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a0c6bbfcaa0efa3fbb3977b99e0d94ca7"> 1001</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmap__manager_1_1MapManager.html#a0c6bbfcaa0efa3fbb3977b99e0d94ca7">MapManager::save_motion_state_to_file</a>()                               <span class="comment">// Save File</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;{</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  std::string state_file_path = ament_index_cpp::get_package_share_directory(</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <span class="stringliteral">&quot;map_manager&quot;</span>) +</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <span class="stringliteral">&quot;/state/robot_state.yaml&quot;</span>;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160; </div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    YAML::Emitter yaml_out;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    yaml_out &lt;&lt; YAML::BeginMap;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160; </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    YAML::Node state_node;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <span class="comment">// Time</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#a8a900d806e57e143205a86a2bb85765d">motion_state_mutex_</a>.lock();</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    YAML::Node time_node;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    time_node[<span class="stringliteral">&quot;sec&quot;</span>] = <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span>(<a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a16a596b50b6aaa332a0ff01a832015c9">stamp_</a>.seconds());</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    time_node[<span class="stringliteral">&quot;nsec&quot;</span>] = <span class="keyword">static_cast&lt;</span>uint32_t<span class="keyword">&gt;</span>(<a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a16a596b50b6aaa332a0ff01a832015c9">stamp_</a>.nanoseconds());</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    state_node[<span class="stringliteral">&quot;stamp&quot;</span>] = time_node;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="comment">// TF</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    YAML::Node tf_node;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    tf_node[<span class="stringliteral">&quot;map_current&quot;</span>] = <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a9977f778ffcae79ca443e1b5cc75bf89">map_current_frame_id_</a>;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    tf_node[<span class="stringliteral">&quot;x&quot;</span>] = <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a3fa894f8f09fb6d4e3cbf484bd2048d9">pose_2d_from_map_current_</a>.x;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    tf_node[<span class="stringliteral">&quot;y&quot;</span>] = <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a3fa894f8f09fb6d4e3cbf484bd2048d9">pose_2d_from_map_current_</a>.y;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    tf_node[<span class="stringliteral">&quot;theta&quot;</span>] = <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a3fa894f8f09fb6d4e3cbf484bd2048d9">pose_2d_from_map_current_</a>.theta * 180.0 / M_PI;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    state_node[<span class="stringliteral">&quot;tf&quot;</span>] = tf_node;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="comment">// State</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    state_node[<span class="stringliteral">&quot;floor&quot;</span>] = <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#ac2c56020cad267a628141fc69c73180a">floor_</a>;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    state_node[<span class="stringliteral">&quot;sector&quot;</span>] = <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#af59ff7bf9359a2adb81e19c7abadc5cb">sector_</a>;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">//    state_node[&quot;atm_floor&quot;] = mobile_motion_state_.atm_floor_;</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#a8a900d806e57e143205a86a2bb85765d">motion_state_mutex_</a>.unlock();</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160; </div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    yaml_out &lt;&lt; YAML::Key &lt;&lt; <span class="stringliteral">&quot;state&quot;</span> &lt;&lt; YAML::Value &lt;&lt; state_node &lt;&lt; YAML::EndMap;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160; </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    std::ofstream fout(state_file_path.c_str());</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    fout &lt;&lt; yaml_out.c_str();</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp; e) {</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    std::stringstream log_stream;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    log_stream &lt;&lt; <span class="stringliteral">&quot;Fail to save aimbot state config data. : &quot;</span> &lt;&lt; e.what();</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    RCLCPP_ERROR_STREAM(this-&gt;get_logger(), log_stream.str());</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  }</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;}</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; </div>
<div class="line"><a name="l01044"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a338dde81bc24116f3abc218f6d198230"> 1044</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmap__manager_1_1MapManager.html#a338dde81bc24116f3abc218f6d198230">MapManager::save_motion_state_to_log_file</a>()</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;{</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  <span class="keyword">auto</span> log_stream_ptr = std::make_shared&lt;std::ofstream&gt;();</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="comment">// Get the current time</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    rclcpp::Time ros_time = this-&gt;now();</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    time_t now = ros_time.seconds();</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="keyword">struct </span>tm tstruct;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    localtime_r(&amp;now, &amp;tstruct);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160; </div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <span class="keywordtype">char</span> time_buf[100];</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    strftime(time_buf, <span class="keyword">sizeof</span>(time_buf), <span class="stringliteral">&quot;%Y-%m-%d&quot;</span>, &amp;tstruct);  <span class="comment">// YYYY-MM-DD</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    std::string file_name = std::string(getenv(<span class="stringliteral">&quot;HOME&quot;</span>)) + <span class="stringliteral">&quot;/motion_log/&quot;</span> + time_buf + <span class="stringliteral">&quot;.csv&quot;</span>;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160; </div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="keywordtype">bool</span> file_exist_flag = (access(file_name.c_str(), F_OK) != -1);</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160; </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    log_stream_ptr-&gt;open(file_name, std::ofstream::out | std::ofstream::app);</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160; </div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="keywordflow">if</span> (file_exist_flag == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      *log_stream_ptr &lt;&lt; <span class="stringliteral">&quot;Data,Time,UNIX Time,x,y,theta,sector,floor\n&quot;</span>;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    }</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160; </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="keywordtype">char</span> log_time[50];</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    std::strftime(log_time, <span class="keyword">sizeof</span>(log_time), <span class="stringliteral">&quot;%Y-%m-%d,%H:%M:%S&quot;</span>, &amp;tstruct);</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="keywordtype">double</span> ms =</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      (ros_time.seconds() - <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(ros_time.seconds()))) * 1000.0;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160; </div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    *log_stream_ptr &lt;&lt; log_time &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      std::dec &lt;&lt; std::setw(3) &lt;&lt; std::setfill(&#39;0&#39;) &lt;&lt; static_cast&lt;int&gt;(ms) &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;      std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; ros_time.seconds() &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a3fa894f8f09fb6d4e3cbf484bd2048d9">pose_2d_from_map_current_</a>.x &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a3fa894f8f09fb6d4e3cbf484bd2048d9">pose_2d_from_map_current_</a>.y &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a3fa894f8f09fb6d4e3cbf484bd2048d9">pose_2d_from_map_current_</a>.theta * 180 / M_PI &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#af59ff7bf9359a2adb81e19c7abadc5cb">sector_</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#ac2c56020cad267a628141fc69c73180a">floor_</a>;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160; </div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    *log_stream_ptr &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160; </div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    log_stream_ptr-&gt;close();</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    log_stream_ptr.reset();</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  } <span class="keywordflow">catch</span> (std::exception &amp; ex) {</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    RCLCPP_ERROR_STREAM(get_logger(), <span class="stringliteral">&quot;[Aimbot Log] &quot;</span> &lt;&lt; ex.what());</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="keywordflow">if</span> (log_stream_ptr != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;      log_stream_ptr-&gt;close();</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;      log_stream_ptr.reset();</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    }</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  }</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;}</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160; </div>
<div class="line"><a name="l01093"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#ade021777fe56be06dbca4dcb89c7263d"> 1093</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmap__manager_1_1MapManager.html#ade021777fe56be06dbca4dcb89c7263d">MapManager::get_mobile_state_callback</a>(</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  <span class="keyword">const</span> std::shared_ptr&lt;rmw_request_id_t&gt; request_header,</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  <span class="keyword">const</span> std::shared_ptr&lt;aimbot_state_interfaces::srv::GetAimbotMotionState::Request&gt; request,</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  std::shared_ptr&lt;aimbot_state_interfaces::srv::GetAimbotMotionState::Response&gt; response)</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;{</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  (void)request_header;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;get aimbot motion state callback.&quot;</span>);</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  (void)request;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160; </div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <span class="comment">// get present pose</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a8a900d806e57e143205a86a2bb85765d">motion_state_mutex_</a>.lock();</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  <a class="code" href="structmap__manager_1_1AimbotMotionState.html">AimbotMotionState</a> motion_state = <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a8a900d806e57e143205a86a2bb85765d">motion_state_mutex_</a>.unlock();</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160; </div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;  response-&gt;header.stamp = motion_state.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a16a596b50b6aaa332a0ff01a832015c9">stamp_</a>;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  response-&gt;header.frame_id = motion_state.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a9977f778ffcae79ca443e1b5cc75bf89">map_current_frame_id_</a>;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  response-&gt;pose_from_map_current = motion_state.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a3fa894f8f09fb6d4e3cbf484bd2048d9">pose_2d_from_map_current_</a>;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  response-&gt;floor = motion_state.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#ac2c56020cad267a628141fc69c73180a">floor_</a>;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  response-&gt;sector = motion_state.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#af59ff7bf9359a2adb81e19c7abadc5cb">sector_</a>;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  response-&gt;result = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    this-&gt;get_logger(),</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="stringliteral">&quot;frame id : &quot;</span> &lt;&lt; response-&gt;header.frame_id &lt;&lt;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      <span class="stringliteral">&quot;, floor : &quot;</span> &lt;&lt; response-&gt;floor &lt;&lt;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      <span class="stringliteral">&quot;, sector : &quot;</span> &lt;&lt; response-&gt;sector);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;}</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160; </div>
<div class="line"><a name="l01120"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a4d06aeda99c4fccdeefdfeb1b852b916"> 1120</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmap__manager_1_1MapManager.html#a4d06aeda99c4fccdeefdfeb1b852b916">MapManager::rewrite_uuid</a>()</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;{</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> dest : <a class="code" href="classmap__manager_1_1MapManager.html#a47a7c408e0bbc50571eea14d42cd0cc3">dest_list_</a>) {</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <span class="comment">// poi size 8-4-4-4-12</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keywordflow">if</span> (dest.poi_id.size() != 36 ||</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      dest.poi_id.at(8) != <span class="charliteral">&#39;-&#39;</span> ||</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;      dest.poi_id.at(13) != <span class="charliteral">&#39;-&#39;</span> ||</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      dest.poi_id.at(18) != <span class="charliteral">&#39;-&#39;</span> ||</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      dest.poi_id.at(23) != <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    {</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;      RCLCPP_WARN_STREAM(</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        this-&gt;get_logger(),</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        <span class="stringliteral">&quot;UUID of &#39;&quot;</span> &lt;&lt; dest.name &lt;&lt; <span class="stringliteral">&quot;&#39; do not meet the standard, so it was changed.&quot;</span>);</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;      dest.poi_id = <a class="code" href="classmap__manager_1_1MapManager.html#a60fbddbc22abe230f8398f014f28ee51">generate_uuid</a>();</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    }</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  }</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;}</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160; </div>
<div class="line"><a name="l01138"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a60fbddbc22abe230f8398f014f28ee51"> 1138</a></span>&#160;std::string <a class="code" href="classmap__manager_1_1MapManager.html#a60fbddbc22abe230f8398f014f28ee51">MapManager::generate_uuid</a>()</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;{</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  <span class="keyword">static</span> std::random_device rd;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;  <span class="keyword">static</span> std::mt19937 gen(rd());</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  <span class="keyword">static</span> std::uniform_int_distribution&lt;int&gt; distrib(0, 15);</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160; </div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  std::stringstream ss;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  ss &lt;&lt; std::hex;</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 8; ++i) {</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    ss &lt;&lt; distrib(gen);</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  }</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  ss &lt;&lt; <span class="charliteral">&#39;-&#39;</span>;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; ++i) {</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    ss &lt;&lt; distrib(gen);</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  }</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  ss &lt;&lt; <span class="charliteral">&#39;-&#39;</span>;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; ++i) {</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    ss &lt;&lt; distrib(gen);</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  }</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  ss &lt;&lt; <span class="charliteral">&#39;-&#39;</span>;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; ++i) {</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    ss &lt;&lt; distrib(gen);</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  }</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  ss &lt;&lt; <span class="charliteral">&#39;-&#39;</span>;</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 12; ++i) {</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    ss &lt;&lt; distrib(gen);</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  }</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160; </div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  <span class="keywordflow">return</span> ss.str();</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;}</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160; </div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160; </div>
<div class="line"><a name="l01170"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a8d62e7cd6eaa77d97c3d12003f3800bc"> 1170</a></span>&#160;std::string <a class="code" href="classmap__manager_1_1MapManager.html#a8d62e7cd6eaa77d97c3d12003f3800bc">MapManager::generate_unique_key</a>()</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;{</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    std::string unique_key = <a class="code" href="classmap__manager_1_1MapManager.html#a60fbddbc22abe230f8398f014f28ee51">generate_uuid</a>();</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> dest : <a class="code" href="classmap__manager_1_1MapManager.html#a47a7c408e0bbc50571eea14d42cd0cc3">dest_list_</a>) {</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      <span class="keywordflow">if</span> (dest.poi_id == unique_key) {<span class="keywordflow">continue</span>;}</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    }</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keywordflow">return</span> unique_key;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  }</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;}</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160; </div>
<div class="line"><a name="l01182"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a802cc5d12e3708df05428d4769fbf21b"> 1182</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmap__manager_1_1MapManager.html#a802cc5d12e3708df05428d4769fbf21b">MapManager::add_button</a>(</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  YAML::Node button_node, std::string default_floor,</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  std::string default_location)</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;{</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  <span class="comment">// Buttons</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = button_node.begin(); it != button_node.end(); it++) {</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      <a class="code" href="structmap__manager_1_1ButtonPose.html">ButtonPose</a> btn_pose;</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;      btn_pose.<a class="code" href="structmap__manager_1_1ButtonPose.html#a2cb0dd3064d60cc10b42b55c8971e2ef">name</a> = it-&gt;second[<span class="stringliteral">&quot;name&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;      <span class="keywordflow">if</span> (it-&gt;second[<span class="stringliteral">&quot;floor&quot;</span>].IsDefined()) {</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        btn_pose.<a class="code" href="structmap__manager_1_1ButtonPose.html#a35cb5ad48d10403f31b28e49e17e2717">floor</a> = it-&gt;second[<span class="stringliteral">&quot;floor&quot;</span>].as&lt;std::vector&lt;std::string&gt;&gt;();</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (default_floor != <span class="stringliteral">&quot;NULL&quot;</span>) {</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;        btn_pose.<a class="code" href="structmap__manager_1_1ButtonPose.html#a35cb5ad48d10403f31b28e49e17e2717">floor</a>.push_back(default_floor);</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        RCLCPP_ERROR_STREAM(get_logger(), <span class="stringliteral">&quot;Fail to add button : Floor is not set.&quot;</span>);</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;      }</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      <span class="keywordflow">if</span> (it-&gt;second[<span class="stringliteral">&quot;location&quot;</span>].IsDefined()) {</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        btn_pose.<a class="code" href="structmap__manager_1_1ButtonPose.html#ae5bfc848cd78eb8055d9231259b74a67">location</a> = it-&gt;second[<span class="stringliteral">&quot;location&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        btn_pose.<a class="code" href="structmap__manager_1_1ButtonPose.html#ae5bfc848cd78eb8055d9231259b74a67">location</a> = default_location;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;      }</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      btn_pose.<a class="code" href="structmap__manager_1_1ButtonPose.html#ad9fd3625f5689f97bcec9c4da8716dad">pose</a>.position.x = it-&gt;second[<span class="stringliteral">&quot;x&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;      btn_pose.<a class="code" href="structmap__manager_1_1ButtonPose.html#ad9fd3625f5689f97bcec9c4da8716dad">pose</a>.position.y = it-&gt;second[<span class="stringliteral">&quot;y&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      btn_pose.<a class="code" href="structmap__manager_1_1ButtonPose.html#ad9fd3625f5689f97bcec9c4da8716dad">pose</a>.position.z = it-&gt;second[<span class="stringliteral">&quot;z&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;      btn_pose.<a class="code" href="structmap__manager_1_1ButtonPose.html#ad9fd3625f5689f97bcec9c4da8716dad">pose</a>.orientation.w = cos((it-&gt;second[<span class="stringliteral">&quot;yaw&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;() * M_PI / 180.) / 2);</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;      btn_pose.<a class="code" href="structmap__manager_1_1ButtonPose.html#ad9fd3625f5689f97bcec9c4da8716dad">pose</a>.orientation.x = 0.0;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;      btn_pose.<a class="code" href="structmap__manager_1_1ButtonPose.html#ad9fd3625f5689f97bcec9c4da8716dad">pose</a>.orientation.y = 0.0;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      btn_pose.<a class="code" href="structmap__manager_1_1ButtonPose.html#ad9fd3625f5689f97bcec9c4da8716dad">pose</a>.orientation.z = sin((it-&gt;second[<span class="stringliteral">&quot;yaw&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;() * M_PI / 180.) / 2);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        get_logger(), <span class="stringliteral">&quot;    Add &#39;&quot;</span> &lt;&lt; btn_pose.<a class="code" href="structmap__manager_1_1ButtonPose.html#a2cb0dd3064d60cc10b42b55c8971e2ef">name</a> &lt;&lt; <span class="stringliteral">&quot;&#39; Button : &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;          btn_pose.<a class="code" href="structmap__manager_1_1ButtonPose.html#ad9fd3625f5689f97bcec9c4da8716dad">pose</a>.position.x &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; btn_pose.<a class="code" href="structmap__manager_1_1ButtonPose.html#ad9fd3625f5689f97bcec9c4da8716dad">pose</a>.position.y &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;          btn_pose.<a class="code" href="structmap__manager_1_1ButtonPose.html#ad9fd3625f5689f97bcec9c4da8716dad">pose</a>.position.z &lt;&lt; <span class="stringliteral">&quot;/ &quot;</span> &lt;&lt; it-&gt;second[<span class="stringliteral">&quot;yaw&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;());</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        get_logger(), <span class="stringliteral">&quot;    loc &#39;&quot;</span> &lt;&lt; btn_pose.<a class="code" href="structmap__manager_1_1ButtonPose.html#ae5bfc848cd78eb8055d9231259b74a67">location</a> &lt;&lt;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;          <span class="stringliteral">&quot;&#39; Floor : &quot;</span> &lt;&lt; btn_pose.<a class="code" href="structmap__manager_1_1ButtonPose.html#a35cb5ad48d10403f31b28e49e17e2717">floor</a>.at(0) &lt;&lt; <span class="stringliteral">&quot; ~ &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;          btn_pose.<a class="code" href="structmap__manager_1_1ButtonPose.html#a35cb5ad48d10403f31b28e49e17e2717">floor</a>.at(btn_pose.<a class="code" href="structmap__manager_1_1ButtonPose.html#a35cb5ad48d10403f31b28e49e17e2717">floor</a>.size() - 1));</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#a256793fc2637429a1c121f59a1e72a7a">button_poses_</a>.push_back(btn_pose);</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    }</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;  } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp; e) {</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    RCLCPP_ERROR_STREAM(get_logger(), <span class="stringliteral">&quot;Fail to add Button pose data. : &quot;</span> &lt;&lt; e.what());</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;  }</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;}</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160; </div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160; </div>
<div class="line"><a name="l01229"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#adaf1cb5af4ee7c536b16d36fcb08486d"> 1229</a></span>&#160;geometry_msgs::msg::PoseStamped <a class="code" href="classmap__manager_1_1MapManager.html#adaf1cb5af4ee7c536b16d36fcb08486d">MapManager::transform_pose</a>(</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;  geometry_msgs::msg::PoseStamped origin_pose, std::string refer_frame_id)</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;{</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  geometry_msgs::msg::PoseStamped result;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    geometry_msgs::msg::TransformStamped base_transform;</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    base_transform = <a class="code" href="classmap__manager_1_1MapManager.html#a2119b6c240c04ed0f9fa991333982077">tf_buffer_</a>-&gt;lookupTransform(</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;      origin_pose.header.frame_id, refer_frame_id,</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;      rclcpp::Time(0), rclcpp::Duration::from_seconds(0.5));</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="comment">//        request-&gt;reference.stamp, rclcpp::Duration::from_seconds(0.5));</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;      this-&gt;get_logger(), <span class="stringliteral">&quot;TF is (&quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        base_transform.transform.translation.x &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        base_transform.transform.translation.y &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;        atan2(</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        base_transform.transform.rotation.z,</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        base_transform.transform.rotation.w) * 360.0 / M_PI &lt;&lt;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160; </div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    tf2::Transform base_tf;</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    base_tf.setOrigin(</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;      tf2::Vector3(</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        base_transform.transform.translation.x,</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        base_transform.transform.translation.y,</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        base_transform.transform.translation.z));</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    base_tf.setRotation(</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      tf2::Quaternion(</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        base_transform.transform.rotation.x,</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        base_transform.transform.rotation.y,</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        base_transform.transform.rotation.z,</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        base_transform.transform.rotation.w));</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160; </div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    tf2::Transform button_tf;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    button_tf.setOrigin(</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;      tf2::Vector3(</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        origin_pose.pose.position.x,</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        origin_pose.pose.position.y,</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        origin_pose.pose.position.z));</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    button_tf.setRotation(</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;      tf2::Quaternion(</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        origin_pose.pose.orientation.x,</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        origin_pose.pose.orientation.y,</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        origin_pose.pose.orientation.z,</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        origin_pose.pose.orientation.w));</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <span class="keyword">auto</span> button_pose = base_tf.inverse() * button_tf;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160; </div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="comment">// Stamp</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    result.header.stamp = base_transform.header.stamp;</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    result.header.frame_id = refer_frame_id;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    result.pose.position.x = button_pose.getOrigin().x();</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    result.pose.position.y = button_pose.getOrigin().y();</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    result.pose.position.z = button_pose.getOrigin().z();</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    result.pose.orientation.w = button_pose.getRotation().w();</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    result.pose.orientation.x = button_pose.getRotation().x();</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    result.pose.orientation.y = button_pose.getRotation().y();</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    result.pose.orientation.z = button_pose.getRotation().z();</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  } <span class="keywordflow">catch</span> (tf2::TransformException &amp; ex) {</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    RCLCPP_WARN_STREAM(</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;      this-&gt;get_logger(),</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;      <span class="stringliteral">&quot;Failed to get the TF, so the Pose relative to map_current is returned. : &quot;</span> &lt;&lt; ex.what());</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;  }</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;}</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160; </div>
<div class="line"><a name="l01293"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#acf6bafbe2a7fec6838e1f01f544c22e4"> 1293</a></span>&#160;geometry_msgs::msg::PoseStamped <a class="code" href="classmap__manager_1_1MapManager.html#acf6bafbe2a7fec6838e1f01f544c22e4">MapManager::pose2d_to_3d</a>(</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  std::string frame_id,</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;  geometry_msgs::msg::Pose2D pose_2d)</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;{</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;  geometry_msgs::msg::PoseStamped result;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  result.header.stamp = this-&gt;now();</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  result.header.frame_id = frame_id;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  result.pose.position.x = pose_2d.x;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;  result.pose.position.y = pose_2d.y;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  result.pose.position.z = 0.0;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  result.pose.orientation.w = cos(pose_2d.theta / 2);</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  result.pose.orientation.x = 0.0;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  result.pose.orientation.y = 0.0;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  result.pose.orientation.z = sin(pose_2d.theta / 2);</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;}</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160; </div>
<div class="line"><a name="l01310"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#acf0adb7076b38fa8c1437263762eeb17"> 1310</a></span>&#160;geometry_msgs::msg::Pose2D <a class="code" href="classmap__manager_1_1MapManager.html#acf0adb7076b38fa8c1437263762eeb17">MapManager::pose3d_to_2d</a>(geometry_msgs::msg::PoseStamped pose_3d)</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;{</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  geometry_msgs::msg::Pose2D result;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;  result.x = pose_3d.pose.position.x;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  result.y = pose_3d.pose.position.y;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  tf2::Quaternion tf_q;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;  tf2::convert(pose_3d.pose.orientation, tf_q);</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  tf2::Matrix3x3 rotation_mat(tf_q);</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  <span class="keywordtype">double</span> r, p, y;</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  rotation_mat.getRPY(r, p, y);</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;  result.theta = y;</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;}</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160; </div>
<div class="line"><a name="l01324"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#aefbcca7f7e0d17e03f14f3726b2ffda0"> 1324</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmap__manager_1_1MapManager.html#aefbcca7f7e0d17e03f14f3726b2ffda0">MapManager::load_station</a>()</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;{</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  std::string station_file_path =</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    ament_index_cpp::get_package_share_directory(<span class="stringliteral">&quot;aimbot_params&quot;</span>) +</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <span class="stringliteral">&quot;/site/&quot;</span> +</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#abafd8e1c11994af6f66c5c85e480fcbc">map_site_name_</a> +</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    <span class="stringliteral">&quot;/map/stations.yaml&quot;</span>;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;  RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    this-&gt;get_logger(), <span class="stringliteral">&quot;Load &#39;Docking Station&#39; to &#39;&quot;</span> &lt;&lt; station_file_path &lt;&lt; <span class="stringliteral">&quot;&#39;.&quot;</span>);</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160; </div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;  YAML::Node station_node;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;  <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    station_node = YAML::LoadFile(station_file_path.c_str());</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160; </div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    <span class="keywordflow">for</span> (YAML::iterator it = station_node.begin();</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;      it != station_node.end(); ++it)</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    {</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;      <span class="keywordflow">if</span> (it-&gt;second[<span class="stringliteral">&quot;num&quot;</span>].as&lt;std::string&gt;() == <a class="code" href="classmap__manager_1_1MapManager.html#a43441561715c63a9a7dc36ab8e77c54f">robot_num_</a>) {</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;        <span class="comment">// Load station Pose</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;        RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;&#39;Docking Station&#39;&quot;</span>);</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;        RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;          this-&gt;get_logger(), <span class="stringliteral">&quot;  name : &quot;</span> &lt;&lt; it-&gt;second[<span class="stringliteral">&quot;name&quot;</span>].as&lt;std::string&gt;());</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;        RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;          this-&gt;get_logger(), <span class="stringliteral">&quot;  number : &quot;</span> &lt;&lt; it-&gt;second[<span class="stringliteral">&quot;num&quot;</span>].as&lt;std::string&gt;());</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        <a class="code" href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">docking_station_</a>.<a class="code" href="structmap__manager_1_1DockingStation.html#aeadd7ce73766c12617fc524aea140829">floor_</a> = it-&gt;second[<span class="stringliteral">&quot;floor&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;        RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;  floor : &quot;</span> &lt;&lt; <a class="code" href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">docking_station_</a>.<a class="code" href="structmap__manager_1_1DockingStation.html#aeadd7ce73766c12617fc524aea140829">floor_</a>);</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        <a class="code" href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">docking_station_</a>.<a class="code" href="structmap__manager_1_1DockingStation.html#a9759346d27d09ecc2cd6f4dea89f42ca">sector_</a> = it-&gt;second[<span class="stringliteral">&quot;sector&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;        RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;  sector : &quot;</span> &lt;&lt; <a class="code" href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">docking_station_</a>.<a class="code" href="structmap__manager_1_1DockingStation.html#a9759346d27d09ecc2cd6f4dea89f42ca">sector_</a>);</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;        <a class="code" href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">docking_station_</a>.<a class="code" href="structmap__manager_1_1DockingStation.html#ada28d947caadaa213278c2b670fda9e0">pose</a>.x = it-&gt;second[<span class="stringliteral">&quot;pose&quot;</span>][<span class="stringliteral">&quot;x&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;        <a class="code" href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">docking_station_</a>.<a class="code" href="structmap__manager_1_1DockingStation.html#ada28d947caadaa213278c2b670fda9e0">pose</a>.y = it-&gt;second[<span class="stringliteral">&quot;pose&quot;</span>][<span class="stringliteral">&quot;y&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;        <a class="code" href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">docking_station_</a>.<a class="code" href="structmap__manager_1_1DockingStation.html#ada28d947caadaa213278c2b670fda9e0">pose</a>.theta = it-&gt;second[<span class="stringliteral">&quot;pose&quot;</span>][<span class="stringliteral">&quot;theta&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;() * M_PI / 180;</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;        RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;          get_logger(), <span class="stringliteral">&quot;  pose : &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;            <a class="code" href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">docking_station_</a>.<a class="code" href="structmap__manager_1_1DockingStation.html#ada28d947caadaa213278c2b670fda9e0">pose</a>.x &lt;&lt; <span class="stringliteral">&quot;m, &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;            <a class="code" href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">docking_station_</a>.<a class="code" href="structmap__manager_1_1DockingStation.html#ada28d947caadaa213278c2b670fda9e0">pose</a>.y &lt;&lt; <span class="stringliteral">&quot;m, &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;            <a class="code" href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">docking_station_</a>.<a class="code" href="structmap__manager_1_1DockingStation.html#ada28d947caadaa213278c2b670fda9e0">pose</a>.theta * 180.0 / M_PI &lt;&lt; <span class="stringliteral">&quot;deg.&quot;</span>);</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;        aimbot_state_interfaces::msg::Destination docking_station;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        docking_station.key = <span class="stringliteral">&quot;docking_station&quot;</span>;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        docking_station.name = <span class="stringliteral">&quot;도킹스테이션&quot;</span>;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;        docking_station.floor = <a class="code" href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">docking_station_</a>.<a class="code" href="structmap__manager_1_1DockingStation.html#aeadd7ce73766c12617fc524aea140829">floor_</a>;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        docking_station.sector = <a class="code" href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">docking_station_</a>.<a class="code" href="structmap__manager_1_1DockingStation.html#a9759346d27d09ecc2cd6f4dea89f42ca">sector_</a>;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        docking_station.pose = <a class="code" href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">docking_station_</a>.<a class="code" href="structmap__manager_1_1DockingStation.html#ada28d947caadaa213278c2b670fda9e0">pose</a>;</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;        docking_station.type = aimbot_state_interfaces::msg::Destination::TYPE_HOME;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;        docking_station.action = aimbot_state_interfaces::msg::Destination::ACTION_NONE;</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;        <a class="code" href="classmap__manager_1_1MapManager.html#a47a7c408e0bbc50571eea14d42cd0cc3">dest_list_</a>.push_back(docking_station);</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160; </div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;        <span class="comment">// Add service_base</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;        <span class="keywordtype">double</span> docking_distance_m = it-&gt;second[<span class="stringliteral">&quot;docking_distance_m&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;        aimbot_state_interfaces::msg::Destination service_base;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;        service_base.key = <span class="stringliteral">&quot;service_base&quot;</span>;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;        RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;&#39;Service Base&#39;&quot;</span>);</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;        service_base.name = <span class="stringliteral">&quot;대기장소&quot;</span>;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;        RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;  name : &quot;</span> &lt;&lt; service_base.name);</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;        service_base.floor = <a class="code" href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">docking_station_</a>.<a class="code" href="structmap__manager_1_1DockingStation.html#aeadd7ce73766c12617fc524aea140829">floor_</a>;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;  floor : &quot;</span> &lt;&lt; <a class="code" href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">docking_station_</a>.<a class="code" href="structmap__manager_1_1DockingStation.html#aeadd7ce73766c12617fc524aea140829">floor_</a>);</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;        service_base.sector = <a class="code" href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">docking_station_</a>.<a class="code" href="structmap__manager_1_1DockingStation.html#a9759346d27d09ecc2cd6f4dea89f42ca">sector_</a>;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;        RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;  sector : &quot;</span> &lt;&lt; <a class="code" href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">docking_station_</a>.<a class="code" href="structmap__manager_1_1DockingStation.html#a9759346d27d09ecc2cd6f4dea89f42ca">sector_</a>);</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;        service_base.pose.x = <a class="code" href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">docking_station_</a>.<a class="code" href="structmap__manager_1_1DockingStation.html#ada28d947caadaa213278c2b670fda9e0">pose</a>.x -</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;          fabs(docking_distance_m) * cos(<a class="code" href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">docking_station_</a>.<a class="code" href="structmap__manager_1_1DockingStation.html#ada28d947caadaa213278c2b670fda9e0">pose</a>.theta);</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;        service_base.pose.y = <a class="code" href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">docking_station_</a>.<a class="code" href="structmap__manager_1_1DockingStation.html#ada28d947caadaa213278c2b670fda9e0">pose</a>.y -</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;          fabs(docking_distance_m) * sin(<a class="code" href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">docking_station_</a>.<a class="code" href="structmap__manager_1_1DockingStation.html#ada28d947caadaa213278c2b670fda9e0">pose</a>.theta);</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;        service_base.pose.theta = <a class="code" href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">docking_station_</a>.<a class="code" href="structmap__manager_1_1DockingStation.html#ada28d947caadaa213278c2b670fda9e0">pose</a>.theta;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;        RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;          get_logger(), <span class="stringliteral">&quot;  pose : &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;            service_base.pose.x &lt;&lt; <span class="stringliteral">&quot;m, &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;            service_base.pose.y &lt;&lt; <span class="stringliteral">&quot;m, &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;            service_base.pose.theta * 180.0 / M_PI &lt;&lt; <span class="stringliteral">&quot;deg.&quot;</span>);</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;        service_base.type = aimbot_state_interfaces::msg::Destination::TYPE_BASE;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;        service_base.action = aimbot_state_interfaces::msg::Destination::ACTION_DOCKING;</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;        service_base.poi_id = <a class="code" href="classmap__manager_1_1MapManager.html#a8d62e7cd6eaa77d97c3d12003f3800bc">generate_unique_key</a>();</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;        <a class="code" href="classmap__manager_1_1MapManager.html#a47a7c408e0bbc50571eea14d42cd0cc3">dest_list_</a>.push_back(service_base);</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;      }</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    }</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;  } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp; e) {</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    RCLCPP_ERROR_STREAM(get_logger(), <span class="stringliteral">&quot;Fail to load Station pose data. : &quot;</span> &lt;&lt; e.what());</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;  }</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;}</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160; </div>
<div class="line"><a name="l01404"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a62adc5b3a5e1f3fa3b1ac0e76560ead6"> 1404</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmap__manager_1_1MapManager.html#a62adc5b3a5e1f3fa3b1ac0e76560ead6">MapManager::load_destinations</a>()</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;{</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;  std::string dest_dir_path =</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    ament_index_cpp::get_package_share_directory(<span class="stringliteral">&quot;aimbot_params&quot;</span>) +</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <span class="stringliteral">&quot;/site/&quot;</span> + <a class="code" href="classmap__manager_1_1MapManager.html#abafd8e1c11994af6f66c5c85e480fcbc">map_site_name_</a> + <span class="stringliteral">&quot;/map/destinations&quot;</span>;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160; </div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;  <span class="comment">// Get File List in the Directory</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;  std::vector&lt;std::string&gt; file_list;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160; </div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;  DIR * dir_ptr = opendir(dest_dir_path.c_str());</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;  <span class="keyword">struct </span>dirent * dirnet_ptr;</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;  <span class="keywordflow">while</span> ((dirnet_ptr = readdir(dir_ptr)) != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    std::string file_name = dirnet_ptr-&gt;d_name;</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <span class="keywordflow">if</span> (file_name.find(<span class="stringliteral">&quot;.yaml&quot;</span>) != std::string::npos) {</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      file_list.push_back(file_name);</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    }</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;  }</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;  closedir(dir_ptr);</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160; </div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;  <span class="comment">// File list</span></div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> file_name : file_list) {</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    std::string dest_file_path = dest_dir_path + <span class="stringliteral">&quot;/&quot;</span> + file_name;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;      this-&gt;get_logger(), <span class="stringliteral">&quot;&#39;Destination&#39; to &#39;&quot;</span> &lt;&lt; dest_file_path &lt;&lt; <span class="stringliteral">&quot;&#39;.&quot;</span>);</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160; </div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    YAML::Node dest_node;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;      dest_node = YAML::LoadFile(dest_file_path.c_str());</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160; </div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;      <span class="keywordflow">for</span> (YAML::iterator it = dest_node.begin(); it != dest_node.end(); ++it) {</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        <span class="keyword">auto</span> key = it-&gt;second[<span class="stringliteral">&quot;key&quot;</span>];</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        <span class="keyword">auto</span> name = it-&gt;second[<span class="stringliteral">&quot;name&quot;</span>];</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        <span class="keyword">auto</span> floor = it-&gt;second[<span class="stringliteral">&quot;floor&quot;</span>];</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        <span class="keyword">auto</span> num = it-&gt;second[<span class="stringliteral">&quot;room_num&quot;</span>];</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;        <span class="keyword">auto</span> pose = it-&gt;second[<span class="stringliteral">&quot;pose&quot;</span>];</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        <span class="keyword">auto</span> door = it-&gt;second[<span class="stringliteral">&quot;door&quot;</span>];</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;        <span class="keyword">auto</span> pfd = it-&gt;second[<span class="stringliteral">&quot;pose_from_door&quot;</span>];</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160; </div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;        <span class="comment">// Normal type</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        <span class="keywordflow">if</span> (key.IsDefined() &amp;&amp; name.IsDefined() &amp;&amp; floor.IsScalar() &amp;&amp; !num.IsDefined()) {</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;          aimbot_state_interfaces::msg::Destination dest;</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;          dest.poi_id = it-&gt;first.as&lt;std::string&gt;();</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;          RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;            this-&gt;get_logger(),</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;            <span class="stringliteral">&quot;  Normal Type : &quot;</span> &lt;&lt; it-&gt;first.as&lt;std::string&gt;());</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;          dest.key = key.as&lt;std::string&gt;();</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;          RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;    key : &quot;</span> &lt;&lt; dest.key);</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;          dest.name = name.as&lt;std::string&gt;();</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;          RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;    name : &quot;</span> &lt;&lt; dest.name);</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;          dest.floor = floor.as&lt;std::string&gt;();</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;          RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;    floor : &quot;</span> &lt;&lt; dest.floor);</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;          dest.sector = it-&gt;second[<span class="stringliteral">&quot;sector&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;          RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;    sector : &quot;</span> &lt;&lt; dest.sector);</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;          dest.type = it-&gt;second[<span class="stringliteral">&quot;type&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;          RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;    type : &quot;</span> &lt;&lt; dest.type);</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;          dest.action = it-&gt;second[<span class="stringliteral">&quot;action&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;          RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;    action : &quot;</span> &lt;&lt; dest.action);</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160; </div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;          <span class="comment">// Pose setup</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;          <span class="comment">// Pose만 주어짐</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;          <span class="keywordflow">if</span> (pose.IsDefined() &amp;&amp; !door.IsDefined() &amp;&amp; !pfd.IsDefined()) {</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;            dest.pose.x = it-&gt;second[<span class="stringliteral">&quot;pose&quot;</span>][<span class="stringliteral">&quot;x&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;            dest.pose.y = it-&gt;second[<span class="stringliteral">&quot;pose&quot;</span>][<span class="stringliteral">&quot;y&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;            dest.pose.theta = it-&gt;second[<span class="stringliteral">&quot;pose&quot;</span>][<span class="stringliteral">&quot;theta&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;() * M_PI / 180;</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;            RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;              get_logger(), <span class="stringliteral">&quot;    pose : &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                dest.pose.x &lt;&lt; <span class="stringliteral">&quot;m, &quot;</span> &lt;&lt; dest.pose.y &lt;&lt; <span class="stringliteral">&quot;m, &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;                dest.pose.theta * 180.0 / M_PI &lt;&lt; <span class="stringliteral">&quot;deg.&quot;</span>);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;            <a class="code" href="classmap__manager_1_1MapManager.html#a47a7c408e0bbc50571eea14d42cd0cc3">dest_list_</a>.push_back(dest);</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;            <span class="comment">// Door와 Pose</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pose.IsDefined() &amp;&amp; door.IsDefined() &amp;&amp; !pfd.IsDefined()) {</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;            <span class="comment">// door</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;            <a class="code" href="structmap__manager_1_1DoorPose.html">DoorPose</a> door_pose;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;            door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#af6920aa35cefa680e3041ed11606c251">name</a> = dest.key;</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;            door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#afa3b255e833eebb9febd623f0cd25a70">floor</a>.push_back(dest.floor);</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;            door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.x = door[<span class="stringliteral">&quot;x&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;            door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.y = door[<span class="stringliteral">&quot;y&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;            door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.theta = door[<span class="stringliteral">&quot;theta&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;() * M_PI / 180;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;            RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;              get_logger(), <span class="stringliteral">&quot;    Door Difined &#39;&quot;</span> &lt;&lt; door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#af6920aa35cefa680e3041ed11606c251">name</a> &lt;&lt; <span class="stringliteral">&quot;&#39; : &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.x &lt;&lt; <span class="stringliteral">&quot;m, &quot;</span> &lt;&lt; door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.y &lt;&lt; <span class="stringliteral">&quot;m, &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;                door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.theta * 180.0 / M_PI &lt;&lt; <span class="stringliteral">&quot;deg.&quot;</span>);</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;            <a class="code" href="classmap__manager_1_1MapManager.html#aa27bff05661f2dddd4a75a3b98820c0a">door_list_</a>.push_back(door_pose);</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160; </div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;            <span class="comment">// Destination pose</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;            dest.pose.x = it-&gt;second[<span class="stringliteral">&quot;pose&quot;</span>][<span class="stringliteral">&quot;x&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;            dest.pose.y = it-&gt;second[<span class="stringliteral">&quot;pose&quot;</span>][<span class="stringliteral">&quot;y&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;            dest.pose.theta = it-&gt;second[<span class="stringliteral">&quot;pose&quot;</span>][<span class="stringliteral">&quot;theta&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;() * M_PI / 180;</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;            RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;              get_logger(), <span class="stringliteral">&quot;    pose : &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;                dest.pose.x &lt;&lt; <span class="stringliteral">&quot;m, &quot;</span> &lt;&lt; dest.pose.y &lt;&lt; <span class="stringliteral">&quot;m, &quot;</span> &lt;&lt; dest.pose.theta * 180.0 / M_PI &lt;&lt;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                <span class="stringliteral">&quot;deg.&quot;</span>);</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;            <a class="code" href="classmap__manager_1_1MapManager.html#a47a7c408e0bbc50571eea14d42cd0cc3">dest_list_</a>.push_back(dest);</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;            <span class="comment">// Door와 Door_from_pose</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!pose.IsDefined() &amp;&amp; door.IsDefined() &amp;&amp; pfd.IsDefined()) {</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;            <span class="comment">// door</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;            <a class="code" href="structmap__manager_1_1DoorPose.html">DoorPose</a> door_pose;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;            door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#af6920aa35cefa680e3041ed11606c251">name</a> = dest.key;</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;            door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#afa3b255e833eebb9febd623f0cd25a70">floor</a>.push_back(dest.floor);</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;            door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.x = door[<span class="stringliteral">&quot;x&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;            door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.y = door[<span class="stringliteral">&quot;y&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;            door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.theta = door[<span class="stringliteral">&quot;theta&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;() * M_PI / 180;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;            RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;              get_logger(), <span class="stringliteral">&quot;    Door Difined &#39;&quot;</span> &lt;&lt; door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#af6920aa35cefa680e3041ed11606c251">name</a> &lt;&lt; <span class="stringliteral">&quot;&#39; : &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.x &lt;&lt; <span class="stringliteral">&quot;m, &quot;</span> &lt;&lt; door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.y &lt;&lt; <span class="stringliteral">&quot;m, &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.theta * 180.0 / M_PI &lt;&lt; <span class="stringliteral">&quot;deg.&quot;</span>);</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;            <a class="code" href="classmap__manager_1_1MapManager.html#aa27bff05661f2dddd4a75a3b98820c0a">door_list_</a>.push_back(door_pose);</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160; </div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;            <span class="comment">// Destination pose</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;            geometry_msgs::msg::Pose2D pose_from_door;</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;            pose_from_door.x = pfd[<span class="stringliteral">&quot;x&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;            pose_from_door.y = pfd[<span class="stringliteral">&quot;y&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;            pose_from_door.theta = pfd[<span class="stringliteral">&quot;theta&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;() * M_PI / 180;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160; </div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;            dest.pose.x = door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.x +</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;              pose_from_door.x * cos(door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.theta) +</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;              pose_from_door.y * sin(door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.theta);</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;            dest.pose.y = door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.y -</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;              pose_from_door.x * sin(door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.theta) +</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;              pose_from_door.y * cos(door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.theta);</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;            dest.pose.theta = door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.theta + pose_from_door.theta;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;            RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;              get_logger(), <span class="stringliteral">&quot;    pose : &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                dest.pose.x &lt;&lt; <span class="stringliteral">&quot;m, &quot;</span> &lt;&lt; dest.pose.y &lt;&lt; <span class="stringliteral">&quot;m, &quot;</span> &lt;&lt; dest.pose.theta * 180.0 / M_PI &lt;&lt;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                <span class="stringliteral">&quot;deg.&quot;</span>);</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160; </div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;            <a class="code" href="classmap__manager_1_1MapManager.html#a47a7c408e0bbc50571eea14d42cd0cc3">dest_list_</a>.push_back(dest);</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;            RCLCPP_ERROR_STREAM(</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;              this-&gt;get_logger(),</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;              <span class="stringliteral">&quot;Pose Define ERROR : &quot;</span> &lt;&lt; it-&gt;first.as&lt;std::string&gt;());</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;          }</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160; </div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;          <span class="comment">// Buttons</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;          <span class="keywordflow">if</span> (it-&gt;second[<span class="stringliteral">&quot;buttons&quot;</span>].IsDefined()) {</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classmap__manager_1_1MapManager.html#a802cc5d12e3708df05428d4769fbf21b">add_button</a>(it-&gt;second[<span class="stringliteral">&quot;buttons&quot;</span>], dest.floor, dest.key)) {</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;              <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;            }</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;          }</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (num.IsDefined() &amp;&amp; floor.IsSequence() &amp;&amp; !key.IsDefined() &amp;&amp; !name.IsDefined()) {</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;          <span class="comment">// Room type</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;          <span class="keyword">auto</span> floors = floor.as&lt;std::vector&lt;std::string&gt;&gt;();</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> floor : floors) {</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;            aimbot_state_interfaces::msg::Destination dest;</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;            dest.poi_id = it-&gt;first.as&lt;std::string&gt;();</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;            RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;              this-&gt;get_logger(),</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;              <span class="stringliteral">&quot;  Room Type : &quot;</span> &lt;&lt; it-&gt;first.as&lt;std::string&gt;() &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; floor &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160; </div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;            std::string room_num = num.as&lt;std::string&gt;();</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;            <span class="keywordflow">if</span> (room_num.size() == 1) {</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;              dest.key = floor + <span class="stringliteral">&quot;0&quot;</span> + room_num;</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;              RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;    key : &quot;</span> &lt;&lt; dest.key);</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;              dest.name = dest.key + <span class="stringliteral">&quot;호&quot;</span>;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;              RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;    name : &quot;</span> &lt;&lt; dest.name);</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (room_num.size() == 2) {</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;              dest.key = floor + room_num;</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;              RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;    key : &quot;</span> &lt;&lt; dest.key);</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;              dest.name = dest.key + <span class="stringliteral">&quot;호&quot;</span>;</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;              RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;    name : &quot;</span> &lt;&lt; dest.name);</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;              RCLCPP_ERROR_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Room Number ERROR : &quot;</span> &lt;&lt; room_num);</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;              <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;            }</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;            dest.floor = floor;</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;            RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;    floor : &quot;</span> &lt;&lt; dest.floor);</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;            dest.sector = it-&gt;second[<span class="stringliteral">&quot;sector&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;            RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;    sector : &quot;</span> &lt;&lt; dest.sector);</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;            dest.type = it-&gt;second[<span class="stringliteral">&quot;type&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;            RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;    type : &quot;</span> &lt;&lt; dest.type);</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;            dest.action = it-&gt;second[<span class="stringliteral">&quot;action&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;            RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;    action : &quot;</span> &lt;&lt; dest.action);</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160; </div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;            <span class="comment">// Pose setup</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;            <span class="comment">// Pose만 주어짐</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;            <span class="keywordflow">if</span> (pose.IsDefined() &amp;&amp; !door.IsDefined() &amp;&amp; !pfd.IsDefined()) {</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;              dest.pose.x = it-&gt;second[<span class="stringliteral">&quot;pose&quot;</span>][<span class="stringliteral">&quot;x&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;              dest.pose.y = it-&gt;second[<span class="stringliteral">&quot;pose&quot;</span>][<span class="stringliteral">&quot;y&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;              dest.pose.theta = it-&gt;second[<span class="stringliteral">&quot;pose&quot;</span>][<span class="stringliteral">&quot;theta&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;() * M_PI / 180;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;              RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;                get_logger(), <span class="stringliteral">&quot;    pose : &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;                  dest.pose.x &lt;&lt; <span class="stringliteral">&quot;m, &quot;</span> &lt;&lt; dest.pose.y &lt;&lt; <span class="stringliteral">&quot;m, &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;                  dest.pose.theta * 180.0 / M_PI &lt;&lt; <span class="stringliteral">&quot;deg.&quot;</span>);</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;              <a class="code" href="classmap__manager_1_1MapManager.html#a47a7c408e0bbc50571eea14d42cd0cc3">dest_list_</a>.push_back(dest);</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;              <span class="comment">// Door와 Pose</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pose.IsDefined() &amp;&amp; door.IsDefined() &amp;&amp; !pfd.IsDefined()) {</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;              <span class="comment">// door</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;              <a class="code" href="structmap__manager_1_1DoorPose.html">DoorPose</a> door_pose;</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;              door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#af6920aa35cefa680e3041ed11606c251">name</a> = dest.key;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;              door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#afa3b255e833eebb9febd623f0cd25a70">floor</a>.push_back(dest.floor);</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;              door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.x = door[<span class="stringliteral">&quot;x&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;              door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.y = door[<span class="stringliteral">&quot;y&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;              door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.theta = door[<span class="stringliteral">&quot;theta&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;() * M_PI / 180;</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;              RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;                get_logger(), <span class="stringliteral">&quot;    Door Difined &#39;&quot;</span> &lt;&lt; door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#af6920aa35cefa680e3041ed11606c251">name</a> &lt;&lt; <span class="stringliteral">&quot;&#39; : &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;                  door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.x &lt;&lt; <span class="stringliteral">&quot;m, &quot;</span> &lt;&lt; door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.y &lt;&lt; <span class="stringliteral">&quot;m, &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;                  door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.theta * 180.0 / M_PI &lt;&lt; <span class="stringliteral">&quot;deg.&quot;</span>);</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;              <a class="code" href="classmap__manager_1_1MapManager.html#aa27bff05661f2dddd4a75a3b98820c0a">door_list_</a>.push_back(door_pose);</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160; </div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;              <span class="comment">// Destination pose</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;              dest.pose.x = it-&gt;second[<span class="stringliteral">&quot;pose&quot;</span>][<span class="stringliteral">&quot;x&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;              dest.pose.y = it-&gt;second[<span class="stringliteral">&quot;pose&quot;</span>][<span class="stringliteral">&quot;y&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;              dest.pose.theta = it-&gt;second[<span class="stringliteral">&quot;pose&quot;</span>][<span class="stringliteral">&quot;theta&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;() * M_PI / 180;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;              RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;                get_logger(), <span class="stringliteral">&quot;    pose : &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                  dest.pose.x &lt;&lt; <span class="stringliteral">&quot;m, &quot;</span> &lt;&lt; dest.pose.y &lt;&lt; <span class="stringliteral">&quot;m, &quot;</span> &lt;&lt; dest.pose.theta * 180.0 / M_PI &lt;&lt;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                  <span class="stringliteral">&quot;deg.&quot;</span>);</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;              <a class="code" href="classmap__manager_1_1MapManager.html#a47a7c408e0bbc50571eea14d42cd0cc3">dest_list_</a>.push_back(dest);</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;              <span class="comment">// Door와 Door_from_pose</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!pose.IsDefined() &amp;&amp; door.IsDefined() &amp;&amp; pfd.IsDefined()) {</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;              <span class="comment">// door</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;              <a class="code" href="structmap__manager_1_1DoorPose.html">DoorPose</a> door_pose;</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;              door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#af6920aa35cefa680e3041ed11606c251">name</a> = dest.key;</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;              door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#afa3b255e833eebb9febd623f0cd25a70">floor</a>.push_back(dest.floor);</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;              door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.x = door[<span class="stringliteral">&quot;x&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;              door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.y = door[<span class="stringliteral">&quot;y&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;              door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.theta = door[<span class="stringliteral">&quot;theta&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;() * M_PI / 180;</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;              RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                get_logger(), <span class="stringliteral">&quot;    Door Difined &#39;&quot;</span> &lt;&lt; door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#af6920aa35cefa680e3041ed11606c251">name</a> &lt;&lt; <span class="stringliteral">&quot;&#39; : &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                  door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.x &lt;&lt; <span class="stringliteral">&quot;m, &quot;</span> &lt;&lt; door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.y &lt;&lt; <span class="stringliteral">&quot;m, &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                  door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.theta * 180.0 / M_PI &lt;&lt; <span class="stringliteral">&quot;deg.&quot;</span>);</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;              <a class="code" href="classmap__manager_1_1MapManager.html#aa27bff05661f2dddd4a75a3b98820c0a">door_list_</a>.push_back(door_pose);</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160; </div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;              <span class="comment">// Destination pose</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;              geometry_msgs::msg::Pose2D pose_from_door;</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;              pose_from_door.x = pfd[<span class="stringliteral">&quot;x&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;              pose_from_door.y = pfd[<span class="stringliteral">&quot;y&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;              pose_from_door.theta = pfd[<span class="stringliteral">&quot;theta&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;() * M_PI /</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                180;</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160; </div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;              dest.pose.x = door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.x +</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                pose_from_door.x * cos(door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.theta) +</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                pose_from_door.y * sin(door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.theta);</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;              dest.pose.y = door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.y -</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                pose_from_door.x * sin(door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.theta) +</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                pose_from_door.y * cos(door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.theta);</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;              dest.pose.theta = door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.theta + pose_from_door.theta;</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;              RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                get_logger(), <span class="stringliteral">&quot;    pose : &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                  dest.pose.x &lt;&lt; <span class="stringliteral">&quot;m, &quot;</span> &lt;&lt; dest.pose.y &lt;&lt; <span class="stringliteral">&quot;m, &quot;</span> &lt;&lt; dest.pose.theta * 180.0 / M_PI &lt;&lt;</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                  <span class="stringliteral">&quot;deg.&quot;</span>);</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160; </div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;              <a class="code" href="classmap__manager_1_1MapManager.html#a47a7c408e0bbc50571eea14d42cd0cc3">dest_list_</a>.push_back(dest);</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;              RCLCPP_ERROR_STREAM(</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                this-&gt;get_logger(),</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                <span class="stringliteral">&quot;Pose Define ERROR : &quot;</span> &lt;&lt; it-&gt;first.as&lt;std::string&gt;());</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;              <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;            }</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160; </div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;            <span class="comment">// Buttons</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;            <span class="keywordflow">if</span> (it-&gt;second[<span class="stringliteral">&quot;buttons&quot;</span>].IsDefined()) {</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="classmap__manager_1_1MapManager.html#a802cc5d12e3708df05428d4769fbf21b">add_button</a>(it-&gt;second[<span class="stringliteral">&quot;buttons&quot;</span>], dest.floor, dest.key)) {</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;              }</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;            }</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;          }</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;        } <span class="keywordflow">else</span> {            <span class="comment">// type error</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;          RCLCPP_ERROR_STREAM(</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;            this-&gt;get_logger(),</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;            <span class="stringliteral">&quot;Destination Type ERROR : &quot;</span> &lt;&lt; it-&gt;first.as&lt;std::string&gt;());</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        }</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;      }</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp; e) {</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;      RCLCPP_ERROR_STREAM(get_logger(), <span class="stringliteral">&quot;Fail to load destination data. : &quot;</span> &lt;&lt; e.what());</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    }</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;  }</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;}</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160; </div>
<div class="line"><a name="l01677"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a0ec87ecdcd648fd4959c5105afb9ec22"> 1677</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmap__manager_1_1MapManager.html#a0ec87ecdcd648fd4959c5105afb9ec22">MapManager::load_elevator</a>()</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;{</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;  std::string ev_dir_path =</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    ament_index_cpp::get_package_share_directory(<span class="stringliteral">&quot;aimbot_params&quot;</span>) +</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    <span class="stringliteral">&quot;/site/&quot;</span> + <a class="code" href="classmap__manager_1_1MapManager.html#abafd8e1c11994af6f66c5c85e480fcbc">map_site_name_</a> + <span class="stringliteral">&quot;/map/ev&quot;</span>;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160; </div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;  <span class="comment">// Get File List in the Directory</span></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;  std::vector&lt;std::string&gt; file_list;</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160; </div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;  DIR * dir_ptr = opendir(ev_dir_path.c_str());</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;  <span class="keywordflow">if</span> (dir_ptr != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    <span class="keyword">struct </span>dirent * dirnet_ptr;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    <span class="keywordflow">while</span> ((dirnet_ptr = readdir(dir_ptr)) != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;      std::string file_name = dirnet_ptr-&gt;d_name;</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;      <span class="keywordflow">if</span> (file_name.find(<span class="stringliteral">&quot;.yaml&quot;</span>) != std::string::npos) {</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;        file_list.push_back(file_name);</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;      }</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    }</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    closedir(dir_ptr);</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    RCLCPP_ERROR_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;No ev.&quot;</span>);</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;  }</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160; </div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;  <span class="comment">// File list</span></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> file_name : file_list) {</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    std::string ev_file_path = ev_dir_path + <span class="stringliteral">&quot;/&quot;</span> + file_name;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;      this-&gt;get_logger(), <span class="stringliteral">&quot;&#39;Elevator&#39; to &#39;&quot;</span> &lt;&lt; ev_file_path &lt;&lt; <span class="stringliteral">&quot;&#39;.&quot;</span>);</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160; </div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;      YAML::Node ev_node = YAML::LoadFile(ev_file_path.c_str());</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;      std::string ev_name = ev_node[<span class="stringliteral">&quot;name&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;      RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;  EV name: &quot;</span> &lt;&lt; ev_name);</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;      std::string ev_sector = ev_node[<span class="stringliteral">&quot;sector&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;      RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;  EV sector: &quot;</span> &lt;&lt; ev_sector);</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;      <span class="comment">// Waypoints</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;      RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;  WayPoints&quot;</span>);</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;      YAML::Node wps_node = ev_node[<span class="stringliteral">&quot;waypoints&quot;</span>];</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;      <span class="keywordflow">for</span> (YAML::iterator wp_it = wps_node.begin(); wp_it != wps_node.end(); ++wp_it) {</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        aimbot_state_interfaces::msg::Waypoint wp;</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;        wp.key = wp_it-&gt;second[<span class="stringliteral">&quot;key&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;        RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;    key: &quot;</span> &lt;&lt; wp.key);</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;        wp.location = ev_name;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;        RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;      location: &quot;</span> &lt;&lt; wp.location);</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        wp.pose.x = wp_it-&gt;second[<span class="stringliteral">&quot;x&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        wp.pose.y = wp_it-&gt;second[<span class="stringliteral">&quot;y&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        wp.pose.theta = wp_it-&gt;second[<span class="stringliteral">&quot;theta&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;() * M_PI / 180;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;        wp.sector = ev_sector;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;        wp.action = aimbot_state_interfaces::msg::Waypoint::ACTION_NONE;</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;        std::vector&lt;std::string&gt; floors = wp_it-&gt;second[<span class="stringliteral">&quot;floor&quot;</span>].as&lt;std::vector&lt;std::string&gt;&gt;();</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> floor : floors) {</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;          wp.floor = floor;</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;          RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;      floor: &quot;</span> &lt;&lt; wp.floor);</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;          <a class="code" href="classmap__manager_1_1MapManager.html#a87f668443752e667b73e38cffda45160">waypoint_list_</a>.push_back(wp);</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        }</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;          this-&gt;get_logger(),</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;          <span class="stringliteral">&quot;      Pose: &quot;</span> &lt;&lt; wp.pose.x &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; wp.pose.y &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; wp.pose.theta * 180.0 / M_PI);</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;      }</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160; </div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;      <span class="comment">// Door</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;      RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;  Doors&quot;</span>);</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;      YAML::Node door_node = ev_node[<span class="stringliteral">&quot;doors&quot;</span>];</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;      <span class="keywordflow">for</span> (YAML::iterator door_it = door_node.begin(); door_it != door_node.end(); ++door_it) {</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;        <a class="code" href="structmap__manager_1_1DoorPose.html">DoorPose</a> door;</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;        door.<a class="code" href="structmap__manager_1_1DoorPose.html#af6920aa35cefa680e3041ed11606c251">name</a> = ev_name;</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;        RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;    name: &quot;</span> &lt;&lt; door.<a class="code" href="structmap__manager_1_1DoorPose.html#af6920aa35cefa680e3041ed11606c251">name</a>);</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;        door.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.x = door_it-&gt;second[<span class="stringliteral">&quot;x&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;        door.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.y = door_it-&gt;second[<span class="stringliteral">&quot;y&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;        door.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.theta = door_it-&gt;second[<span class="stringliteral">&quot;theta&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;() * M_PI / 180;</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;        door.<a class="code" href="structmap__manager_1_1DoorPose.html#afa3b255e833eebb9febd623f0cd25a70">floor</a> = door_it-&gt;second[<span class="stringliteral">&quot;floor&quot;</span>].as&lt;std::vector&lt;std::string&gt;&gt;();</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;        <a class="code" href="classmap__manager_1_1MapManager.html#aa27bff05661f2dddd4a75a3b98820c0a">door_list_</a>.push_back(door);</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;        RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;          this-&gt;get_logger(),</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;          <span class="stringliteral">&quot;      Pose: &quot;</span> &lt;&lt; door.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.x &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; door.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.y &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;            door.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.theta * 180.0 / M_PI);</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;      }</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160; </div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160; </div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;      <a class="code" href="structmap__manager_1_1EvObjects.html">EvObjects</a> ev_object;</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;      <span class="comment">// Object</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;      RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;  Objects&quot;</span>);</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;      YAML::Node obj_node = ev_node[<span class="stringliteral">&quot;objects&quot;</span>];</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;      <span class="keywordflow">if</span> (obj_node.IsDefined()) {</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> object_it = obj_node.begin(); object_it != obj_node.end(); ++object_it) {</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;          <a class="code" href="structmap__manager_1_1Object.html">Object</a> object;</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;          <span class="keywordtype">object</span>.<a class="code" href="structmap__manager_1_1Object.html#a1176e4b280d1c65384c77c9962e81f13">name</a> = object_it-&gt;second[<span class="stringliteral">&quot;name&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;          <span class="keywordflow">if</span> (object_it-&gt;second[<span class="stringliteral">&quot;floor&quot;</span>].IsDefined()) {</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;            <span class="keywordtype">object</span>.floor = object_it-&gt;second[<span class="stringliteral">&quot;floor&quot;</span>].as&lt;std::vector&lt;std::string&gt;&gt;();</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;            RCLCPP_ERROR_STREAM(get_logger(), <span class="stringliteral">&quot;Fail to add Object : Floor is not set.&quot;</span>);</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;          }</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;          <span class="keywordtype">object</span>.sector = object_it-&gt;second[<span class="stringliteral">&quot;sector&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160; </div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;          <span class="keywordtype">object</span>.pose.position.x = object_it-&gt;second[<span class="stringliteral">&quot;x&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;          <span class="keywordtype">object</span>.pose.position.y = object_it-&gt;second[<span class="stringliteral">&quot;y&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;          <span class="keywordtype">object</span>.pose.position.z = object_it-&gt;second[<span class="stringliteral">&quot;z&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;          <span class="keywordtype">object</span>.pose.orientation.w =</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;            cos((object_it-&gt;second[<span class="stringliteral">&quot;yaw&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;() * M_PI / 180.) / 2);</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;          <span class="keywordtype">object</span>.pose.orientation.x = 0.0;</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;          <span class="keywordtype">object</span>.pose.orientation.y = 0.0;</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;          <span class="keywordtype">object</span>.pose.orientation.z =</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;            sin((object_it-&gt;second[<span class="stringliteral">&quot;yaw&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;() * M_PI / 180.) / 2);</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;          RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;            get_logger(), <span class="stringliteral">&quot;    Add &#39;&quot;</span> &lt;&lt; <span class="keywordtype">object</span>.name &lt;&lt; <span class="stringliteral">&quot;&#39; object : &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;              <span class="keywordtype">object</span>.pose.position.x &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <span class="keywordtype">object</span>.pose.position.y &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;              <span class="keywordtype">object</span>.pose.position.z &lt;&lt; <span class="stringliteral">&quot;/ &quot;</span> &lt;&lt; object_it-&gt;second[<span class="stringliteral">&quot;yaw&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;());</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;          RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;            get_logger(),</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;            <span class="stringliteral">&quot;&#39; Floor : &quot;</span> &lt;&lt; <span class="keywordtype">object</span>.floor.at(0) &lt;&lt; <span class="stringliteral">&quot; ~ &quot;</span> &lt;&lt; <span class="keywordtype">object</span>.floor.at(</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;              <span class="keywordtype">object</span>.floor.size() - 1));</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;          ev_object.<a class="code" href="structmap__manager_1_1EvObjects.html#ae859eb837cd68006ccc3ffb8f3fb6bb4">objects</a>.push_back(<span class="keywordtype">object</span>);</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;        }</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;      }</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160; </div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;      <span class="comment">// Boundarys</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;      RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;  Boundarys&quot;</span>);</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;      YAML::Node boundary_node = ev_node[<span class="stringliteral">&quot;boundarys&quot;</span>];</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;      <span class="keywordflow">if</span> (boundary_node.IsDefined()) {</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> boundary_it = boundary_node.begin(); boundary_it != boundary_node.end();</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;          ++boundary_it)</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;        {</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;          <a class="code" href="structmap__manager_1_1Boundary.html">Boundary</a> boundary;</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;          <span class="keywordflow">if</span> (boundary_it-&gt;second[<span class="stringliteral">&quot;floor&quot;</span>].IsDefined()) {</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;            boundary.<a class="code" href="structmap__manager_1_1Boundary.html#aa41cefe18b37e6fd8aed95ce2dca2db5">floor</a> = boundary_it-&gt;second[<span class="stringliteral">&quot;floor&quot;</span>].as&lt;std::vector&lt;std::string&gt;&gt;();</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;            RCLCPP_ERROR_STREAM(get_logger(), <span class="stringliteral">&quot;Fail to add Object : Floor is not set.&quot;</span>);</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;          }</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;          boundary.<a class="code" href="structmap__manager_1_1Boundary.html#a3e9b694f451581635d6d19b403ba7840">sector</a> = boundary_it-&gt;second[<span class="stringliteral">&quot;sector&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;          RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;            get_logger(), <span class="stringliteral">&quot;    Add &#39;&quot;</span> &lt;&lt; ev_name &lt;&lt; <span class="stringliteral">&quot;&#39; boundary : sector &#39;&quot;</span> &lt;&lt; boundary.<a class="code" href="structmap__manager_1_1Boundary.html#a3e9b694f451581635d6d19b403ba7840">sector</a> &lt;&lt;</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;              <span class="stringliteral">&quot;&#39; Floor : &quot;</span> &lt;&lt; boundary.<a class="code" href="structmap__manager_1_1Boundary.html#aa41cefe18b37e6fd8aed95ce2dca2db5">floor</a>.at(0) &lt;&lt; <span class="stringliteral">&quot; ~ &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;              boundary.<a class="code" href="structmap__manager_1_1Boundary.html#aa41cefe18b37e6fd8aed95ce2dca2db5">floor</a>.at(boundary.<a class="code" href="structmap__manager_1_1Boundary.html#aa41cefe18b37e6fd8aed95ce2dca2db5">floor</a>.size() - 1));</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;          YAML::Node boundary_points_node = boundary_it-&gt;second[<span class="stringliteral">&quot;points&quot;</span>];</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;          <span class="keywordflow">if</span> (boundary_points_node.IsDefined()) {</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> single_it = boundary_points_node.begin();</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;              single_it != boundary_points_node.end(); single_it++)</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;            {</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;              geometry_msgs::msg::Point32 point;</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;              point.x = single_it-&gt;second[<span class="stringliteral">&quot;x&quot;</span>].as&lt;<span class="keywordtype">float</span>&gt;();</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;              point.y = single_it-&gt;second[<span class="stringliteral">&quot;y&quot;</span>].as&lt;<span class="keywordtype">float</span>&gt;();</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;              point.z = single_it-&gt;second[<span class="stringliteral">&quot;z&quot;</span>].as&lt;<span class="keywordtype">float</span>&gt;();</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;              boundary.<a class="code" href="structmap__manager_1_1Boundary.html#a5d53e934d4e3b28bf93b104ed23febe7">polygon</a>.points.push_back(point);</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;              RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;                get_logger(), <span class="stringliteral">&quot;  point :&quot;</span> &lt;&lt; point.x &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; point.y &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; point.z);</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;            }</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;            ev_object.<a class="code" href="structmap__manager_1_1EvObjects.html#aca73b997a37c0c406cbf57e98f29eebe">boundarys</a>.push_back(boundary);</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;          }</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;        }</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;      }</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#a45595a5e2f526bc23ccbe25e46ab7137">ev_object_list_</a>.insert(std::make_pair(ev_name, ev_object));</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160; </div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;      <span class="comment">// Buttons</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;      RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;  Buttons&quot;</span>);</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;      YAML::Node btn_node = ev_node[<span class="stringliteral">&quot;buttons&quot;</span>];</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;      <span class="keywordflow">if</span> (btn_node.IsDefined()) {</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classmap__manager_1_1MapManager.html#a802cc5d12e3708df05428d4769fbf21b">add_button</a>(btn_node, <span class="stringliteral">&quot;NULL&quot;</span>, ev_name)) {<span class="keywordflow">continue</span>;}</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;      }</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp; e) {</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;      RCLCPP_ERROR_STREAM(get_logger(), <span class="stringliteral">&quot;Fail to load destination data. : &quot;</span> &lt;&lt; e.what());</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    }</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;  }</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;}</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160; </div>
<div class="line"><a name="l01848"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#abef0cfc5072ecc0f6698066dcaea1c2a"> 1848</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmap__manager_1_1MapManager.html#abef0cfc5072ecc0f6698066dcaea1c2a">MapManager::load_gate</a>()</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;{</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;  std::string gate_dir_path =</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    ament_index_cpp::get_package_share_directory(<span class="stringliteral">&quot;aimbot_params&quot;</span>) +</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    <span class="stringliteral">&quot;/site/&quot;</span> + <a class="code" href="classmap__manager_1_1MapManager.html#abafd8e1c11994af6f66c5c85e480fcbc">map_site_name_</a> + <span class="stringliteral">&quot;/map/gate&quot;</span>;</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160; </div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;  <span class="comment">// Get File List in the Directory</span></div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;  std::vector&lt;std::string&gt; file_list;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160; </div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;  DIR * dir_ptr = opendir(gate_dir_path.c_str());</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;  <span class="keywordflow">if</span> (dir_ptr != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    <span class="keyword">struct </span>dirent * dirnet_ptr;</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    <span class="keywordflow">while</span> ((dirnet_ptr = readdir(dir_ptr)) != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;      std::string file_name = dirnet_ptr-&gt;d_name;</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;      <span class="keywordflow">if</span> (file_name.find(<span class="stringliteral">&quot;.yaml&quot;</span>) != std::string::npos) {</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;        file_list.push_back(file_name);</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;      }</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    }</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    closedir(dir_ptr);</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    RCLCPP_ERROR_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;No Gate.&quot;</span>);</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;  }</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160; </div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;  <span class="comment">// File list</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> file_name : file_list) {</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;    std::string gate_file_path = gate_dir_path + <span class="stringliteral">&quot;/&quot;</span> + file_name;</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;      this-&gt;get_logger(), <span class="stringliteral">&quot;&#39;Gate&#39; to &#39;&quot;</span> &lt;&lt; gate_file_path &lt;&lt; <span class="stringliteral">&quot;&#39;.&quot;</span>);</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160; </div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;      YAML::Node gate_node = YAML::LoadFile(gate_file_path.c_str());</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;      std::string gate_name = gate_node[<span class="stringliteral">&quot;name&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;      RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;  GATE name: &quot;</span> &lt;&lt; gate_name);</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160; </div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;      <span class="comment">// Gate Door</span></div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;      <a class="code" href="structmap__manager_1_1DoorPose.html">DoorPose</a> door_pose;</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;      door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#af6920aa35cefa680e3041ed11606c251">name</a> = gate_name;</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;      door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#afa3b255e833eebb9febd623f0cd25a70">floor</a> = gate_node[<span class="stringliteral">&quot;floor&quot;</span>].as&lt;std::vector&lt;std::string&gt;&gt;();</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;      door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.x = gate_node[<span class="stringliteral">&quot;pose&quot;</span>][<span class="stringliteral">&quot;x&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;      door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.y = gate_node[<span class="stringliteral">&quot;pose&quot;</span>][<span class="stringliteral">&quot;y&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;      door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.theta = gate_node[<span class="stringliteral">&quot;pose&quot;</span>][<span class="stringliteral">&quot;theta&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;() * M_PI / 180;</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;      RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;        get_logger(), <span class="stringliteral">&quot;    Door Difined &#39;&quot;</span> &lt;&lt; door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#af6920aa35cefa680e3041ed11606c251">name</a> &lt;&lt; <span class="stringliteral">&quot;&#39; : &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;          door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.x &lt;&lt; <span class="stringliteral">&quot;m, &quot;</span> &lt;&lt; door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.y &lt;&lt; <span class="stringliteral">&quot;m, &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;          door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">pose</a>.theta * 180 / M_PI &lt;&lt; <span class="stringliteral">&quot;deg.&quot;</span>);</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;      <a class="code" href="classmap__manager_1_1MapManager.html#aa27bff05661f2dddd4a75a3b98820c0a">door_list_</a>.push_back(door_pose);</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160; </div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;      <span class="comment">// Waypoints</span></div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;      RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;  WayPoints&quot;</span>);</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;      std::vector&lt;YAML::Node&gt; sector_nodes;</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;      sector_nodes.push_back(gate_node[<span class="stringliteral">&quot;first_sector&quot;</span>]);</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;      sector_nodes.push_back(gate_node[<span class="stringliteral">&quot;second_sector&quot;</span>]);</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160; </div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> sector_node : sector_nodes) {</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;        aimbot_state_interfaces::msg::Waypoint wp;</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;        wp.key = gate_name;</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;        RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;    key: &quot;</span> &lt;&lt; wp.key);</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;        wp.location = sector_node[<span class="stringliteral">&quot;sector_name&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;        RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;      location: &quot;</span> &lt;&lt; wp.location);</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;        wp.pose.x = sector_node[<span class="stringliteral">&quot;pose&quot;</span>][<span class="stringliteral">&quot;x&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;        wp.pose.y = sector_node[<span class="stringliteral">&quot;pose&quot;</span>][<span class="stringliteral">&quot;y&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;        wp.pose.theta = sector_node[<span class="stringliteral">&quot;pose&quot;</span>][<span class="stringliteral">&quot;theta&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;() * M_PI / 180;</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;        wp.action = sector_node[<span class="stringliteral">&quot;action&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;        wp.sector = wp.location;</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> floor : door_pose.<a class="code" href="structmap__manager_1_1DoorPose.html#afa3b255e833eebb9febd623f0cd25a70">floor</a>) {</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;          wp.floor = floor;</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;          RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;      floor: &quot;</span> &lt;&lt; wp.floor);</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;          <a class="code" href="classmap__manager_1_1MapManager.html#a87f668443752e667b73e38cffda45160">waypoint_list_</a>.push_back(wp);</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;        }</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;        RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;          this-&gt;get_logger(),</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;          <span class="stringliteral">&quot;      Pose: &quot;</span> &lt;&lt; wp.pose.x &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; wp.pose.y &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; wp.pose.theta);</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;        RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;      action: &quot;</span> &lt;&lt; wp.action);</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160; </div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;        <span class="comment">// Buttons</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;        RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;  Buttons&quot;</span>);</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;        YAML::Node btn_node = sector_node[<span class="stringliteral">&quot;buttons&quot;</span>];</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        <span class="keywordflow">if</span> (btn_node.IsDefined()) {</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classmap__manager_1_1MapManager.html#a802cc5d12e3708df05428d4769fbf21b">add_button</a>(btn_node, <span class="stringliteral">&quot;NULL&quot;</span>, gate_name)) {<span class="keywordflow">continue</span>;}</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;        }</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;      }</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp; e) {</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;      RCLCPP_ERROR_STREAM(get_logger(), <span class="stringliteral">&quot;Fail to load destination data. : &quot;</span> &lt;&lt; e.what());</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    }</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;  }</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;}</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160; </div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160; </div>
<div class="line"><a name="l01939"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#ac13aab1c38097c2e46773c715751f888"> 1939</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmap__manager_1_1MapManager.html#ac13aab1c38097c2e46773c715751f888">MapManager::load_sector_data</a>()</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;{</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;  std::string param_file_path =</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    ament_index_cpp::get_package_share_directory(<span class="stringliteral">&quot;aimbot_params&quot;</span>) +</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    <span class="stringliteral">&quot;/site/&quot;</span> +</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#abafd8e1c11994af6f66c5c85e480fcbc">map_site_name_</a> +</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    <span class="stringliteral">&quot;/map/sectors.yaml&quot;</span>;</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;  RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Load &#39;sector&#39; to &#39;&quot;</span> &lt;&lt; param_file_path &lt;&lt; <span class="stringliteral">&quot;&#39;.&quot;</span>);</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160; </div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;  YAML::Node sector_node;</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;  <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    sector_node = YAML::LoadFile(param_file_path.c_str());</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    std::string default_sector = sector_node[<span class="stringliteral">&quot;default_sector&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;      get_logger(), <span class="stringliteral">&quot;The default sector is &#39;&quot;</span> &lt;&lt; default_sector &lt;&lt; <span class="stringliteral">&quot;&#39; .&quot;</span>);</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160; </div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#aafea5fd37c00885e1017a93be4c7178a">sector_list_</a>.reset();</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#aafea5fd37c00885e1017a93be4c7178a">sector_list_</a> = std::make_shared&lt;Sector&gt;(default_sector);</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160; </div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    <span class="keywordflow">for</span> (YAML::iterator sector_it = sector_node.begin(); sector_it != sector_node.end();</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;      ++sector_it)</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    {</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;      <span class="comment">// default</span></div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;      <span class="keywordflow">if</span> (sector_it-&gt;first.as&lt;std::string&gt;() == <span class="stringliteral">&quot;default_sector&quot;</span>) {</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;      }</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;      YAML::Node sub_node = sector_it-&gt;second;</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;      <span class="keywordflow">if</span> (sub_node[<span class="stringliteral">&quot;floor&quot;</span>].IsScalar()) {</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;        <span class="comment">// Sector Name</span></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;        std::string sector_name = sub_node[<span class="stringliteral">&quot;name&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;        RCLCPP_INFO_STREAM(get_logger(), <span class="stringliteral">&quot;Sector name : &quot;</span> &lt;&lt; sector_name);</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;        <span class="comment">// floor</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;        std::string floor = sub_node[<span class="stringliteral">&quot;floor&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;        RCLCPP_INFO_STREAM(get_logger(), <span class="stringliteral">&quot;       floor : &quot;</span> &lt;&lt; floor);</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160; </div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;        <span class="comment">// lines</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        std::vector&lt;std::vector&lt;double&gt;&gt; lines;</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;        lines.clear();</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;        YAML::Node line_node = sub_node[<span class="stringliteral">&quot;lines&quot;</span>];</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;        <span class="keywordflow">for</span> (YAML::iterator line_it = line_node.begin(); line_it != line_node.end(); ++line_it) {</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;          std::vector&lt;double&gt; single_line = line_it-&gt;second.as&lt;std::vector&lt;double&gt;&gt;();</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;          <span class="keywordflow">if</span> (single_line.size() == 3) {</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;            lines.push_back(single_line);</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;            RCLCPP_WARN_STREAM(</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;              get_logger(),</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;              <span class="stringliteral">&quot;A line &#39;&quot;</span> &lt;&lt; line_it-&gt;first &lt;&lt; <span class="stringliteral">&quot;&#39; of sector &#39;&quot;</span> &lt;&lt; sector_name &lt;&lt;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;                <span class="stringliteral">&quot;&#39; has not 3 values.&quot;</span>);</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;          }</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;        }</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;        <span class="keywordflow">if</span> (lines.size() == 0) {</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;          RCLCPP_WARN_STREAM(</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;            get_logger(),</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;            <span class="stringliteral">&quot;The sector &#39;&quot;</span> &lt;&lt; sector_name &lt;&lt; <span class="stringliteral">&quot;&#39; has not a single line.&quot;</span>);</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;        }</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160; </div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;        <a class="code" href="classmap__manager_1_1DividingLines.html">DividingLines</a> div_lines(floor, lines.at(0).at(0), lines.at(0).at(1), lines.at(0).at(2));</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;        RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;          get_logger(), <span class="stringliteral">&quot;       line : &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;            lines.at(0).at(0) &lt;&lt; <span class="stringliteral">&quot;x + &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;            lines.at(0).at(1) &lt;&lt; <span class="stringliteral">&quot;y + &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;            lines.at(0).at(2) &lt;&lt; <span class="stringliteral">&quot; &gt;= 0&quot;</span>);</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;        <span class="keywordflow">for</span> (uint i = 1; i &lt; lines.size(); i++) {</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;          div_lines.<a class="code" href="classmap__manager_1_1DividingLines.html#a5c811e155a3e5affd155b29dbd5b82e0">add_dividing_line</a>(lines.at(i).at(0), lines.at(i).at(1), lines.at(i).at(2));</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;          RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;            get_logger(), <span class="stringliteral">&quot;              &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;              lines.at(i).at(0) &lt;&lt; <span class="stringliteral">&quot;x + &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;              lines.at(i).at(1) &lt;&lt; <span class="stringliteral">&quot;y + &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;              lines.at(i).at(2) &lt;&lt; <span class="stringliteral">&quot; &gt;= 0&quot;</span>);</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;        }</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;        <a class="code" href="classmap__manager_1_1MapManager.html#aafea5fd37c00885e1017a93be4c7178a">sector_list_</a>-&gt;add_sector(sector_name, div_lines);</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;        <span class="comment">// floor</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;        std::vector&lt;std::string&gt; floors = sub_node[<span class="stringliteral">&quot;floor&quot;</span>].as&lt;std::vector&lt;std::string&gt;&gt;();</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> floor : floors) {</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;          <span class="comment">// Sector Name</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;          std::string sector_name = sub_node[<span class="stringliteral">&quot;name&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;          RCLCPP_INFO_STREAM(get_logger(), <span class="stringliteral">&quot;Sector name : &quot;</span> &lt;&lt; sector_name);</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160; </div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;          RCLCPP_INFO_STREAM(get_logger(), <span class="stringliteral">&quot;       floor : &quot;</span> &lt;&lt; floor);</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160; </div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;          <span class="comment">// lines</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;          std::vector&lt;std::vector&lt;double&gt;&gt; lines;</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;          lines.clear();</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;          YAML::Node line_node = sub_node[<span class="stringliteral">&quot;lines&quot;</span>];</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;          <span class="keywordflow">for</span> (YAML::iterator line_it = line_node.begin(); line_it != line_node.end(); ++line_it) {</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;            std::vector&lt;double&gt; single_line = line_it-&gt;second.as&lt;std::vector&lt;double&gt;&gt;();</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;            <span class="keywordflow">if</span> (single_line.size() == 3) {</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;              lines.push_back(single_line);</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;              RCLCPP_WARN_STREAM(</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;                get_logger(),</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;                <span class="stringliteral">&quot;A line &#39;&quot;</span> &lt;&lt; line_it-&gt;first &lt;&lt; <span class="stringliteral">&quot;&#39; of sector &#39;&quot;</span> &lt;&lt; sector_name &lt;&lt;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;                  <span class="stringliteral">&quot;&#39; has not 3 values.&quot;</span>);</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;            }</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;          }</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;          <span class="keywordflow">if</span> (lines.size() == 0) {</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;            RCLCPP_WARN_STREAM(</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;              get_logger(),</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;              <span class="stringliteral">&quot;The sector &#39;&quot;</span> &lt;&lt; sector_name &lt;&lt; <span class="stringliteral">&quot;&#39; has not a single line.&quot;</span>);</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;          }</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160; </div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;          <a class="code" href="classmap__manager_1_1DividingLines.html">DividingLines</a> div_lines(floor, lines.at(0).at(0), lines.at(0).at(1), lines.at(0).at(2));</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;          RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;            get_logger(), <span class="stringliteral">&quot;       line : &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;              lines.at(0).at(0) &lt;&lt; <span class="stringliteral">&quot;x + &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;              lines.at(0).at(1) &lt;&lt; <span class="stringliteral">&quot;y + &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;              lines.at(0).at(2) &lt;&lt; <span class="stringliteral">&quot; &gt;= 0&quot;</span>);</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;          <span class="keywordflow">for</span> (uint i = 1; i &lt; lines.size(); i++) {</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;            div_lines.<a class="code" href="classmap__manager_1_1DividingLines.html#a5c811e155a3e5affd155b29dbd5b82e0">add_dividing_line</a>(lines.at(i).at(0), lines.at(i).at(1), lines.at(i).at(2));</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;            RCLCPP_INFO_STREAM(</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;              get_logger(), <span class="stringliteral">&quot;              &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;                lines.at(i).at(0) &lt;&lt; <span class="stringliteral">&quot;x + &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;                lines.at(i).at(1) &lt;&lt; <span class="stringliteral">&quot;y + &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;                lines.at(i).at(2) &lt;&lt; <span class="stringliteral">&quot; &gt;= 0&quot;</span>);</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;          }</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;          <a class="code" href="classmap__manager_1_1MapManager.html#aafea5fd37c00885e1017a93be4c7178a">sector_list_</a>-&gt;add_sector(sector_name, div_lines);</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;        }   <span class="comment">// floor 가 array 일때 floor에 따른 for</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;      }    <span class="comment">// floor 가 array 일때</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    }</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;  } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp; e) {</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    RCLCPP_ERROR_STREAM(get_logger(), <span class="stringliteral">&quot;Fail to load config data. : &quot;</span> &lt;&lt; e.what());</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;  }</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;}</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160; </div>
<div class="line"><a name="l02068"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a28209f1819a0735e54dcadccd337e546"> 2068</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmap__manager_1_1MapManager.html#a28209f1819a0735e54dcadccd337e546">MapManager::get_destination_list_callback</a>(</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;  <span class="keyword">const</span> std::shared_ptr&lt;rmw_request_id_t&gt; request_header,</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;  <span class="keyword">const</span> std::shared_ptr&lt;aimbot_state_interfaces::srv::GetDestinationList::Request&gt; request,</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;  std::shared_ptr&lt;aimbot_state_interfaces::srv::GetDestinationList::Response&gt; response)</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;{</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;  (void)request_header;</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;  RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;get saved POI(target) list callback.&quot;</span>);</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160; </div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;  (void)request;</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;  response-&gt;set__destination_list(<a class="code" href="classmap__manager_1_1MapManager.html#a47a7c408e0bbc50571eea14d42cd0cc3">dest_list_</a>);</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;}</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160; </div>
<div class="line"><a name="l02080"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a231cc314d6ce400df407ae337cc562eb"> 2080</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmap__manager_1_1MapManager.html#a231cc314d6ce400df407ae337cc562eb">MapManager::get_destination_callback</a>(</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;  <span class="keyword">const</span> std::shared_ptr&lt;rmw_request_id_t&gt; request_header,</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;  <span class="keyword">const</span> std::shared_ptr&lt;GetDestination::Request&gt; request,</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;  std::shared_ptr&lt;GetDestination::Response&gt; response)</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;{</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;  RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;----------------------------------------------------&quot;</span>);</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;  RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;get Destination callback.&quot;</span>);</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;  (void)request_header;</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;  <span class="keywordflow">if</span> (!request-&gt;poi_id.empty()) {</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Get Destination from POI_ID.&quot;</span>);</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> dest : <a class="code" href="classmap__manager_1_1MapManager.html#a47a7c408e0bbc50571eea14d42cd0cc3">dest_list_</a>) {</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;      <span class="keywordflow">if</span> (dest.poi_id == request-&gt;poi_id) {</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;        response-&gt;result = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;        response-&gt;dest = dest;</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;      }</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;    }</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;    RCLCPP_WARN_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;No destination matches the requested poi_id.&quot;</span>);</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!request-&gt;key.empty()) {</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;    RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Get Destination from KEY.&quot;</span>);</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> dest : <a class="code" href="classmap__manager_1_1MapManager.html#a47a7c408e0bbc50571eea14d42cd0cc3">dest_list_</a>) {</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;      <span class="keywordflow">if</span> (dest.key == request-&gt;key) {</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;        response-&gt;result = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;        response-&gt;dest = dest;</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;      }</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;    }</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;    RCLCPP_WARN_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;No destination matches the requested key.&quot;</span>);</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;    RCLCPP_ERROR_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Please request with a valid key or poi_id.&quot;</span>);</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;  }</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;  response-&gt;result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;}</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160; </div>
<div class="line"><a name="l02114"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a766be94e37bbd82a9537dbb09349abbd"> 2114</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmap__manager_1_1MapManager.html#a766be94e37bbd82a9537dbb09349abbd">MapManager::get_waypoint_callback</a>(</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;  <span class="keyword">const</span> std::shared_ptr&lt;rmw_request_id_t&gt; request_header,</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;  <span class="keyword">const</span> std::shared_ptr&lt;GetWaypoint::Request&gt; request,</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;  std::shared_ptr&lt;GetWaypoint::Response&gt; response)</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;{</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;  RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;get Waypoint callback.&quot;</span>);</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;  (void)request_header;</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160; </div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> waypoint : <a class="code" href="classmap__manager_1_1MapManager.html#a87f668443752e667b73e38cffda45160">waypoint_list_</a>) {</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    <span class="keywordflow">if</span> (waypoint.key == request-&gt;key &amp;&amp;</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;      waypoint.location == request-&gt;location &amp;&amp;</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;      waypoint.floor == request-&gt;floor)</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;    {</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;      response-&gt;result = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;      response-&gt;waypoint = waypoint;</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    }</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;  }</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;  response-&gt;result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;}</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160; </div>
<div class="line"><a name="l02135"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a36836b2c35bc93d4d2ee61004ed12a69"> 2135</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmap__manager_1_1MapManager.html#a36836b2c35bc93d4d2ee61004ed12a69">MapManager::get_door_pose_callback</a>(</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;  <span class="keyword">const</span> std::shared_ptr&lt;rmw_request_id_t&gt; request_header,</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;  <span class="keyword">const</span> std::shared_ptr&lt;aimbot_state_interfaces::srv::GetDoorPose::Request&gt; request,</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;  std::shared_ptr&lt;aimbot_state_interfaces::srv::GetDoorPose::Response&gt; response)</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;{</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;  (void)request_header;</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;  RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;get Door pose callback.&quot;</span>);</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160; </div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> door_pose : this-&gt;<a class="code" href="classmap__manager_1_1MapManager.html#aa27bff05661f2dddd4a75a3b98820c0a">door_list_</a>) {</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;    RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;req : &quot;</span> &lt;&lt; request-&gt;name &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; request-&gt;floor);</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;    <span class="keywordflow">if</span> (request-&gt;name == door_pose.name) {</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;      RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;name : &quot;</span> &lt;&lt; door_pose.name);</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> floor : door_pose.floor) {</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;        RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot; f :&quot;</span> &lt;&lt; floor);</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;        <span class="keywordflow">if</span> (request-&gt;floor == floor) {</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;          response-&gt;pose = <a class="code" href="classmap__manager_1_1MapManager.html#acf0adb7076b38fa8c1437263762eeb17">pose3d_to_2d</a>(</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;            <a class="code" href="classmap__manager_1_1MapManager.html#adaf1cb5af4ee7c536b16d36fcb08486d">transform_pose</a>(</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;              <a class="code" href="classmap__manager_1_1MapManager.html#acf6bafbe2a7fec6838e1f01f544c22e4">pose2d_to_3d</a>(<a class="code" href="classmap__manager_1_1MapManager.html#ac6a70fbf9ac90e568e25aea221d0c0bb">robot_map_frame_id_</a>, door_pose.pose),</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;              request-&gt;reference.frame_id));</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;          response-&gt;result = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;          RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Success to get Door pose.&quot;</span>);</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;          <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;        }</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;      }</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    }</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;  }</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;  response-&gt;result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;  RCLCPP_ERROR_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Fail to get Door pose.&quot;</span>);</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;}</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160; </div>
<div class="line"><a name="l02165"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a0edbfd6b0e0d95111f4f11d2c6853867"> 2165</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmap__manager_1_1MapManager.html#a0edbfd6b0e0d95111f4f11d2c6853867">MapManager::get_button_pose_callback</a>(</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;  <span class="keyword">const</span> std::shared_ptr&lt;rmw_request_id_t&gt; request_header,</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;  <span class="keyword">const</span> std::shared_ptr&lt;GetButtonPose::Request&gt; request,</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;  std::shared_ptr&lt;GetButtonPose::Response&gt; response)</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;{</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;  (void)request_header;</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;  RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;get button pose callback.&quot;</span>);</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160; </div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> button_pose : this-&gt;<a class="code" href="classmap__manager_1_1MapManager.html#a256793fc2637429a1c121f59a1e72a7a">button_poses_</a>) {</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    <span class="keywordflow">if</span> (request-&gt;name == button_pose.name) {</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;      <span class="keywordflow">if</span> (request-&gt;location == button_pose.location) {</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> floor : button_pose.floor) {</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;          <span class="keywordflow">if</span> (request-&gt;floor == floor) {</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;            geometry_msgs::msg::PoseStamped button;</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;            button.header.stamp = this-&gt;now();</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;            button.header.frame_id = <a class="code" href="classmap__manager_1_1MapManager.html#ac6a70fbf9ac90e568e25aea221d0c0bb">robot_map_frame_id_</a>;</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;            button.pose = button_pose.pose;</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;            response-&gt;pose = <a class="code" href="classmap__manager_1_1MapManager.html#adaf1cb5af4ee7c536b16d36fcb08486d">transform_pose</a>(button, request-&gt;reference.frame_id);</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;            response-&gt;result = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;            RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Success to get button pose.&quot;</span>);</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;          }</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;        }</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;      }</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;    }</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;  }</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;  response-&gt;result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;  RCLCPP_ERROR_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Fail to get button pose.&quot;</span>);</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;}</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160; </div>
<div class="line"><a name="l02195"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#ac462e554266d3019b3cb518ec2716d13"> 2195</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmap__manager_1_1MapManager.html#ac462e554266d3019b3cb518ec2716d13">MapManager::get_nearest_button_callback</a>(</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;  <span class="keyword">const</span> std::shared_ptr&lt;rmw_request_id_t&gt; request_header,</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;  <span class="keyword">const</span> std::shared_ptr&lt;aimbot_state_interfaces::srv::GetNearestButton::Request&gt; request,</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;  std::shared_ptr&lt;aimbot_state_interfaces::srv::GetNearestButton::Response&gt; response)</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;{</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;  RCLCPP_INFO_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;get nearest button callback.&quot;</span>);</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160; </div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;  response-&gt;success = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;  <span class="comment">// no button</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classmap__manager_1_1MapManager.html#a256793fc2637429a1c121f59a1e72a7a">button_poses_</a>.empty()) {</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    RCLCPP_ERROR_STREAM(this-&gt;get_logger(), <span class="stringliteral">&quot;Emtpy Button Pose Failure.&quot;</span>);</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;  }</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160; </div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;  <span class="comment">// get present pose</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a8a900d806e57e143205a86a2bb85765d">motion_state_mutex_</a>.lock();</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;  <span class="keyword">auto</span> present_position = <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>;</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a8a900d806e57e143205a86a2bb85765d">motion_state_mutex_</a>.unlock();</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160; </div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;  <span class="keywordtype">double</span> min_distance = 0.0;</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;  <span class="comment">// first input</span></div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;  <span class="keywordtype">bool</span> first_button = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;  geometry_msgs::msg::PoseStamped nearest_button_pose_from_map;</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> button_pose : this-&gt;<a class="code" href="classmap__manager_1_1MapManager.html#a256793fc2637429a1c121f59a1e72a7a">button_poses_</a>) {</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> button_floor : button_pose.floor) {</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;      <span class="keywordflow">if</span> (button_floor == present_position.floor_) {</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;        <span class="keywordflow">if</span> (first_button) {</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;          response-&gt;name = button_pose.name;</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;          response-&gt;floor = button_floor;</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;          response-&gt;location = button_pose.location;</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;          nearest_button_pose_from_map.header.stamp = <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a16a596b50b6aaa332a0ff01a832015c9">stamp_</a>;</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;          nearest_button_pose_from_map.header.frame_id =</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;            <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a9977f778ffcae79ca443e1b5cc75bf89">map_current_frame_id_</a>;</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;          nearest_button_pose_from_map.pose = button_pose.pose;</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;          min_distance =</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;            sqrt(</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;            (button_pose.pose.position.x - present_position.pose_2d_from_map_current_.x) *</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;            (button_pose.pose.position.x - present_position.pose_2d_from_map_current_.x) +</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;            (button_pose.pose.position.y - present_position.pose_2d_from_map_current_.y) *</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;            (button_pose.pose.position.y - present_position.pose_2d_from_map_current_.y));</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;          response-&gt;success = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;          first_button = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;          <span class="keywordtype">double</span> distance = sqrt(</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;            (button_pose.pose.position.x - present_position.pose_2d_from_map_current_.x) *</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;            (button_pose.pose.position.x - present_position.pose_2d_from_map_current_.x) +</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;            (button_pose.pose.position.y - present_position.pose_2d_from_map_current_.y) *</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;            (button_pose.pose.position.y - present_position.pose_2d_from_map_current_.y));</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;          <span class="keywordflow">if</span> (distance &lt; min_distance) {</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;            response-&gt;name = button_pose.name;</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;            response-&gt;floor = button_floor;</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;            response-&gt;location = button_pose.location;</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;            nearest_button_pose_from_map.header.stamp = <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a16a596b50b6aaa332a0ff01a832015c9">stamp_</a>;</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;            nearest_button_pose_from_map.header.frame_id =</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;              <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a9977f778ffcae79ca443e1b5cc75bf89">map_current_frame_id_</a>;</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;            nearest_button_pose_from_map.pose = button_pose.pose;</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;            min_distance = distance;</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;            response-&gt;success = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;          }</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;        }</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;      }</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    }</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;  }</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;  <span class="comment">// Recalculate</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;  <span class="keywordflow">if</span> (response-&gt;success) {</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;    response-&gt;pose = <a class="code" href="classmap__manager_1_1MapManager.html#adaf1cb5af4ee7c536b16d36fcb08486d">transform_pose</a>(nearest_button_pose_from_map, request-&gt;reference_frame_id);</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;  }</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;}</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160; </div>
<div class="line"><a name="l02264"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a5d01b1a769864bebe21963b7ada39bc0"> 2264</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmap__manager_1_1MapManager.html#a5d01b1a769864bebe21963b7ada39bc0">MapManager::publish_motion_state</a>()</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;{</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;  aimbot_state_interfaces::msg::MotionState motion_state;</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a8a900d806e57e143205a86a2bb85765d">motion_state_mutex_</a>.lock();</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;  motion_state.header.stamp = this-&gt;now();</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;  motion_state.header.frame_id = <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a9977f778ffcae79ca443e1b5cc75bf89">map_current_frame_id_</a>;</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;  motion_state.pose_from_map_current = <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#a3fa894f8f09fb6d4e3cbf484bd2048d9">pose_2d_from_map_current_</a>;</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;  motion_state.floor = <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#ac2c56020cad267a628141fc69c73180a">floor_</a>;</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;  motion_state.sector = <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#af59ff7bf9359a2adb81e19c7abadc5cb">sector_</a>;</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;  motion_state.atm_floor = <a class="code" href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">mobile_motion_state_</a>.<a class="code" href="structmap__manager_1_1AimbotMotionState.html#afc1fd1bca09f4df6cb0f59dc36dd351f">atm_floor_</a>;</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a8a900d806e57e143205a86a2bb85765d">motion_state_mutex_</a>.unlock();</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#aa6b223ac88d0cd7c1a7690b55b0b0546">motion_state_pub_</a>-&gt;publish(motion_state);</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;}</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160; </div>
<div class="line"><a name="l02278"></a><span class="lineno"><a class="line" href="classmap__manager_1_1MapManager.html#a2c92e8dee5f85f2e6da8aa6f700cc3db"> 2278</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmap__manager_1_1MapManager.html#a2c92e8dee5f85f2e6da8aa6f700cc3db">MapManager::publish_tf</a>()</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;{</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;  geometry_msgs::msg::TransformStamped map_current_tf;</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;  map_current_tf.header.stamp = now();</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;  map_current_tf.header.frame_id = <a class="code" href="classmap__manager_1_1MapManager.html#ab0690c838523c783bb4ff9b5cf8831e6">current_map_frame_id_</a>;</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;  map_current_tf.transform.translation.x = 0.0;</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;  map_current_tf.transform.translation.y = 0.0;</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;  map_current_tf.transform.translation.z = 0.0;</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;  map_current_tf.transform.rotation.w = 1.0;</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;  map_current_tf.transform.rotation.x = 0.0;</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;  map_current_tf.transform.rotation.y = 0.0;</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;  map_current_tf.transform.rotation.z = 0.0;</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;  map_current_tf.child_frame_id = <a class="code" href="classmap__manager_1_1MapManager.html#ac6a70fbf9ac90e568e25aea221d0c0bb">robot_map_frame_id_</a>;</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a79660eef4c19cb5072f01c11de050846">current_map_tf_broadcaster_</a>-&gt;sendTransform(map_current_tf);</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160; </div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classmap__manager_1_1MapManager.html#a2cd07fd57027b359e8677aee6e8930dc">map_list_</a>.size(); i++) {</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;    geometry_msgs::msg::TransformStamped tf;</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;    tf.header.stamp = now();</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;    tf.header.frame_id = <a class="code" href="classmap__manager_1_1MapManager.html#a2cd07fd57027b359e8677aee6e8930dc">map_list_</a>.at(i).get_parent_frame();</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;    tf.transform.translation.x = <a class="code" href="classmap__manager_1_1MapManager.html#a2cd07fd57027b359e8677aee6e8930dc">map_list_</a>.at(i).get_tf_offset_x();</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;    tf.transform.translation.y = <a class="code" href="classmap__manager_1_1MapManager.html#a2cd07fd57027b359e8677aee6e8930dc">map_list_</a>.at(i).get_tf_offset_y();</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;    tf.transform.translation.z = <a class="code" href="classmap__manager_1_1MapManager.html#a2cd07fd57027b359e8677aee6e8930dc">map_list_</a>.at(i).get_tf_offset_z();</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;    tf.transform.rotation.w = 1.0;</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;    tf.transform.rotation.x = 0.0;</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;    tf.transform.rotation.y = 0.0;</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;    tf.transform.rotation.z = 0.0;</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;    tf.child_frame_id = <a class="code" href="classmap__manager_1_1MapManager.html#a2cd07fd57027b359e8677aee6e8930dc">map_list_</a>.at(i).get_frame();</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;    <a class="code" href="classmap__manager_1_1MapManager.html#a28554371705cb39d1ee6883ad7d15b3c">map_tf_broadcaster_list_</a>.at(i)-&gt;sendTransform(tf);</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;  }</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160; </div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;  geometry_msgs::msg::TransformStamped msg;</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;  msg.header.stamp = now();</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;  msg.header.frame_id = <span class="stringliteral">&quot;map_&quot;</span> + <a class="code" href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">docking_station_</a>.<a class="code" href="structmap__manager_1_1DockingStation.html#aeadd7ce73766c12617fc524aea140829">floor_</a>;</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;  msg.transform.translation.x = <a class="code" href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">docking_station_</a>.<a class="code" href="structmap__manager_1_1DockingStation.html#ada28d947caadaa213278c2b670fda9e0">pose</a>.x;</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;  msg.transform.translation.y = <a class="code" href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">docking_station_</a>.<a class="code" href="structmap__manager_1_1DockingStation.html#ada28d947caadaa213278c2b670fda9e0">pose</a>.y;</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;  msg.transform.translation.z = 0.0;</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;  msg.transform.rotation.w = cos(<a class="code" href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">docking_station_</a>.<a class="code" href="structmap__manager_1_1DockingStation.html#ada28d947caadaa213278c2b670fda9e0">pose</a>.theta / 2.0);</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;  msg.transform.rotation.x = 0.0;</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;  msg.transform.rotation.y = 0.0;</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;  msg.transform.rotation.z = sin(<a class="code" href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">docking_station_</a>.<a class="code" href="structmap__manager_1_1DockingStation.html#ada28d947caadaa213278c2b670fda9e0">pose</a>.theta / 2.0);</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;  msg.child_frame_id = <span class="stringliteral">&quot;station_footprint&quot;</span>;</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;  <a class="code" href="classmap__manager_1_1MapManager.html#a6069c7059db4ad16d24920daec11a79a">station_tf_broadcaster_</a>-&gt;sendTransform(msg);</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;}</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160; </div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;}  <span class="comment">// namespace map_manager</span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a256793fc2637429a1c121f59a1e72a7a"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a256793fc2637429a1c121f59a1e72a7a">map_manager::MapManager::button_poses_</a></div><div class="ttdeci">std::vector&lt; ButtonPose &gt; button_poses_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00204">map_manager.hpp:204</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a7071293836db63e8aa53f4ac65775d16"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a7071293836db63e8aa53f4ac65775d16">map_manager::MapManager::init_pose_callback</a></div><div class="ttdeci">MAP_MANAGER_LOCAL void init_pose_callback(const geometry_msgs::msg::PoseWithCovarianceStamped::SharedPtr msg)</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l00875">map_manager.cpp:875</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_aa6b223ac88d0cd7c1a7690b55b0b0546"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#aa6b223ac88d0cd7c1a7690b55b0b0546">map_manager::MapManager::motion_state_pub_</a></div><div class="ttdeci">rclcpp_lifecycle::LifecyclePublisher&lt; aimbot_state_interfaces::msg::MotionState &gt;::SharedPtr motion_state_pub_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00367">map_manager.hpp:367</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a0b0c1516dc94b0ffe29fb3221242e785"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a0b0c1516dc94b0ffe29fb3221242e785">map_manager::MapManager::sub_callback_group_</a></div><div class="ttdeci">rclcpp::CallbackGroup::SharedPtr sub_callback_group_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00259">map_manager.hpp:259</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_aa59a8e80d33b9f91b5bbc240fd50145c"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#aa59a8e80d33b9f91b5bbc240fd50145c">map_manager::MapManager::update_ev_object</a></div><div class="ttdeci">MAP_MANAGER_LOCAL void update_ev_object()</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l00686">map_manager.cpp:686</a></div></div>
<div class="ttc" id="astructmap__manager_1_1DoorPose_html"><div class="ttname"><a href="structmap__manager_1_1DoorPose.html">map_manager::DoorPose</a></div><div class="ttdoc">문의 위치 정보를 담는 구조체입니다.</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00059">common.hpp:59</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a47a7c408e0bbc50571eea14d42cd0cc3"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a47a7c408e0bbc50571eea14d42cd0cc3">map_manager::MapManager::dest_list_</a></div><div class="ttdeci">std::vector&lt; aimbot_state_interfaces::msg::Destination &gt; dest_list_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00201">map_manager.hpp:201</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a2057a553e661e24d93f2ccaa073125a6"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a2057a553e661e24d93f2ccaa073125a6">map_manager::MapManager::get_button_pose_server_</a></div><div class="ttdeci">rclcpp::Service&lt; GetButtonPose &gt;::SharedPtr get_button_pose_server_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00351">map_manager.hpp:351</a></div></div>
<div class="ttc" id="astructmap__manager_1_1AimbotMotionState_html"><div class="ttname"><a href="structmap__manager_1_1AimbotMotionState.html">map_manager::AimbotMotionState</a></div><div class="ttdoc">Aimbot의 움직임 상태를 담는 구조체입니다.</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00070">common.hpp:70</a></div></div>
<div class="ttc" id="astructmap__manager_1_1AimbotMotionState_html_a9977f778ffcae79ca443e1b5cc75bf89"><div class="ttname"><a href="structmap__manager_1_1AimbotMotionState.html#a9977f778ffcae79ca443e1b5cc75bf89">map_manager::AimbotMotionState::map_current_frame_id_</a></div><div class="ttdeci">std::string map_current_frame_id_</div><div class="ttdoc">현재 맵의 프레임 ID</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00073">common.hpp:73</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a36836b2c35bc93d4d2ee61004ed12a69"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a36836b2c35bc93d4d2ee61004ed12a69">map_manager::MapManager::get_door_pose_callback</a></div><div class="ttdeci">MAP_MANAGER_LOCAL void get_door_pose_callback(const std::shared_ptr&lt; rmw_request_id_t &gt; request_header, const std::shared_ptr&lt; GetDoorPose::Request &gt; request, std::shared_ptr&lt; GetDoorPose::Response &gt; response)</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l02135">map_manager.cpp:2135</a></div></div>
<div class="ttc" id="astructmap__manager_1_1Object_html_a1176e4b280d1c65384c77c9962e81f13"><div class="ttname"><a href="structmap__manager_1_1Object.html#a1176e4b280d1c65384c77c9962e81f13">map_manager::Object::name</a></div><div class="ttdeci">std::string name</div><div class="ttdoc">객체의 이름</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00086">common.hpp:86</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a0edbfd6b0e0d95111f4f11d2c6853867"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a0edbfd6b0e0d95111f4f11d2c6853867">map_manager::MapManager::get_button_pose_callback</a></div><div class="ttdeci">MAP_MANAGER_LOCAL void get_button_pose_callback(const std::shared_ptr&lt; rmw_request_id_t &gt; request_header, const std::shared_ptr&lt; GetButtonPose::Request &gt; request, std::shared_ptr&lt; GetButtonPose::Response &gt; response)</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l02165">map_manager.cpp:2165</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a7d399ff9763b880fd2596af082c9b1f5"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a7d399ff9763b880fd2596af082c9b1f5">map_manager::MapManager::floor_estimation_by_atm_pressure_ptr_</a></div><div class="ttdeci">std::shared_ptr&lt; FloorEstimationByAtmPressure &gt; floor_estimation_by_atm_pressure_ptr_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00150">map_manager.hpp:150</a></div></div>
<div class="ttc" id="astructmap__manager_1_1AimbotMotionState_html_ac2c56020cad267a628141fc69c73180a"><div class="ttname"><a href="structmap__manager_1_1AimbotMotionState.html#ac2c56020cad267a628141fc69c73180a">map_manager::AimbotMotionState::floor_</a></div><div class="ttdeci">std::string floor_</div><div class="ttdoc">현재 층</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00075">common.hpp:75</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_ab7d0935d29874372f29865680379dfba"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#ab7d0935d29874372f29865680379dfba">map_manager::MapManager::on_shutdown</a></div><div class="ttdeci">MAP_MANAGER_LOCAL CallbackReturn on_shutdown(const rclcpp_lifecycle::State &amp;state) override</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l00440">map_manager.cpp:440</a></div></div>
<div class="ttc" id="astructmap__manager_1_1AimbotMotionState_html_a16a596b50b6aaa332a0ff01a832015c9"><div class="ttname"><a href="structmap__manager_1_1AimbotMotionState.html#a16a596b50b6aaa332a0ff01a832015c9">map_manager::AimbotMotionState::stamp_</a></div><div class="ttdeci">rclcpp::Time stamp_</div><div class="ttdoc">시간 정보</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00072">common.hpp:72</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_abafd8e1c11994af6f66c5c85e480fcbc"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#abafd8e1c11994af6f66c5c85e480fcbc">map_manager::MapManager::map_site_name_</a></div><div class="ttdeci">std::string map_site_name_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00140">map_manager.hpp:140</a></div></div>
<div class="ttc" id="astructmap__manager_1_1ButtonPose_html_a2cb0dd3064d60cc10b42b55c8971e2ef"><div class="ttname"><a href="structmap__manager_1_1ButtonPose.html#a2cb0dd3064d60cc10b42b55c8971e2ef">map_manager::ButtonPose::name</a></div><div class="ttdeci">std::string name</div><div class="ttdoc">버튼의 이름</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00049">common.hpp:49</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_ab0690c838523c783bb4ff9b5cf8831e6"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#ab0690c838523c783bb4ff9b5cf8831e6">map_manager::MapManager::current_map_frame_id_</a></div><div class="ttdeci">std::string current_map_frame_id_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00225">map_manager.hpp:225</a></div></div>
<div class="ttc" id="astructmap__manager_1_1Boundary_html"><div class="ttname"><a href="structmap__manager_1_1Boundary.html">map_manager::Boundary</a></div><div class="ttdoc">경계의 정보를 담는 구조체입니다.</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00096">common.hpp:96</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a45595a5e2f526bc23ccbe25e46ab7137"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a45595a5e2f526bc23ccbe25e46ab7137">map_manager::MapManager::ev_object_list_</a></div><div class="ttdeci">std::map&lt; std::string, EvObjects &gt; ev_object_list_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00205">map_manager.hpp:205</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a4d06aeda99c4fccdeefdfeb1b852b916"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a4d06aeda99c4fccdeefdfeb1b852b916">map_manager::MapManager::rewrite_uuid</a></div><div class="ttdeci">MAP_MANAGER_LOCAL void rewrite_uuid()</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l01120">map_manager.cpp:1120</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a0b49774d08563068191b701ede5a033f"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a0b49774d08563068191b701ede5a033f">map_manager::MapManager::mobile_motion_state_</a></div><div class="ttdeci">AimbotMotionState mobile_motion_state_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00183">map_manager.hpp:183</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_aeb93ea87886b82b5f99a4bf49fe084c1"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#aeb93ea87886b82b5f99a4bf49fe084c1">map_manager::MapManager::stop_save_atm_pressure_callback</a></div><div class="ttdeci">MAP_MANAGER_LOCAL void stop_save_atm_pressure_callback(const std_msgs::msg::String::SharedPtr msg)</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l00599">map_manager.cpp:599</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_ade021777fe56be06dbca4dcb89c7263d"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#ade021777fe56be06dbca4dcb89c7263d">map_manager::MapManager::get_mobile_state_callback</a></div><div class="ttdeci">MAP_MANAGER_LOCAL void get_mobile_state_callback(const std::shared_ptr&lt; rmw_request_id_t &gt; request_header, const std::shared_ptr&lt; GetAimbotMotionState::Request &gt; request, std::shared_ptr&lt; GetAimbotMotionState::Response &gt; response)</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l01093">map_manager.cpp:1093</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a2e0d3b6cd0b285ecb4a3e75252c3022b"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a2e0d3b6cd0b285ecb4a3e75252c3022b">map_manager::MapManager::pressure_stream_</a></div><div class="ttdeci">std::shared_ptr&lt; std::ofstream &gt; pressure_stream_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00154">map_manager.hpp:154</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a60934a3e4d02c94bca83525e086221a5"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a60934a3e4d02c94bca83525e086221a5">map_manager::MapManager::ev_object_cancel_callback</a></div><div class="ttdeci">MAP_MANAGER_LOCAL rclcpp_action::CancelResponse ev_object_cancel_callback(const std::shared_ptr&lt; rclcpp_action::ServerGoalHandle&lt; UpdateEVObject &gt;&gt; goal_handle)</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l00660">map_manager.cpp:660</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_aa7ec89923f9d20926eacc162c797e548"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#aa7ec89923f9d20926eacc162c797e548">map_manager::MapManager::start_save_atm_pressure_sub_</a></div><div class="ttdeci">rclcpp::Subscription&lt; std_msgs::msg::String &gt;::SharedPtr start_save_atm_pressure_sub_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00156">map_manager.hpp:156</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_ac6a70fbf9ac90e568e25aea221d0c0bb"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#ac6a70fbf9ac90e568e25aea221d0c0bb">map_manager::MapManager::robot_map_frame_id_</a></div><div class="ttdeci">std::string robot_map_frame_id_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00147">map_manager.hpp:147</a></div></div>
<div class="ttc" id="astructmap__manager_1_1EvObjects_html_ae859eb837cd68006ccc3ffb8f3fb6bb4"><div class="ttname"><a href="structmap__manager_1_1EvObjects.html#ae859eb837cd68006ccc3ffb8f3fb6bb4">map_manager::EvObjects::objects</a></div><div class="ttdeci">std::vector&lt; Object &gt; objects</div><div class="ttdoc">객체들의 정보</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00109">common.hpp:109</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_ae745696a0c6f210b7107c809ab1aa9e1"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#ae745696a0c6f210b7107c809ab1aa9e1">map_manager::MapManager::ev_object_action_start_time_</a></div><div class="ttdeci">rclcpp::Time ev_object_action_start_time_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00280">map_manager.hpp:280</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a0ec87ecdcd648fd4959c5105afb9ec22"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a0ec87ecdcd648fd4959c5105afb9ec22">map_manager::MapManager::load_elevator</a></div><div class="ttdeci">MAP_MANAGER_LOCAL bool load_elevator()</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l01677">map_manager.cpp:1677</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_ab028417b8bdc1ce6f9a379ab1a7c0ba3"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#ab028417b8bdc1ce6f9a379ab1a7c0ba3">map_manager::MapManager::load_motion_state_from_file</a></div><div class="ttdeci">MAP_MANAGER_LOCAL bool load_motion_state_from_file(AimbotMotionState *state)</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l00967">map_manager.cpp:967</a></div></div>
<div class="ttc" id="astructmap__manager_1_1Boundary_html_a5d53e934d4e3b28bf93b104ed23febe7"><div class="ttname"><a href="structmap__manager_1_1Boundary.html#a5d53e934d4e3b28bf93b104ed23febe7">map_manager::Boundary::polygon</a></div><div class="ttdeci">geometry_msgs::msg::Polygon polygon</div><div class="ttdoc">경계의 다각형 정보</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00100">common.hpp:100</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a5d01b1a769864bebe21963b7ada39bc0"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a5d01b1a769864bebe21963b7ada39bc0">map_manager::MapManager::publish_motion_state</a></div><div class="ttdeci">MAP_MANAGER_LOCAL void publish_motion_state()</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l02264">map_manager.cpp:2264</a></div></div>
<div class="ttc" id="astructmap__manager_1_1DoorPose_html_afa3b255e833eebb9febd623f0cd25a70"><div class="ttname"><a href="structmap__manager_1_1DoorPose.html#afa3b255e833eebb9febd623f0cd25a70">map_manager::DoorPose::floor</a></div><div class="ttdeci">std::vector&lt; std::string &gt; floor</div><div class="ttdoc">문이 위치한 층</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00062">common.hpp:62</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1DividingLines_html_a5c811e155a3e5affd155b29dbd5b82e0"><div class="ttname"><a href="classmap__manager_1_1DividingLines.html#a5c811e155a3e5affd155b29dbd5b82e0">map_manager::DividingLines::add_dividing_line</a></div><div class="ttdeci">void add_dividing_line(double dividing_line_a, double dividing_line_b, double dividing_line_c)</div><div class="ttdoc">분할선을 추가하는 메서드입니다.</div><div class="ttdef"><b>Definition:</b> <a href="sector_8cpp_source.html#l00049">sector.cpp:49</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a045f8b20b610b8a361901bedc402dbdd"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a045f8b20b610b8a361901bedc402dbdd">map_manager::MapManager::get_nearest_button_server_</a></div><div class="ttdeci">rclcpp::Service&lt; GetNearestButton &gt;::SharedPtr get_nearest_button_server_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00359">map_manager.hpp:359</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a87f668443752e667b73e38cffda45160"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a87f668443752e667b73e38cffda45160">map_manager::MapManager::waypoint_list_</a></div><div class="ttdeci">std::vector&lt; aimbot_state_interfaces::msg::Waypoint &gt; waypoint_list_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00202">map_manager.hpp:202</a></div></div>
<div class="ttc" id="astructmap__manager_1_1AimbotMotionState_html_af59ff7bf9359a2adb81e19c7abadc5cb"><div class="ttname"><a href="structmap__manager_1_1AimbotMotionState.html#af59ff7bf9359a2adb81e19c7abadc5cb">map_manager::AimbotMotionState::sector_</a></div><div class="ttdeci">std::string sector_</div><div class="ttdoc">현재 섹터</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00076">common.hpp:76</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a8d62e7cd6eaa77d97c3d12003f3800bc"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a8d62e7cd6eaa77d97c3d12003f3800bc">map_manager::MapManager::generate_unique_key</a></div><div class="ttdeci">MAP_MANAGER_LOCAL std::string generate_unique_key()</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l01170">map_manager.cpp:1170</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a27241dadd3c22ef9f43ce1a471e2e094"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a27241dadd3c22ef9f43ce1a471e2e094">map_manager::MapManager::atm_pressure_sub_</a></div><div class="ttdeci">rclcpp::Subscription&lt; sensor_msgs::msg::FluidPressure &gt;::SharedPtr atm_pressure_sub_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00155">map_manager.hpp:155</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_adaf1cb5af4ee7c536b16d36fcb08486d"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#adaf1cb5af4ee7c536b16d36fcb08486d">map_manager::MapManager::transform_pose</a></div><div class="ttdeci">MAP_MANAGER_LOCAL geometry_msgs::msg::PoseStamped transform_pose(geometry_msgs::msg::PoseStamped origin_pose, std::string refer_frame_id)</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l01229">map_manager.cpp:1229</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a788fabb32e6b80e21f4cb5181d899c7c"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a788fabb32e6b80e21f4cb5181d899c7c">map_manager::MapManager::initialize_floor_estimator</a></div><div class="ttdeci">MAP_MANAGER_LOCAL bool initialize_floor_estimator()</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l00461">map_manager.cpp:461</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a52729eca912ac8a3061894f819f09ccb"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a52729eca912ac8a3061894f819f09ccb">map_manager::MapManager::init_pose_sub_</a></div><div class="ttdeci">rclcpp::Subscription&lt; geometry_msgs::msg::PoseWithCovarianceStamped &gt;::SharedPtr init_pose_sub_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00266">map_manager.hpp:266</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a496982717df5682e482d445ab3dbe551"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a496982717df5682e482d445ab3dbe551">map_manager::MapManager::init_pose_pub_</a></div><div class="ttdeci">rclcpp_lifecycle::LifecyclePublisher&lt; geometry_msgs::msg::PoseWithCovarianceStamped &gt;::SharedPtr init_pose_pub_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00265">map_manager.hpp:265</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_aee0008cbfa0eab2665b9e3f04b4bf532"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#aee0008cbfa0eab2665b9e3f04b4bf532">map_manager::MapManager::load_map_client_</a></div><div class="ttdeci">rclcpp::Client&lt; nav2_msgs::srv::LoadMap &gt;::SharedPtr load_map_client_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00306">map_manager.hpp:306</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_acf6bafbe2a7fec6838e1f01f544c22e4"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#acf6bafbe2a7fec6838e1f01f544c22e4">map_manager::MapManager::pose2d_to_3d</a></div><div class="ttdeci">MAP_MANAGER_LOCAL geometry_msgs::msg::PoseStamped pose2d_to_3d(std::string frame_id, geometry_msgs::msg::Pose2D pose_2d)</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l01293">map_manager.cpp:1293</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a2eb45c2838fbe2e1fbb1afc55ecf759b"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a2eb45c2838fbe2e1fbb1afc55ecf759b">map_manager::MapManager::change_map_srv_callback</a></div><div class="ttdeci">MAP_MANAGER_LOCAL void change_map_srv_callback(const std::shared_ptr&lt; rmw_request_id_t &gt; request_header, const std::shared_ptr&lt; aimbot_state_interfaces::srv::ChangeMap::Request &gt; request, std::shared_ptr&lt; aimbot_state_interfaces::srv::ChangeMap::Response &gt; response)</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l00806">map_manager.cpp:806</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_abe8ee1f3d97cc125a966758993a9ba08"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#abe8ee1f3d97cc125a966758993a9ba08">map_manager::MapManager::load_map_info</a></div><div class="ttdeci">MAP_MANAGER_LOCAL bool load_map_info()</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l00938">map_manager.cpp:938</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a766be94e37bbd82a9537dbb09349abbd"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a766be94e37bbd82a9537dbb09349abbd">map_manager::MapManager::get_waypoint_callback</a></div><div class="ttdeci">MAP_MANAGER_LOCAL void get_waypoint_callback(const std::shared_ptr&lt; rmw_request_id_t &gt; request_header, const std::shared_ptr&lt; GetWaypoint::Request &gt; request, std::shared_ptr&lt; GetWaypoint::Response &gt; response)</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l02114">map_manager.cpp:2114</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a6069c7059db4ad16d24920daec11a79a"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a6069c7059db4ad16d24920daec11a79a">map_manager::MapManager::station_tf_broadcaster_</a></div><div class="ttdeci">std::shared_ptr&lt; tf2_ros::StaticTransformBroadcaster &gt; station_tf_broadcaster_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00230">map_manager.hpp:230</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_acba5941f5d067ece6112c00590888fdd"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#acba5941f5d067ece6112c00590888fdd">map_manager::MapManager::update_ev_object_action_server_</a></div><div class="ttdeci">rclcpp_action::Server&lt; UpdateEVObject &gt;::SharedPtr update_ev_object_action_server_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00277">map_manager.hpp:277</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a31a03c24e4de79909926500e7fa2c119"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a31a03c24e4de79909926500e7fa2c119">map_manager::MapManager::save_atm_pressure_future_</a></div><div class="ttdeci">std::future&lt; bool &gt; save_atm_pressure_future_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00153">map_manager.hpp:153</a></div></div>
<div class="ttc" id="astructmap__manager_1_1DoorPose_html_a13a81624ad6dba0281c1dbecade962d2"><div class="ttname"><a href="structmap__manager_1_1DoorPose.html#a13a81624ad6dba0281c1dbecade962d2">map_manager::DoorPose::pose</a></div><div class="ttdeci">geometry_msgs::msg::Pose2D pose</div><div class="ttdoc">문의 위치</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00063">common.hpp:63</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_af511568ab6ca414157e1798f101f81e4"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#af511568ab6ca414157e1798f101f81e4">map_manager::MapManager::robot_base_frame_id_</a></div><div class="ttdeci">std::string robot_base_frame_id_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00146">map_manager.hpp:146</a></div></div>
<div class="ttc" id="astructmap__manager_1_1ButtonPose_html_a35cb5ad48d10403f31b28e49e17e2717"><div class="ttname"><a href="structmap__manager_1_1ButtonPose.html#a35cb5ad48d10403f31b28e49e17e2717">map_manager::ButtonPose::floor</a></div><div class="ttdeci">std::vector&lt; std::string &gt; floor</div><div class="ttdoc">버튼이 위치한 층</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00051">common.hpp:51</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_ac5a915570b8c5ecb7f156ba378f64c5a"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#ac5a915570b8c5ecb7f156ba378f64c5a">map_manager::MapManager::stop_save_atm_pressure_sub_</a></div><div class="ttdeci">rclcpp::Subscription&lt; std_msgs::msg::String &gt;::SharedPtr stop_save_atm_pressure_sub_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00157">map_manager.hpp:157</a></div></div>
<div class="ttc" id="astructmap__manager_1_1EvObjects_html_aca73b997a37c0c406cbf57e98f29eebe"><div class="ttname"><a href="structmap__manager_1_1EvObjects.html#aca73b997a37c0c406cbf57e98f29eebe">map_manager::EvObjects::boundarys</a></div><div class="ttdeci">std::vector&lt; Boundary &gt; boundarys</div><div class="ttdoc">경계들의 정보</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00110">common.hpp:110</a></div></div>
<div class="ttc" id="astructmap__manager_1_1ButtonPose_html"><div class="ttname"><a href="structmap__manager_1_1ButtonPose.html">map_manager::ButtonPose</a></div><div class="ttdoc">버튼의 위치 정보를 담는 구조체입니다.</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00047">common.hpp:47</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a9c8834d88d2690db450fe798678a2e5c"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a9c8834d88d2690db450fe798678a2e5c">map_manager::MapManager::server_callback_group_</a></div><div class="ttdeci">rclcpp::CallbackGroup::SharedPtr server_callback_group_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00261">map_manager.hpp:261</a></div></div>
<div class="ttc" id="astructmap__manager_1_1AimbotMotionState_html_afc1fd1bca09f4df6cb0f59dc36dd351f"><div class="ttname"><a href="structmap__manager_1_1AimbotMotionState.html#afc1fd1bca09f4df6cb0f59dc36dd351f">map_manager::AimbotMotionState::atm_floor_</a></div><div class="ttdeci">std::string atm_floor_</div><div class="ttdoc">대기압 층</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00077">common.hpp:77</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a231cc314d6ce400df407ae337cc562eb"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a231cc314d6ce400df407ae337cc562eb">map_manager::MapManager::get_destination_callback</a></div><div class="ttdeci">MAP_MANAGER_LOCAL void get_destination_callback(const std::shared_ptr&lt; rmw_request_id_t &gt; request_header, const std::shared_ptr&lt; GetDestination::Request &gt; request, std::shared_ptr&lt; GetDestination::Response &gt; response)</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l02080">map_manager.cpp:2080</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a28554371705cb39d1ee6883ad7d15b3c"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a28554371705cb39d1ee6883ad7d15b3c">map_manager::MapManager::map_tf_broadcaster_list_</a></div><div class="ttdeci">std::vector&lt; std::shared_ptr&lt; tf2_ros::StaticTransformBroadcaster &gt; &gt; map_tf_broadcaster_list_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00177">map_manager.hpp:177</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_aab269ee8379aa19f20fbe79decdc3e35"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#aab269ee8379aa19f20fbe79decdc3e35">map_manager::MapManager::get_destination_list_server_</a></div><div class="ttdeci">rclcpp::Service&lt; GetDestinationList &gt;::SharedPtr get_destination_list_server_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00319">map_manager.hpp:319</a></div></div>
<div class="ttc" id="astructmap__manager_1_1Object_html"><div class="ttname"><a href="structmap__manager_1_1Object.html">map_manager::Object</a></div><div class="ttdoc">객체의 정보를 담는 구조체입니다.</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00084">common.hpp:84</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a186056a572655f45b0d9d49cedf707fe"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a186056a572655f45b0d9d49cedf707fe">map_manager::MapManager::on_cleanup</a></div><div class="ttdeci">MAP_MANAGER_LOCAL CallbackReturn on_cleanup(const rclcpp_lifecycle::State &amp;state) override</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l00418">map_manager.cpp:418</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_aefbcca7f7e0d17e03f14f3726b2ffda0"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#aefbcca7f7e0d17e03f14f3726b2ffda0">map_manager::MapManager::load_station</a></div><div class="ttdeci">MAP_MANAGER_LOCAL bool load_station()</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l01324">map_manager.cpp:1324</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a08443e079f18f047ef9334f9948906c1"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a08443e079f18f047ef9334f9948906c1">map_manager::MapManager::timer_</a></div><div class="ttdeci">rclcpp::TimerBase::SharedPtr timer_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00137">map_manager.hpp:137</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a56b226dafd436de9f37215d35be9e76b"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a56b226dafd436de9f37215d35be9e76b">map_manager::MapManager::start_save_atm_pressure_callback</a></div><div class="ttdeci">MAP_MANAGER_LOCAL void start_save_atm_pressure_callback(const std_msgs::msg::String::SharedPtr msg)</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l00540">map_manager.cpp:540</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a2c92e8dee5f85f2e6da8aa6f700cc3db"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a2c92e8dee5f85f2e6da8aa6f700cc3db">map_manager::MapManager::publish_tf</a></div><div class="ttdeci">MAP_MANAGER_LOCAL void publish_tf()</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l02278">map_manager.cpp:2278</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a3fe449af2336f22744fe58a8c3cc42f7"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a3fe449af2336f22744fe58a8c3cc42f7">map_manager::MapManager::MapManager</a></div><div class="ttdeci">MAP_MANAGER_PUBLIC MapManager(const std::string &amp;node_name)</div><div class="ttdoc">MapManager 클래스의 생성자입니다.</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l00027">map_manager.cpp:27</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_ad7122f88aaa058a18fcfae6e975c32b7"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#ad7122f88aaa058a18fcfae6e975c32b7">map_manager::MapManager::ev_object_goal_callback</a></div><div class="ttdeci">MAP_MANAGER_LOCAL rclcpp_action::GoalResponse ev_object_goal_callback(const rclcpp_action::GoalUUID &amp;uuid, std::shared_ptr&lt; const UpdateEVObject::Goal &gt; goal)</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l00638">map_manager.cpp:638</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_acf0adb7076b38fa8c1437263762eeb17"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#acf0adb7076b38fa8c1437263762eeb17">map_manager::MapManager::pose3d_to_2d</a></div><div class="ttdeci">MAP_MANAGER_LOCAL geometry_msgs::msg::Pose2D pose3d_to_2d(geometry_msgs::msg::PoseStamped pose_3d)</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l01310">map_manager.cpp:1310</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a3c82a007a0fed93d4a76b4daaadec386"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a3c82a007a0fed93d4a76b4daaadec386">map_manager::MapManager::get_waypoint_server_</a></div><div class="ttdeci">rclcpp::Service&lt; GetWaypoint &gt;::SharedPtr get_waypoint_server_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00335">map_manager.hpp:335</a></div></div>
<div class="ttc" id="astructmap__manager_1_1DoorPose_html_af6920aa35cefa680e3041ed11606c251"><div class="ttname"><a href="structmap__manager_1_1DoorPose.html#af6920aa35cefa680e3041ed11606c251">map_manager::DoorPose::name</a></div><div class="ttdeci">std::string name</div><div class="ttdoc">문의 이름</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00061">common.hpp:61</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a2cd07fd57027b359e8677aee6e8930dc"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a2cd07fd57027b359e8677aee6e8930dc">map_manager::MapManager::map_list_</a></div><div class="ttdeci">std::vector&lt; MapInfo &gt; map_list_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00176">map_manager.hpp:176</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_aafea5fd37c00885e1017a93be4c7178a"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#aafea5fd37c00885e1017a93be4c7178a">map_manager::MapManager::sector_list_</a></div><div class="ttdeci">std::shared_ptr&lt; Sector &gt; sector_list_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00250">map_manager.hpp:250</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a79660eef4c19cb5072f01c11de050846"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a79660eef4c19cb5072f01c11de050846">map_manager::MapManager::current_map_tf_broadcaster_</a></div><div class="ttdeci">std::shared_ptr&lt; tf2_ros::StaticTransformBroadcaster &gt; current_map_tf_broadcaster_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00226">map_manager.hpp:226</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a1e1133b56d40589a30c3803dbbd1e240"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a1e1133b56d40589a30c3803dbbd1e240">map_manager::MapManager::ev_object_aceepted_callback</a></div><div class="ttdeci">MAP_MANAGER_LOCAL void ev_object_aceepted_callback(std::shared_ptr&lt; rclcpp_action::ServerGoalHandle&lt; UpdateEVObject &gt;&gt; goal_handle)</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l00673">map_manager.cpp:673</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a5136641f396bbcb67d0cb4ac6df7a456"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a5136641f396bbcb67d0cb4ac6df7a456">map_manager::MapManager::change_map_server_</a></div><div class="ttdeci">rclcpp::Service&lt; aimbot_state_interfaces::srv::ChangeMap &gt;::SharedPtr change_map_server_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00299">map_manager.hpp:299</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_aa9dca860f14eb942ca6b50463e87e3fe"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#aa9dca860f14eb942ca6b50463e87e3fe">map_manager::MapManager::change_floor_callback</a></div><div class="ttdeci">MAP_MANAGER_LOCAL void change_floor_callback(const std_msgs::msg::String::SharedPtr msg)</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l00622">map_manager.cpp:622</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a760171f9d3fd955360b6aee03c3f11ba"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a760171f9d3fd955360b6aee03c3f11ba">map_manager::MapManager::present_atm_pressure_</a></div><div class="ttdeci">sensor_msgs::msg::FluidPressure present_atm_pressure_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00151">map_manager.hpp:151</a></div></div>
<div class="ttc" id="anamespacemap__manager_html"><div class="ttname"><a href="namespacemap__manager.html">map_manager</a></div><div class="ttdoc">맵 관리를 위한 네임스페이스입니다.</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00029">common.hpp:29</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a43441561715c63a9a7dc36ab8e77c54f"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a43441561715c63a9a7dc36ab8e77c54f">map_manager::MapManager::robot_num_</a></div><div class="ttdeci">std::string robot_num_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00143">map_manager.hpp:143</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a338dde81bc24116f3abc218f6d198230"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a338dde81bc24116f3abc218f6d198230">map_manager::MapManager::save_motion_state_to_log_file</a></div><div class="ttdeci">MAP_MANAGER_LOCAL void save_motion_state_to_log_file()</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l01044">map_manager.cpp:1044</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a9621392c21b63cfbfee973bb40e63edf"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a9621392c21b63cfbfee973bb40e63edf">map_manager::MapManager::atm_pressure_callback</a></div><div class="ttdeci">MAP_MANAGER_LOCAL void atm_pressure_callback(const sensor_msgs::msg::FluidPressure::SharedPtr msg)</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l00501">map_manager.cpp:501</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a8a900d806e57e143205a86a2bb85765d"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a8a900d806e57e143205a86a2bb85765d">map_manager::MapManager::motion_state_mutex_</a></div><div class="ttdeci">std::mutex motion_state_mutex_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00184">map_manager.hpp:184</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a77cef7a3e1ab1335b6c9de78884e4e9c"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a77cef7a3e1ab1335b6c9de78884e4e9c">map_manager::MapManager::tf_listener_</a></div><div class="ttdeci">std::shared_ptr&lt; tf2_ros::TransformListener &gt; tf_listener_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00256">map_manager.hpp:256</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a7cef5491d2ff6f28d610cb58c7aa9414"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a7cef5491d2ff6f28d610cb58c7aa9414">map_manager::MapManager::on_deactivate</a></div><div class="ttdeci">MAP_MANAGER_LOCAL CallbackReturn on_deactivate(const rclcpp_lifecycle::State &amp;state) override</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l00402">map_manager.cpp:402</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_ae492b65d2a69cf360ec7c849a3d50a97"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#ae492b65d2a69cf360ec7c849a3d50a97">map_manager::MapManager::get_door_pose_server_</a></div><div class="ttdeci">rclcpp::Service&lt; GetDoorPose &gt;::SharedPtr get_door_pose_server_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00343">map_manager.hpp:343</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_ac462e554266d3019b3cb518ec2716d13"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#ac462e554266d3019b3cb518ec2716d13">map_manager::MapManager::get_nearest_button_callback</a></div><div class="ttdeci">MAP_MANAGER_LOCAL void get_nearest_button_callback(const std::shared_ptr&lt; rmw_request_id_t &gt; request_header, const std::shared_ptr&lt; GetNearestButton::Request &gt; request, std::shared_ptr&lt; GetNearestButton::Response &gt; response)</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l02195">map_manager.cpp:2195</a></div></div>
<div class="ttc" id="astructmap__manager_1_1EvObjects_html"><div class="ttname"><a href="structmap__manager_1_1EvObjects.html">map_manager::EvObjects</a></div><div class="ttdoc">EV 객체들의 정보를 담는 구조체입니다.</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00107">common.hpp:107</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_ac77dd458c90980a000e794ab1117c137"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#ac77dd458c90980a000e794ab1117c137">map_manager::MapManager::motion_state_server_</a></div><div class="ttdeci">rclcpp::Service&lt; GetAimbotMotionState &gt;::SharedPtr motion_state_server_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00311">map_manager.hpp:311</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a62adc5b3a5e1f3fa3b1ac0e76560ead6"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a62adc5b3a5e1f3fa3b1ac0e76560ead6">map_manager::MapManager::load_destinations</a></div><div class="ttdeci">MAP_MANAGER_LOCAL bool load_destinations()</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l01404">map_manager.cpp:1404</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a7f916650e4719c1d9b2ecf2c2eb5e7f2"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a7f916650e4719c1d9b2ecf2c2eb5e7f2">map_manager::MapManager::docking_station_</a></div><div class="ttdeci">DockingStation docking_station_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00229">map_manager.hpp:229</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a2119b6c240c04ed0f9fa991333982077"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a2119b6c240c04ed0f9fa991333982077">map_manager::MapManager::tf_buffer_</a></div><div class="ttdeci">std::shared_ptr&lt; tf2_ros::Buffer &gt; tf_buffer_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00255">map_manager.hpp:255</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a0c6bbfcaa0efa3fbb3977b99e0d94ca7"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a0c6bbfcaa0efa3fbb3977b99e0d94ca7">map_manager::MapManager::save_motion_state_to_file</a></div><div class="ttdeci">MAP_MANAGER_LOCAL bool save_motion_state_to_file()</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l01001">map_manager.cpp:1001</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapInfo_html"><div class="ttname"><a href="classmap__manager_1_1MapInfo.html">map_manager::MapInfo</a></div><div class="ttdoc">맵 정보를 관리하는 클래스입니다.</div><div class="ttdef"><b>Definition:</b> <a href="map__info_8hpp_source.html#l00036">map_info.hpp:36</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_abc2ee2e2cab883740315dcc775869165"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#abc2ee2e2cab883740315dcc775869165">map_manager::MapManager::update_ev_object_timer_</a></div><div class="ttdeci">rclcpp::TimerBase::SharedPtr update_ev_object_timer_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00278">map_manager.hpp:278</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a63c8fb0a25d2fe655f344f1df0f28dff"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a63c8fb0a25d2fe655f344f1df0f28dff">map_manager::MapManager::change_floor_sub_</a></div><div class="ttdeci">rclcpp::Subscription&lt; std_msgs::msg::String &gt;::SharedPtr change_floor_sub_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00271">map_manager.hpp:271</a></div></div>
<div class="ttc" id="astructmap__manager_1_1DockingStation_html_ada28d947caadaa213278c2b670fda9e0"><div class="ttname"><a href="structmap__manager_1_1DockingStation.html#ada28d947caadaa213278c2b670fda9e0">map_manager::DockingStation::pose</a></div><div class="ttdeci">geometry_msgs::msg::Pose2D pose</div><div class="ttdoc">도킹 스테이션의 위치</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00040">common.hpp:40</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_af93982b338cf6e2af4bc34772da668dc"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#af93982b338cf6e2af4bc34772da668dc">map_manager::MapManager::goal_handle_</a></div><div class="ttdeci">std::shared_ptr&lt; rclcpp_action::ServerGoalHandle&lt; UpdateEVObject &gt; &gt; goal_handle_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00279">map_manager.hpp:279</a></div></div>
<div class="ttc" id="astructmap__manager_1_1Boundary_html_a3e9b694f451581635d6d19b403ba7840"><div class="ttname"><a href="structmap__manager_1_1Boundary.html#a3e9b694f451581635d6d19b403ba7840">map_manager::Boundary::sector</a></div><div class="ttdeci">std::string sector</div><div class="ttdoc">경계가 위치한 섹터</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00099">common.hpp:99</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a0681a35d142161de0e66c26b037aa7ce"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a0681a35d142161de0e66c26b037aa7ce">map_manager::MapManager::get_destination_server_</a></div><div class="ttdeci">rclcpp::Service&lt; GetDestination &gt;::SharedPtr get_destination_server_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00327">map_manager.hpp:327</a></div></div>
<div class="ttc" id="astructmap__manager_1_1AimbotMotionState_html_a3fa894f8f09fb6d4e3cbf484bd2048d9"><div class="ttname"><a href="structmap__manager_1_1AimbotMotionState.html#a3fa894f8f09fb6d4e3cbf484bd2048d9">map_manager::AimbotMotionState::pose_2d_from_map_current_</a></div><div class="ttdeci">geometry_msgs::msg::Pose2D pose_2d_from_map_current_</div><div class="ttdoc">현재 맵에서의 2D 위치</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00074">common.hpp:74</a></div></div>
<div class="ttc" id="astructmap__manager_1_1DockingStation_html_a9759346d27d09ecc2cd6f4dea89f42ca"><div class="ttname"><a href="structmap__manager_1_1DockingStation.html#a9759346d27d09ecc2cd6f4dea89f42ca">map_manager::DockingStation::sector_</a></div><div class="ttdeci">std::string sector_</div><div class="ttdoc">도킹 스테이션이 위치한 섹터</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00039">common.hpp:39</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a088611861a5705ba385e7bf3e973a9eb"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a088611861a5705ba385e7bf3e973a9eb">map_manager::MapManager::on_activate</a></div><div class="ttdeci">MAP_MANAGER_LOCAL CallbackReturn on_activate(const rclcpp_lifecycle::State &amp;state) override</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l00298">map_manager.cpp:298</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a60fbddbc22abe230f8398f014f28ee51"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a60fbddbc22abe230f8398f014f28ee51">map_manager::MapManager::generate_uuid</a></div><div class="ttdeci">MAP_MANAGER_LOCAL std::string generate_uuid()</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l01138">map_manager.cpp:1138</a></div></div>
<div class="ttc" id="astructmap__manager_1_1DockingStation_html_aeadd7ce73766c12617fc524aea140829"><div class="ttname"><a href="structmap__manager_1_1DockingStation.html#aeadd7ce73766c12617fc524aea140829">map_manager::DockingStation::floor_</a></div><div class="ttdeci">std::string floor_</div><div class="ttdoc">도킹 스테이션이 위치한 층</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00038">common.hpp:38</a></div></div>
<div class="ttc" id="astructmap__manager_1_1Boundary_html_aa41cefe18b37e6fd8aed95ce2dca2db5"><div class="ttname"><a href="structmap__manager_1_1Boundary.html#aa41cefe18b37e6fd8aed95ce2dca2db5">map_manager::Boundary::floor</a></div><div class="ttdeci">std::vector&lt; std::string &gt; floor</div><div class="ttdoc">경계가 위치한 층</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00098">common.hpp:98</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a28209f1819a0735e54dcadccd337e546"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a28209f1819a0735e54dcadccd337e546">map_manager::MapManager::get_destination_list_callback</a></div><div class="ttdeci">MAP_MANAGER_LOCAL void get_destination_list_callback(const std::shared_ptr&lt; rmw_request_id_t &gt; request_header, const std::shared_ptr&lt; GetDestinationList::Request &gt; request, std::shared_ptr&lt; GetDestinationList::Response &gt; response)</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l02068">map_manager.cpp:2068</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a631536d1fb1937e6492a38e148bd50a7"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a631536d1fb1937e6492a38e148bd50a7">map_manager::MapManager::send_current_map_to_nav</a></div><div class="ttdeci">MAP_MANAGER_LOCAL uint8_t send_current_map_to_nav(const std::string &amp;map_file_path)</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l00844">map_manager.cpp:844</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1DividingLines_html"><div class="ttname"><a href="classmap__manager_1_1DividingLines.html">map_manager::DividingLines</a></div><div class="ttdoc">분할선을 관리하는 클래스입니다.</div><div class="ttdef"><b>Definition:</b> <a href="sector_8hpp_source.html#l00035">sector.hpp:35</a></div></div>
<div class="ttc" id="astructmap__manager_1_1ButtonPose_html_ad9fd3625f5689f97bcec9c4da8716dad"><div class="ttname"><a href="structmap__manager_1_1ButtonPose.html#ad9fd3625f5689f97bcec9c4da8716dad">map_manager::ButtonPose::pose</a></div><div class="ttdeci">geometry_msgs::msg::Pose pose</div><div class="ttdoc">버튼의 위치</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00052">common.hpp:52</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_ac13aab1c38097c2e46773c715751f888"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#ac13aab1c38097c2e46773c715751f888">map_manager::MapManager::load_sector_data</a></div><div class="ttdeci">MAP_MANAGER_LOCAL bool load_sector_data()</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l01939">map_manager.cpp:1939</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a27c2d32709db825f995997c5899a74d9"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a27c2d32709db825f995997c5899a74d9">map_manager::MapManager::save_atm_pressure_flag_</a></div><div class="ttdeci">bool save_atm_pressure_flag_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00152">map_manager.hpp:152</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a679c6a2a7a4801c77a66eb349ddabbda"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a679c6a2a7a4801c77a66eb349ddabbda">map_manager::MapManager::client_callback_group_</a></div><div class="ttdeci">rclcpp::CallbackGroup::SharedPtr client_callback_group_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00260">map_manager.hpp:260</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a9d504ddaf30710579a3aa9de7ef3635d"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a9d504ddaf30710579a3aa9de7ef3635d">map_manager::MapManager::map_server_list_</a></div><div class="ttdeci">std::vector&lt; std::shared_ptr&lt; SimpleMapServer &gt; &gt; map_server_list_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00178">map_manager.hpp:178</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a78b07efa2650ee1fb19a1eb0ea3d954f"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a78b07efa2650ee1fb19a1eb0ea3d954f">map_manager::MapManager::on_configure</a></div><div class="ttdeci">MAP_MANAGER_LOCAL CallbackReturn on_configure(const rclcpp_lifecycle::State &amp;state) override</div><div class="ttdoc">노드가 구성될 때 호출되는 메서드입니다.</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l00038">map_manager.cpp:38</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_abef0cfc5072ecc0f6698066dcaea1c2a"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#abef0cfc5072ecc0f6698066dcaea1c2a">map_manager::MapManager::load_gate</a></div><div class="ttdeci">MAP_MANAGER_LOCAL bool load_gate()</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l01848">map_manager.cpp:1848</a></div></div>
<div class="ttc" id="astructmap__manager_1_1ButtonPose_html_ae5bfc848cd78eb8055d9231259b74a67"><div class="ttname"><a href="structmap__manager_1_1ButtonPose.html#ae5bfc848cd78eb8055d9231259b74a67">map_manager::ButtonPose::location</a></div><div class="ttdeci">std::string location</div><div class="ttdoc">버튼의 위치</div><div class="ttdef"><b>Definition:</b> <a href="common_8hpp_source.html#l00050">common.hpp:50</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_abe3f09975c3337451f1d9d0b2f0b8de4"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#abe3f09975c3337451f1d9d0b2f0b8de4">map_manager::MapManager::save_atm_pressure_timer_callback</a></div><div class="ttdeci">MAP_MANAGER_LOCAL bool save_atm_pressure_timer_callback()</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l00510">map_manager.cpp:510</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_a802cc5d12e3708df05428d4769fbf21b"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#a802cc5d12e3708df05428d4769fbf21b">map_manager::MapManager::add_button</a></div><div class="ttdeci">MAP_MANAGER_LOCAL bool add_button(YAML::Node button_node, std::string default_floor, std::string default_location)</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8cpp_source.html#l01182">map_manager.cpp:1182</a></div></div>
<div class="ttc" id="aclassmap__manager_1_1MapManager_html_aa27bff05661f2dddd4a75a3b98820c0a"><div class="ttname"><a href="classmap__manager_1_1MapManager.html#aa27bff05661f2dddd4a75a3b98820c0a">map_manager::MapManager::door_list_</a></div><div class="ttdeci">std::vector&lt; DoorPose &gt; door_list_</div><div class="ttdef"><b>Definition:</b> <a href="map__manager_8hpp_source.html#l00203">map_manager.hpp:203</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_13152aee163a57adbc0ade30d5f13729.html">aimbot_site</a></li><li class="navelem"><a class="el" href="dir_c9ae41ff4c158d96b2ce47a7a8f3b552.html">map_manager</a></li><li class="navelem"><a class="el" href="dir_19e3af77699390ec6afa040d961b232e.html">src</a></li><li class="navelem"><b>map_manager.cpp</b></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
